<!doctype html><html lang="en"><head><script>!function(n,e){var t,o,i,c=[],f={passive:!0,capture:!0},r=new Date,a="pointerup",u="pointercancel";function p(n,c){t||(t=c,o=n,i=new Date,w(e),s())}function s(){o>=0&&o<i-r&&(c.forEach((function(n){n(o,t)})),c=[])}function l(t){if(t.cancelable){var o=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,o){function i(){p(t,o),r()}function c(){r()}function r(){e(a,i,f),e(u,c,f)}n(a,i,f),n(u,c,f)}(o,t):p(o,t)}}function w(n){["click","mousedown","keydown","touchstart","pointerdown"].forEach((function(e){n(e,l,f)}))}w(n),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){c.push(n),s()}}(addEventListener,removeEventListener)</script><script defer src="https://cdn.optimizely.com/js/16180790160.js"></script><title data-rh="true">Building fully custom machine learning models on AWS SageMaker: a practical guide | by Aleksey Bilogur | Towards Data Science</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2019-02-13T01:05:22.829Z"/><meta data-rh="true" name="title" content="Building fully custom machine learning models on AWS SageMaker: a practical guide | by Aleksey Bilogur | Towards Data Science"/><meta data-rh="true" property="og:title" content="Building fully custom machine learning models on AWS SageMaker: a practical guide"/><meta data-rh="true" property="twitter:title" content="Building fully custom machine learning models on AWS SageMaker: a practical guide"/><meta data-rh="true" name="twitter:site" content="@TDataScience"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/c30df3895ef7"/><meta data-rh="true" property="al:android:url" content="medium://p/c30df3895ef7"/><meta data-rh="true" property="al:ios:url" content="medium://p/c30df3895ef7"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="AWS SageMaker is a cloud machine learning SDK designed for speed of iteration, and it’s one of the fastest-growing toys in the Amazon AWS ecosystem. Since launching in late 2017 SageMaker’s growth…"/><meta data-rh="true" property="og:description" content="AWS SageMaker is a cloud machine learning SDK designed for speed of iteration, and it’s one of the fastest-growing toys in the Amazon AWS…"/><meta data-rh="true" property="twitter:description" content="AWS SageMaker is a cloud machine learning SDK designed for speed of iteration, and it’s one of the fastest-growing toys in the Amazon AWS…"/><meta data-rh="true" property="og:url" content="https://towardsdatascience.com/building-fully-custom-machine-learning-models-on-aws-sagemaker-a-practical-guide-c30df3895ef7"/><meta data-rh="true" property="al:web:url" content="https://towardsdatascience.com/building-fully-custom-machine-learning-models-on-aws-sagemaker-a-practical-guide-c30df3895ef7"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1200/1*15ISdDbHJfa-5b4eEQbtuw.png"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/1*15ISdDbHJfa-5b4eEQbtuw.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://medium.com/@aleksey.bilogur"/><meta data-rh="true" name="author" content="Aleksey Bilogur"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" value="Reading time"/><meta data-rh="true" name="twitter:data1" value="10 min read"/><meta data-rh="true" name="parsely-post-id" content="c30df3895ef7"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/fit/c/152/152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/fit/c/120/120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/fit/c/76/76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/fit/c/60/60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" rel="author" href="https://medium.com/@aleksey.bilogur"/><link data-rh="true" rel="canonical" href="https://towardsdatascience.com/building-fully-custom-machine-learning-models-on-aws-sagemaker-a-practical-guide-c30df3895ef7"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/c30df3895ef7"/><link data-rh="true" rel="icon" href="https://miro.medium.com/fit/c/256/256/1*ChFMdf--f5jbm-AYv6VdYA@2x.png"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*15ISdDbHJfa-5b4eEQbtuw.png"],"url":"https:\u002F\u002Ftowardsdatascience.com\u002Fbuilding-fully-custom-machine-learning-models-on-aws-sagemaker-a-practical-guide-c30df3895ef7","dateCreated":"2019-02-13T01:05:22.829Z","datePublished":"2019-02-13T01:05:22.829Z","dateModified":"2020-10-19T23:14:38.264Z","headline":"Building fully custom machine learning models on AWS SageMaker: a practical guide","name":"Building fully custom machine learning models on AWS SageMaker: a practical guide","description":"AWS SageMaker is a cloud machine learning SDK designed for speed of iteration, and it’s one of the fastest-growing toys in the Amazon AWS ecosystem. Since launching in late 2017 SageMaker’s growth…","identifier":"c30df3895ef7","keywords":["Lite:true","Tag:Docker","Tag:Machine Learning","Tag:AWS","Tag:Data Engineering","Tag:Deployment","Topic:Machine Learning","Topic:Programming","Publication:towards-data-science","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:4"],"author":{"@type":"Person","name":"Aleksey Bilogur","url":"https:\u002F\u002Ftowardsdatascience.com\u002F@aleksey.bilogur"},"creator":["Aleksey Bilogur"],"publisher":{"@type":"Organization","name":"Towards Data Science","url":"towardsdatascience.com","logo":{"@type":"ImageObject","width":165,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F330\u002F1*mG6i4Bh_LgixUYXJgQpYsg@2x.png"}},"mainEntityOfPage":"https:\u002F\u002Ftowardsdatascience.com\u002Fbuilding-fully-custom-machine-learning-models-on-aws-sagemaker-a-practical-guide-c30df3895ef7"}</script><script data-rh="true" >(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="546" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@-moz-keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@keyframes k1{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@-webkit-keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@-moz-keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@keyframes k2{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@-webkit-keyframes k3{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-moz-keyframes k3{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes k3{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:35px}.r{fill:rgba(41, 41, 41, 1)}.s{display:block}.t{margin-bottom:36px}.v{width:100%}.w{overflow-x:scroll}.x{white-space:nowrap}.y{scrollbar-width:none}.z{-ms-overflow-style:none}.ab::-webkit-scrollbar{display:none}.ac{box-shadow:inset 0 -1px 0 rgba(230, 230, 230, 1)}.ae{min-height:184px}.ah{flex-direction:column}.ai{background-color:#355876}.aj{display:none}.al{border-bottom:none}.am{position:relative}.an{z-index:500}.at{max-width:1192px}.au{min-width:0}.av{height:62px}.aw{flex-direction:row}.ax{flex:1 0 auto}.ay{visibility:hidden}.az{margin-left:0px}.ba{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bb{font-size:14px}.bc{line-height:20px}.bd{color:rgba(197, 210, 225, 1)}.be{color:rgba(53, 88, 118, 1)}.bf{fill:rgba(53, 88, 118, 1)}.bg{font-size:inherit}.bh{border:inherit}.bi{font-family:inherit}.bj{letter-spacing:inherit}.bk{font-weight:inherit}.bl{padding:0}.bm{margin:0}.bn:hover{cursor:pointer}.bo:hover{color:rgba(99, 127, 153, 1)}.bp:hover{fill:rgba(99, 127, 153, 1)}.bq:disabled{cursor:default}.br:disabled{color:rgba(26, 137, 23, 0.3)}.bs:disabled{fill:rgba(26, 137, 23, 0.3)}.bt{height:25px}.bu{fill:rgba(233, 241, 250, 1)}.bv{min-height:115px}.bw{justify-content:space-between}.cc{align-items:flex-start}.cd{margin-bottom:0px}.ce{margin-top:-32px}.cf{flex-wrap:wrap}.ci{margin-top:32px}.cj{margin-right:24px}.cl{width:112px}.cm{flex:0 0 auto}.cn{justify-self:flex-end}.co{margin-right:12px}.cp{height:32px}.cq{overflow:visible}.cr{border-radius:1000px}.cs{background-color:rgba(53, 88, 118, 0.8)}.ct{fill:rgba(197, 210, 225, 1)}.cu:hover{fill:rgba(251, 255, 255, 1)}.cv{color:inherit}.cw{fill:rgba(117, 117, 117, 1)}.cx{outline:none}.cy{padding:4px}.cz{margin-left:8px}.da{margin-right:10px}.db{margin-top:16px}.dc{margin-bottom:16px}.dd{display:inherit}.de{max-width:210px}.df{text-overflow:ellipsis}.dg{overflow:hidden}.dh{display:inline-block}.di{border:none}.dj{font:inherit}.dk{font-size:16px}.dl{opacity:0}.dm{background-color:transparent}.dn{color:rgba(233, 241, 250, 1)}.do::placeholder{color:rgba(197, 210, 225, 1)}.dp{padding:0px}.dq{width:0px}.dr{transition:width 140ms ease-in, padding 140ms ease-in}.ds{fill:inherit}.dt:hover{color:rgba(242, 248, 253, 1)}.du:hover{fill:rgba(242, 248, 253, 1)}.dv:disabled{color:rgba(197, 210, 225, 1)}.dw:disabled{fill:rgba(197, 210, 225, 1)}.dx{padding:4px 12px 6px}.dy{background:0}.dz{border-color:rgba(215, 226, 238, 1)}.ea:hover{color:rgba(251, 255, 255, 1)}.eb:hover{border-color:rgba(251, 255, 255, 1)}.ec:disabled{cursor:inherit}.ed:disabled{opacity:0.3}.ee:disabled:hover{color:rgba(233, 241, 250, 1)}.ef:disabled:hover{fill:rgba(233, 241, 250, 1)}.eg:disabled:hover{border-color:rgba(215, 226, 238, 1)}.eh{border-radius:4px}.ei{border-width:1px}.ej{border-style:solid}.ek{box-sizing:border-box}.el{text-decoration:none}.em{fill:rgba(251, 255, 255, 1)}.en{padding-top:1px}.eo{height:70px}.eq{line-height:24px}.er:before{margin-bottom:-10px}.es:before{content:""}.et:before{display:table}.eu:before{border-collapse:collapse}.ev:after{margin-top:-6px}.ew:after{content:""}.ex:after{display:table}.ey:after{border-collapse:collapse}.ez{color:rgba(117, 117, 117, 1)}.fa{margin-right:32px}.fb{margin-bottom:-16px}.fc{margin-top:-14px}.fd{color:rgba(255, 255, 255, 1)}.fe{padding:7px 16px 9px}.ff{fill:rgba(255, 255, 255, 1)}.fg{background:rgba(102, 138, 170, 1)}.fh{border-color:rgba(102, 138, 170, 1)}.fi:hover{background:rgba(90, 118, 144, 1)}.fj:hover{border-color:rgba(90, 118, 144, 1)}.fk:disabled:hover{background:rgba(102, 138, 170, 1)}.fl:disabled:hover{border-color:rgba(102, 138, 170, 1)}.fm{display:inline-flex}.fn:hover{color:rgba(25, 25, 25, 1)}.fo:hover{fill:rgba(25, 25, 25, 1)}.fp:disabled{color:rgba(117, 117, 117, 1)}.fq:disabled{fill:rgba(117, 117, 117, 1)}.fr{margin-left:12px}.fs{margin:0 12px}.ft{position:absolute}.fu{right:24px}.fv{margin:0px}.fw{border:0px}.fx{cursor:pointer}.fy{stroke:rgba(117, 117, 117, 1)}.gb{border-top:none}.gc{left:0}.gd{position:fixed}.ge{right:0}.gf{top:0}.gh{margin-top:0px}.gi{height:60px}.gl{color:rgba(102, 138, 170, 1)}.gm{fill:rgba(102, 138, 170, 1)}.gn:hover{color:rgba(90, 118, 144, 1)}.go:hover{fill:rgba(90, 118, 144, 1)}.gp{padding-left:24px}.gq{padding-right:24px}.gr{margin-left:auto}.gs{margin-right:auto}.gt{max-width:728px}.gu{top:calc(100vh + 100px)}.gv{bottom:calc(100vh + 100px)}.gw{width:10px}.gx{pointer-events:none}.gy{word-break:break-word}.gz{word-wrap:break-word}.ha:after{display:block}.hb:after{clear:both}.hc{max-width:680px}.hd{line-height:1.23}.he{letter-spacing:0}.hf{font-style:normal}.hg{font-weight:700}.ib{margin-bottom:-0.27em}.ic{color:rgba(41, 41, 41, 1)}.ig{border-radius:50%}.ih{height:28px}.ii{width:28px}.ij{margin:0 4px}.ik{margin:0 7px}.il{align-items:flex-end}.iu{padding-right:6px}.iv{margin-right:8px}.iw{fill:rgba(61, 61, 61, 1)}.ix{margin-right:-6px}.iy:hover{fill:rgba(8, 8, 8, 1)}.iz:focus{fill:rgba(8, 8, 8, 1)}.ja{clear:both}.jj{max-width:2197px}.jk{margin-top:33px}.jl{padding-bottom:5px}.jm{padding-top:5px}.jo{cursor:zoom-in}.jp{z-index:auto}.jq:focus{transform:scale(1.01)}.jr{transition:opacity 100ms 400ms}.js{height:100%}.jt{will-change:transform}.ju{transform:translateZ(0)}.jv{margin:auto}.jw{background-color:rgba(242, 242, 242, 1)}.jx{padding-bottom:34.865725989986345%}.jy{height:0}.jz{filter:blur(20px)}.ka{transform:scale(1.1)}.kb{visibility:visible}.kc{margin-top:10px}.kd{text-align:center}.kg{text-decoration:underline}.kh{line-height:1.58}.ki{letter-spacing:-0.004em}.kj{font-family:charter, Georgia, Cambria, "Times New Roman", Times, serif}.le{margin-bottom:-0.46em}.lf{list-style-type:disc}.lg{margin-left:30px}.lh{padding-left:0px}.ln{background:none}.lo{padding:2px 4px}.lp{font-size:75%}.lq> strong{font-family:inherit}.lr{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.ls{line-height:1.12}.lt{letter-spacing:-0.022em}.lu{font-weight:500}.mn{margin-bottom:-0.28em}.mt{list-style-type:decimal}.mz{padding-bottom:NaN%}.na{padding:20px}.nb{background:rgba(242, 242, 242, 1)}.nc{overflow-x:auto}.nd{line-height:1.18}.ne{margin-top:-0.09em}.nf{margin-bottom:-0.09em}.ng{white-space:pre-wrap}.nh{font-style:italic}.nn{will-change:opacity}.no{width:188px}.np{left:50%}.nq{transform:translateX(406px)}.nr{top:calc(65px + 54px + 14px)}.nu{top:159px}.nw{width:131px}.nx{padding-bottom:28px}.ny{border-bottom:1px solid rgba(230, 230, 230, 1)}.nz{font-size:12px}.oa{line-height:16px}.ob{letter-spacing:0.083em}.oc{text-transform:uppercase}.od{padding-top:2px}.oe{padding-top:14px}.of{padding-top:28px}.og{margin-bottom:19px}.oh{margin-left:-3px}.on{outline:0}.oo{border:0}.op{user-select:none}.oq{cursor:not-allowed}.or> svg{pointer-events:none}.os:active{border-style:none}.ot{-webkit-user-select:none}.ou:focus{fill:rgba(41, 41, 41, 1)}.ov:hover{fill:rgba(41, 41, 41, 1)}.ow{opacity:0.25}.pe button{text-align:left}.pf{opacity:0.4}.pg{padding-right:9px}.pp{margin-top:40px}.pq{border-top:3px solid rgba(102, 138, 170, 1)}.pr{padding:32px 32px 26px 32px}.ps{margin-top:8px}.pt{margin-bottom:25px}.pu{background-color:rgba(250, 250, 250, 1)}.pw{padding-bottom:0px}.qh{padding-top:4px}.qi{font-size:13px}.qj{padding-bottom:10px}.qk{padding-top:8px}.qv{margin:10px 20px 10px 0}.qx{padding:7px 20px 9px}.qy{margin:10px 0 10px 0}.qz{max-width:380px}.ra{padding-bottom:25px}.rb{margin-top:25px}.rc{max-width:155px}.rg{top:1px}.ru{margin-left:-1px}.rv{margin-left:-4px}.sd{padding-right:8px}.se{padding-bottom:40px}.sf{list-style-type:none}.sg{margin-bottom:8px}.sh{line-height:22px}.si{border-radius:3px}.sj{padding:5px 10px}.sm{padding-bottom:4px}.sn{padding-top:32px}.sy{display:-webkit-box}.sz{-webkit-line-clamp:1}.ta{-webkit-box-orient:vertical}.tc{padding-right:168px}.td{padding-top:25px}.tg{max-width:100%}.th{margin-bottom:96px}.ti{background:rgba(255, 255, 255, 1)}.tj{padding:32px 0}.tk{background-color:rgba(0, 0, 0, 0.9)}.tm:hover{color:rgba(255, 255, 255, 0.99)}.tn:hover{fill:rgba(255, 255, 255, 0.99)}.to:disabled{color:rgba(255, 255, 255, 0.7)}.tp:disabled{fill:rgba(255, 255, 255, 0.7)}.tq{height:22px}.tr{color:rgba(255, 255, 255, 0.7)}.ts{width:200px}.tu{color:rgba(255, 255, 255, 0.98)}.tv:hover{text-decoration:underline}.ua{margin-right:16px}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.as{margin:0 64px}.hx{font-size:46px}.hy{margin-top:0.6em}.hz{line-height:56px}.ia{letter-spacing:-0.011em}.is{margin-left:30px}.ji{max-width:1192px}.la{font-size:21px}.lb{margin-top:2em}.lc{line-height:32px}.ld{letter-spacing:-0.003em}.lm{margin-top:1.05em}.mj{font-size:30px}.mk{margin-top:1.95em}.ml{line-height:36px}.mm{letter-spacing:0}.ms{margin-top:0.86em}.my{margin-top:56px}.nm{margin-top:1.91em}.om{margin-right:5px}.pd{margin-top:5px}.po{padding-left:6px}.qf{font-size:22px}.qg{line-height:28px}.qt{font-size:16px}.qu{line-height:24px}.ri{display:inline-block}.rn{margin-left:7px}.ro{margin-top:8px}.rt{width:25px}.sb{padding-left:7px}.sc{top:3px}.sw{font-size:20px}.sx{max-height:24px}.tf{margin:0}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ir{margin-left:30px}.ke{margin-left:auto}.kf{text-align:center}.ol{margin-right:5px}.pc{margin-top:5px}.pn{padding-left:6px}.rh{display:inline-block}.rl{margin-left:7px}.rm{margin-top:8px}.rs{width:25px}.rz{padding-left:7px}.sa{top:3px}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.iq{margin-left:30px}.ok{margin-right:5px}.pb{margin-top:5px}.pl{padding-left:6px}.pm{top:3px}.rf{display:inline-block}.rj{margin-left:7px}.rk{margin-top:8px}.rr{width:15px}.ry{padding-left:3px}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.u{margin-bottom:20px}.af{box-shadow:inset 0 -1px 0 rgba(230, 230, 230, 1)}.ag{min-height:230px}.ak{display:block}.bx{min-height:98px}.by{display:flex}.bz{align-items:flex-start}.ca{flex-direction:column}.cb{justify-content:flex-end}.cg{margin-bottom:28px}.ch{margin-top:0px}.ck{margin-top:28px}.ep{margin:0}.fz{border-top:1px solid rgba(230, 230, 230, 1)}.ga{border-bottom:1px solid rgba(230, 230, 230, 1)}.gj{align-items:center}.gk{flex:1 0 auto}.ie{margin-top:32px}.if{flex-direction:column-reverse}.io{margin-bottom:30px}.ip{margin-left:0px}.oj{margin-left:8px}.oz{margin-top:2px}.pa{margin-right:8px}.pj{padding-left:6px}.pk{top:3px}.pv{padding:24px 24px 28px 24px}.re{display:inline-block}.rq{width:15px}.rx{padding-left:3px}.sk{padding-top:0}.sl{border-top:none}.tl{padding:32px 0}.tt{width:140px}.tw{margin-bottom:16px}.tx{margin-top:30px}.ty{width:100%}.tz{flex-direction:row}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ao{margin:0 24px}.hh{font-size:32px}.hi{margin-top:0.64em}.hj{line-height:40px}.hk{letter-spacing:-0.016em}.id{margin-top:32px}.im{margin-bottom:30px}.in{margin-left:0px}.jb{margin:0}.jc{max-width:100%}.kk{font-size:18px}.kl{margin-top:1.56em}.km{line-height:28px}.kn{letter-spacing:-0.003em}.li{margin-top:1.34em}.lv{font-size:22px}.lw{margin-top:1.2em}.lx{letter-spacing:0}.mo{margin-top:0.67em}.mu{margin-top:40px}.ni{margin-top:1.41em}.oi{margin-left:8px}.ox{margin-top:2px}.oy{margin-right:8px}.ph{padding-left:6px}.pi{top:3px}.px{font-size:20px}.py{line-height:24px}.ql{font-size:14px}.qm{line-height:20px}.qw{margin:10px 0 0 0}.rd{display:inline-block}.rp{width:15px}.rw{padding-left:3px}.so{font-size:16px}.sp{max-height:20px}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ar{margin:0 64px}.ht{font-size:46px}.hu{margin-top:0.6em}.hv{line-height:56px}.hw{letter-spacing:-0.011em}.jh{max-width:1192px}.kw{font-size:21px}.kx{margin-top:2em}.ky{line-height:32px}.kz{letter-spacing:-0.003em}.ll{margin-top:1.05em}.mf{font-size:30px}.mg{margin-top:1.95em}.mh{line-height:36px}.mi{letter-spacing:0}.mr{margin-top:0.86em}.mx{margin-top:56px}.nl{margin-top:1.91em}.qd{font-size:22px}.qe{line-height:28px}.qr{font-size:16px}.qs{line-height:24px}.su{font-size:20px}.sv{max-height:24px}.te{margin:0}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.aq{margin:0 48px}.hp{font-size:46px}.hq{margin-top:0.6em}.hr{line-height:56px}.hs{letter-spacing:-0.011em}.jf{margin:0}.jg{max-width:100%}.ks{font-size:21px}.kt{margin-top:2em}.ku{line-height:32px}.kv{letter-spacing:-0.003em}.lk{margin-top:1.05em}.mb{font-size:30px}.mc{margin-top:1.95em}.md{line-height:36px}.me{letter-spacing:0}.mq{margin-top:0.86em}.mw{margin-top:56px}.nk{margin-top:1.91em}.qb{font-size:22px}.qc{line-height:28px}.qp{font-size:16px}.qq{line-height:24px}.ss{font-size:20px}.st{max-height:24px}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ap{margin:0 24px}.hl{font-size:32px}.hm{margin-top:0.64em}.hn{line-height:40px}.ho{letter-spacing:-0.016em}.jd{margin:0}.je{max-width:100%}.ko{font-size:18px}.kp{margin-top:1.56em}.kq{line-height:28px}.kr{letter-spacing:-0.003em}.lj{margin-top:1.34em}.ly{font-size:22px}.lz{margin-top:1.2em}.ma{letter-spacing:0}.mp{margin-top:0.67em}.mv{margin-top:40px}.nj{margin-top:1.41em}.pz{font-size:20px}.qa{line-height:24px}.qn{font-size:14px}.qo{line-height:20px}.sq{font-size:16px}.sr{max-height:20px}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="print">.it{display:none}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.gg{animation:k2 .2s ease-in-out both}.jn{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.ns{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="all and (max-width: 1230px)">.nt{display:none}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="all and (max-width: 1198px)">.nv{display:none}</style><style type="text/css" data-fela-rehydration="546" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.tb{max-height:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><div class="s"><div class="t s u"><div class="ac ae s af ag"><div class="n ah ai"><div class="aj ak"><div class="al s am an"><div class="n p"><div class="ao ap aq ar as at au v"><div class="av n o"><div class="n o aw ax"><div class="ay" id="li-ShowPostUnderCollection-navbar-open-in-app-button"><div class="az aj ak"><span class="ba b bb bc bd"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc30df3895ef7&amp;~feature=LiOpenInAppButton&amp;~channel=ShowPostUnderCollection&amp;~stage=mobileNavBar&amp;source=post_page-----c30df3895ef7--------------------------------" class="be bf bg bh bi bj bk bl bm bn bo bp bq br bs" rel="noopener nofollow">Open in app</a></span></div></div></div><a href="https://medium.com/?source=post_page-----c30df3895ef7--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="bt bu"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div><div class="n p"><div class="ao ap aq ar as at au v"><div class="bv n o aw bw bx by bz ca cb"><div class="v n cc bw"><div class="n v"><div class="cd ce v n o aw cf cg ch by bz ca"><div class="ci cj s ck"><a href="/?source=post_page-----c30df3895ef7--------------------------------" aria-label="Publication Homepage" rel="noopener"><div class="q cl s"><img alt="Towards Data Science" class="" src="https://miro.medium.com/max/224/1*AGyTPCaRzVqL77kFwUwHKg.png" width="112" height="35"/></div></a></div></div></div><div class="n o cm cn an g"><div class="co cp cq n o"><div class="cr cs"><div class="n" aria-hidden="false"><button aria-label="Publication Menu" class="cv cw bg bh bi bj bk bl bm cx bn"><div class="cy s"><svg class="ct cu" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></div></button></div></div><div class="cz da s"><div class="cr cs"><div class="dh" aria-hidden="false"><div class="n"><button class="cv ds bg bh bi bj bk bl bm bn dt du bq dv dw"><span class="cy s"><svg width="25" height="25" viewBox="0 0 25 25" class="ct"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></span></button><input class="di cx dj dk bc dl dm dn do am dp dq dr" placeholder="Search Towards Data Science" value=""/></div></div></div></div><div class="ay" id="li-post-page-navbar-upsell-button"><div class="co s g"><div><a href="https://medium.com/plans?source=upgrade_membership---nav_full----------------------------------" class="ba b bb bc dn dx bu dy dz ea cu eb bn ec ed ee ef eg eh ei ej ek dh el" rel="noopener">Upgrade</a></div></div></div></div><a href="https://medium.com/?source=post_page-----c30df3895ef7--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="bt em"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div></div><div class="s ak"><div class="n p"><div class="ao ap aq ar as at au v"><div class="w x y z ab"><div class="en eo n o"><div class="s ep"><span class="ba b dk eq er es et eu ev ew ex ey ez"><div class="n o"><div class="fa s"><div class="fb fc s"><div class="dh" aria-hidden="false"><button class="ba b bb bc fd fe ff fg fh fi fj bn ec ed fk fl eh ei ej ek dh el"><div class="n aw">Follow</div></button></div></div></div><div class="co fm ah"><a class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" rel="noopener" href="/followers?source=post_page-----c30df3895ef7--------------------------------">533K Followers</a></div><div class="fr s g">·</div><div class="fr s g"><nav class="n o"><span class="fs n ah"><a href="https://towardsdatascience.com/tagged/editors-pick?fromNav=true&amp;source=post_page-----c30df3895ef7--------------------------------" class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" rel="noopener">Editors&#x27; Picks</a></span><span class="fs n ah"><a href="https://towardsdatascience.com/tagged/tds-features?fromNav=true&amp;source=post_page-----c30df3895ef7--------------------------------" class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" rel="noopener">Features</a></span><span class="fs n ah"><a href="https://towardsdatascience.com/tagged/tds-explore?fromNav=true&amp;source=post_page-----c30df3895ef7--------------------------------" class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" rel="noopener">Explore</a></span><span class="fs n ah"><a class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" rel="noopener" href="/questions-96667b06af5?source=post_page-----c30df3895ef7--------------------------------">Contribute</a></span></nav></div><div class="fr n ah g"><a href="/about?source=post_page-----c30df3895ef7--------------------------------" class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" rel="noopener">About</a></div></div></span></div><div class="aj ft fu ak"><button class="n o p fv fw dp fx" aria-label="Expand navbar"><svg width="14" height="14" class="fy"><path d="M0 .5h14M0 7h14M0 13.5h14"></path></svg></button></div></div></div></div></div></div></div><div class="gh s"><div class="fz ga gb al c gc dl gd ge gf ay an gg"><div class="n p"><div class="ao ap aq ar as at au v"><div class="gi v aj gf an by gj"><div class="aj by gj gk"><div class="ay" id="li-ShowPostUnderCollection-navbar-open-in-app-button"><div class="az aj ak"><span class="ba b bb bc ez"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc30df3895ef7&amp;~feature=LiOpenInAppButton&amp;~channel=ShowPostUnderCollection&amp;~stage=mobileNavBar&amp;source=post_page-----c30df3895ef7--------------------------------" class="gl gm bg bh bi bj bk bl bm bn gn go bq br bs" rel="noopener nofollow">Open in app</a></span></div></div></div><a href="https://medium.com/?source=post_page-----c30df3895ef7--------------------------------" aria-label="Homepage" rel="noopener"><svg viewBox="0 0 1043.63 592.71" class="bt r"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div></div><article><section class="gp gq gr gs v gt ek s"></section><span class="s"></span><div><div class="ft gc gu gv gw gx"></div><section class="gy gz ha ew hb"><div class="n p"><div class="ao ap aq ar as hc au v"><div class=""><h1 id="97ee" class="hd he hf ba hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic">Building fully custom machine learning models on AWS SageMaker: a practical guide</h1><div class="ci"><div class="n bw id ie if"><div class="o n"><div><a href="https://medium.com/@aleksey.bilogur?source=post_page-----c30df3895ef7--------------------------------" rel="noopener"><img alt="Aleksey Bilogur" class="s ig ih ii" src="https://miro.medium.com/fit/c/56/56/1*P57nj94yF-yIPrWJ70GOLg.jpeg" width="28" height="28"/></a></div><div class="fr v n cf"><div class="n"><div style="flex:1"><span class="ba b bb bc ic"><a href="https://medium.com/@aleksey.bilogur?source=post_page-----c30df3895ef7--------------------------------" class="" rel="noopener"><h4 class="ba b bb bc gl">Aleksey Bilogur</h4></a></span></div></div><span class="ba b bb bc ez"><a class="" rel="noopener" href="/building-fully-custom-machine-learning-models-on-aws-sagemaker-a-practical-guide-c30df3895ef7?source=post_page-----c30df3895ef7--------------------------------"><h4 class="ba b bb bc ez"><span class="ij"></span>Feb 13, 2019<span class="ik">·</span>10 min read</h4></a></span></div></div><div class="n il im in io ip iq ir is it"><div class="n o"><div class="iu s"><div class="dh" aria-hidden="false"><button class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div><div class="iv s"><div><div class="iw"><div><div class="dh" role="tooltip" aria-hidden="false"><button class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" aria-label="Bookmark Post"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div><div class="ix s ax"><div class="dh" aria-hidden="false"><div class="dh" aria-hidden="false"><div class="s cm"><button class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" aria-label="More options"><svg class="r iy iz" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div></div><div class="ja"><div class="n p"><div class="jb jc jd je jf jg ar jh as ji au v"><figure class="jk ja jl jm paragraph-image"><div role="button" tabindex="0" class="jn jo am jp v jq"><div class="gr gs jj"><div class="jv s am jw"><div class="jx jy s"><div class="dl jr ft gf gc js v dg jt ju"><img alt="Image for post" class="ft gf gc js v jz ka kb" src="https://miro.medium.com/max/60/1*15ISdDbHJfa-5b4eEQbtuw.png?q=20" width="2197" height="766"/></div><img alt="Image for post" class="dl jr ft gf gc js v c" width="2197" height="766"/><noscript><img alt="Image for post" class="ft gf gc js v" src="https://miro.medium.com/max/4394/1*15ISdDbHJfa-5b4eEQbtuw.png" width="2197" height="766" srcSet="https://miro.medium.com/max/552/1*15ISdDbHJfa-5b4eEQbtuw.png 276w, https://miro.medium.com/max/1104/1*15ISdDbHJfa-5b4eEQbtuw.png 552w, https://miro.medium.com/max/1280/1*15ISdDbHJfa-5b4eEQbtuw.png 640w, https://miro.medium.com/max/1456/1*15ISdDbHJfa-5b4eEQbtuw.png 728w, https://miro.medium.com/max/1632/1*15ISdDbHJfa-5b4eEQbtuw.png 816w, https://miro.medium.com/max/1808/1*15ISdDbHJfa-5b4eEQbtuw.png 904w, https://miro.medium.com/max/1984/1*15ISdDbHJfa-5b4eEQbtuw.png 992w, https://miro.medium.com/max/2000/1*15ISdDbHJfa-5b4eEQbtuw.png 1000w" sizes="1000px"/></noscript></div></div></div></div><figcaption class="kc kd gt gr gs ke kf ba b bb bc ez">Photo by <a href="https://unsplash.com/photos/kyCNGGKCvyw?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="cv kg" target="_blank" rel="noopener nofollow">chuttersnap</a> on <a href="https://unsplash.com/search/photos/container?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="cv kg" target="_blank" rel="noopener nofollow">Unsplash</a></figcaption></figure></div></div></div><div class="n p"><div class="ao ap aq ar as hc au v"><p id="d085" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic"><a href="https://aws.amazon.com/sagemaker/" class="cv kg" target="_blank" rel="noopener nofollow">AWS SageMaker</a> is a cloud machine learning SDK designed for speed of iteration, and it’s one of the f<span id="rmm">a</span>stest-growing toys in the Amazon AWS ecosystem. Since launching in late 2017 SageMaker’s growth has been remarkable — last year’s AWS re:Invent stated that there are now over 10,000 companies using SageMaker to standardize their machine learning processes. SageMaker allows you to to use a Jupyter notebook interface to launch and tear down machine learning processes in handfuls of lines of Python code, something that makes data scientists happy because it abstracts away many of the messy infrastructural details to training. The thesis: standing up your own machine learning algorithm should always be this easy!</p><p id="db56" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">SageMaker has two APIs: a high-level API for working with a variety of pre-optimized machine learning libraries (like <a href="https://sagemaker.readthedocs.io/en/stable/sagemaker.mxnet.html" class="cv kg" target="_blank" rel="noopener nofollow">MXNet</a>, <a href="https://sagemaker.readthedocs.io/en/stable/sagemaker.tensorflow.html" class="cv kg" target="_blank" rel="noopener nofollow">TensorFlow</a>, and <a href="https://sagemaker.readthedocs.io/en/stable/sagemaker.sklearn.html" class="cv kg" target="_blank" rel="noopener nofollow">scikit-learn</a>), and a low-level API that allows running completely custom jobs where anything goes. Any library and any API you can fit into a Docker image can be used with SageMaker, and this approach has some notable advantages:</p><ul class=""><li id="5ee2" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ic">Access to algorithms and libraries that don’t come pre-installed Amazon.</li><li id="d460" class="kh ki hf kj b kk li km kn ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le lf lg lh ic">More flexibility than Amazon’s pre-builds. Pre-built algorithms are configured using a JSON specification, a strategy which has limitations.</li><li id="2906" class="kh ki hf kj b kk li km kn ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le lf lg lh ic">Less vendor lock-in. JSON configs are unlikely to be common across cloud providers.</li><li id="ed9c" class="kh ki hf kj b kk li km kn ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le lf lg lh ic">Compatibility with familiar local tools. You can train a model locally using your local machine or on a local Docker image, then tweak that image to work in SageMaker with minimal effort.</li></ul><p id="14f6" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Even if you’re completely comfortable sticking with the pre-built SageMaker algorithms, building and deploying your own algorithm is nevertheless valuable because it shows you about what SageMaker is doing under the hood — which will come in handy whenever it comes time to debug a model run.</p><p id="419a" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic"><strong class="kj hg">This article shows you how</strong>.</p><p id="9059" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">We will build a simple fully custom image classifier, using a project structure that you can very easily lift and try using yourself for your own projects. Whether you’re totally new to the platform or have played with the SageMaker before, you should walk away from this article equipped with the knowledge necessary to run your own custom machine learning jobs and custom machine learning job infrastructure on top of AWS.</p><p id="d7af" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">I recommend following along both here and <a href="https://github.com/quiltdata/quilt-sagemaker-demo" class="cv kg" target="_blank" rel="noopener nofollow">by looking at the demo code on GitHub</a>. If you are completely new to AWS SageMaker, a good way to get familiar with its feature-set is by reading <a href="https://aws.amazon.com/blogs/aws/sagemaker/" class="cv kg" target="_blank" rel="noopener nofollow">the launch announcement</a>. For a deeper evaluation I also highly recommend “<a href="https://engineering.upside.com/digging-into-aws-sagemaker-first-look-90975d80cd87" class="cv kg" target="_blank" rel="noopener nofollow">Digging into AWS SageMaker — First Look</a>” by <a href="https://medium.com/u/80193450a873?source=post_page-----c30df3895ef7--------------------------------" class="ln gl el" target="_blank" rel="noopener">philarmour</a>.</p><p id="f06e" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Note that to run the code samples in this article for yourself you will need to change the paths in the demo to point to an Amazon S3 bucket you have permissions to— <code class="jw lo lp lq lr b">s3://quilt-example</code> just happens to be a bucket we use for testing internally.</p><h1 id="cc96" class="ls lt hf ba lu lv lw km lx ly lz kq ma mb mc md me mf mg mh mi mj mk ml mm mn ic">First let’s understand how SageMaker works</h1><p id="3208" class="kh ki hf kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le gy ic">Like many other advanced Amazon SDKs SageMaker builds on top of other AWS services you may already be familiar with — specifically <a href="https://aws.amazon.com/s3/" class="cv kg" target="_blank" rel="noopener nofollow">Amazon S3</a> (blob storage), <a href="https://aws.amazon.com/ecr/" class="cv kg" target="_blank" rel="noopener nofollow">Amazon ECR</a> (Docker registry), and <a href="https://aws.amazon.com/ec2/" class="cv kg" target="_blank" rel="noopener nofollow">Amazon EC2</a> (compute).</p><p id="d703" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">The rest of the article will cover deploying the custom model in four steps:</p><ol class=""><li id="5c05" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le mt lg lh ic">Wrapping a model training pipeline in a SageMaker-compatible Docker image</li><li id="a285" class="kh ki hf kj b kk li km kn ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le mt lg lh ic">Uploading that image to Amazon ECR.</li><li id="e42d" class="kh ki hf kj b kk li km kn ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le mt lg lh ic">Using the Python API to schedule that pipeline as a job on an EC2 cluster, saving the model artifacts produced by that run to S3.</li><li id="bf2f" class="kh ki hf kj b kk li km kn ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le mt lg lh ic">Consuming that freshly trained estimator as either (1) a service or (2) a batch job.</li></ol><p id="0720" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Without further ado let’s get started.</p><h1 id="d055" class="ls lt hf ba lu lv lw km lx ly lz kq ma mb mc md me mf mg mh mi mj mk ml mm mn ic">Step 1: Writing the image</h1><p id="5dc4" class="kh ki hf kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le gy ic">Since SageMaker machine learning training jobs are managed using Docker image, the first step to running the job is building the container.</p><p id="49d4" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">If you are unfamiliar with Docker you should pause here and read “<a href="https://medium.freecodecamp.org/a-beginner-friendly-introduction-to-containers-vms-and-docker-79a9e3e119b" class="cv kg" target="_blank" rel="noopener nofollow">A Beginner Friendly Introduction to Containers, VMs, and Docker</a>”.</p><p id="d1cd" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">When SageMaker launches a training image it injects a handful of files and environment variables from the estimator definition. The full list of resources injected is provided <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/your-algorithms-training-algo.html?shortFooter=true#your-algorithms-training-algo-dockerfile" class="cv kg" target="_blank" rel="noopener nofollow">in the documentation</a>. AWS uses these context clues to configure pre-built algorithm runs, but it doesn’t require that custom training jobs do the same, so you can ignore these until you actually need them.</p><p id="3947" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">SageMaker also in turn it expects the image to write outputs to specific places inside the container:</p><ul class=""><li id="a32c" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ic"><code class="jw lo lp lq lr b">/opt/ml/output/failure</code>. If the training job fails, AWS SageMaker recommends writing the reason why to this file, however this is completely optional.</li><li id="10af" class="kh ki hf kj b kk li km kn ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le lf lg lh ic"><code class="jw lo lp lq lr b">/opt/ml/model</code>, This directory is expected to contain a list of model artifacts created by the training job. AWS SageMaker will automatically harvest the files in this folder at the end of the training run, <code class="jw lo lp lq lr b">tar</code> them, and upload them to S3.</li></ul><p id="568d" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">With that in mind, let’s examine an example Docker image that’s SageMaker compatible. Starting with the <code class="jw lo lp lq lr b">Dockerfile</code>:</p><figure class="mu mv mw mx my ja"><div class="jv s am"><div class="mz jy s"></div></div></figure><p id="4a05" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">The SageMaker job runner requires that your container image define an <code class="jw lo lp lq lr b">ENTRYPOINT</code> using the exec syntax (e.g. <code class="jw lo lp lq lr b">ENTRYPOINT [&quot;some&quot;, &quot;commands&quot;]</code>), not the shell syntax (e.g. <code class="jw lo lp lq lr b">ENTRYPOINT some command</code>), as it needs to be able to send <code class="jw lo lp lq lr b">SIGTERM</code> and <code class="jw lo lp lq lr b">SIGKILL</code> signals to the container.</p><p id="d8ad" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Additionally, when executing the container the SageMaker job runner will pass a run-time argument. If it is running the container in training model this will be <code class="jw lo lp lq lr b">train</code>; if the image is being deployed to an endpoint this will be <code class="jw lo lp lq lr b">deploy</code>. If you use the same image for both training your model and for deploying it, you will need to parse this argument to check which mode the container is executing in.</p><p id="9e65" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">That’s it — that’s the full list of restrictions SageMaker places on your image configuration!</p><p id="2dd4" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Here’s the entry-point for this demo <code class="jw lo lp lq lr b">Dockerfile</code>, <code class="jw lo lp lq lr b">run.sh</code>. Ignore the <code class="jw lo lp lq lr b">else</code> clause for now, we will come back to that later.</p><figure class="mu mv mw mx my ja"><div class="jv s am"><div class="mz jy s"></div></div></figure><p id="4de4" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Personally when experimenting with a new model I usually find it most convenient to do my model training in a Jupyter notebook. Here training a new version of a model meaning re-running a <code class="jw lo lp lq lr b">build.ipynb</code> notebook in-place, with <a href="https://nbconvert.readthedocs.io/en/latest/" class="cv kg" target="_blank" rel="noopener nofollow">nbconvert</a> doing all of the heavy lifting. Note that I pass it the <code class="jw lo lp lq lr b">--ExecutePreprocessor.timeout=1</code> argument to disable to <a href="https://github.com/jupyter/nbconvert/issues/256" class="cv kg" target="_blank" rel="noopener nofollow">process timeout</a>, which might otherwise interrupt our model build before it’s finished.</p><p id="e16d" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">I will omit the example model-building notebook itself from this post as it is somewhat besides the point (<a href="https://github.com/quiltdata/quilt-sagemaker-demo" class="cv kg" target="_blank" rel="noopener nofollow">but you can leaf through it out on GitHub</a>). Basically the notebook loads some input data (using the <a href="https://github.com/quiltdata/t4" class="cv kg" target="_blank" rel="noopener nofollow">Quilt T4</a> API, but you may also use raw <code class="jw lo lp lq lr b">boto3</code>) and then trains and validates a simple convolutional neural network (CNN) based on that data. The notebook ends with the following code cell:</p><pre class="mu mv mw mx my na nb nc"><span id="bb9c" class="ic nd lt hf lr b dk ne nf s ng">clf.save(&#x27;clf.h5&#x27;)<br/>!cp clf.h5 /opt/ml/model/clf.h5</span></pre><p id="05ab" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">This creates a model artifact (using the <code class="jw lo lp lq lr b">save</code> utility function in the <code class="jw lo lp lq lr b">keras</code> library) and then copies that artifact to the <code class="jw lo lp lq lr b">/opt/ml/model</code> path for export to S3.</p><h1 id="e27e" class="ls lt hf ba lu lv lw km lx ly lz kq ma mb mc md me mf mg mh mi mj mk ml mm mn ic">Step 2: Upload the image to Amazon ECR</h1><p id="a251" class="kh ki hf kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le gy ic">Now that we’ve written a SageMaker-compatible image definition the next step is registering the image with Amazon’s container registry service, Amazon ECR, so that SageMaker has access to it. Here’s how we do it (using the contents of the <code class="jw lo lp lq lr b">quilt-sagemaker-demo</code> folder, which you get when you <a href="https://github.com/quiltdata/quilt-sagemaker-demo" class="cv kg" target="_blank" rel="noopener nofollow">clone the repository</a>):</p><figure class="mu mv mw mx my ja"><div class="jv s am"><div class="mz jy s"></div></div></figure><p id="f00f" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">If you’re not familiar with the <code class="jw lo lp lq lr b">aws</code> CLI this script is admittedly a little overwhelming. Here’s what it does, step-by-step:</p><ol class=""><li id="083a" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le mt lg lh ic">Gets your region and account number to construct the home ECR registry for your account: <code class="jw lo lp lq lr b">&quot;${account}.dkr.ecr.${region}.amazonaws.com</code>.</li><li id="a0ce" class="kh ki hf kj b kk li km kn ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le mt lg lh ic">Generates a <code class="jw lo lp lq lr b">fullname</code> for your image, which consists of your ECR home registry string plus the name and tag of the image you are about to push.</li><li id="dfb3" class="kh ki hf kj b kk li km kn ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le mt lg lh ic">Logs you into ECR.</li><li id="a481" class="kh ki hf kj b kk li km kn ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le mt lg lh ic">Builds the image locally, then pushes it to ECR.</li></ol><p id="be05" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">When running this script yourself, make sure that the environment you are running it in has upload access to ECR. The default SageMaker cloud notebook environment for example does not have this.</p><h1 id="3e8e" class="ls lt hf ba lu lv lw km lx ly lz kq ma mb mc md me mf mg mh mi mj mk ml mm mn ic">Step 3: Train the model</h1><p id="368b" class="kh ki hf kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le gy ic">It’s now time to train the model.</p><p id="60a3" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">The best way to interact with SageMaker jobs programmatically is using the <code class="jw lo lp lq lr b">sagemaker</code> Python API. You can install it from PyPi by running the usual <code class="jw lo lp lq lr b">pip install sagemaker</code> command. Then you run the following to actually fit the model:</p><figure class="mu mv mw mx my ja"><div class="jv s am"><div class="mz jy s"></div></div></figure><p id="1649" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Training flows through the <code class="jw lo lp lq lr b">sagemaker.estimator.Estimator</code> object, which is parameterized with the image URI, the AWS role and session information used to authorize the run, and the number (&gt;1 == <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/sagemaker-rl-distributed.html" class="cv kg" target="_blank" rel="noopener nofollow">distributed training</a>) and type of EC2 instances to be used for training job. Running the <code class="jw lo lp lq lr b">fit</code> method will spin up new EC2 instance(s), load the training image, and the launch a <code class="jw lo lp lq lr b">docker build ${image} train</code> job on the image.</p><p id="7db8" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Notice the <code class="jw lo lp lq lr b">output_path</code> parameter. Recall from earlier that after completing a container run, SageMaker will harvest any model files written to the <code class="jw lo lp lq lr b">/opt/ml/model</code> path in the image, <code class="jw lo lp lq lr b">tar</code> them, and write them to S3. Use <code class="jw lo lp lq lr b">output_path</code> to specify where that artifact should go.</p><p id="f9f0" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Now that the model is defined it’s time to deploy it. AWS SageMaker currently supports two kinds of deployment: deploying your model as a web endpoint, and using your model to perform a batch job. We’ll cover deploying a web endpoint in this section, then look at how batch jobs work in the next one.</p><h1 id="d098" class="ls lt hf ba lu lv lw km lx ly lz kq ma mb mc md me mf mg mh mi mj mk ml mm mn ic">Step 4a: Deploy the model as a web service</h1><p id="c979" class="kh ki hf kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le gy ic">Now that the model is defined it’s time to deploy it. AWS SageMaker currently supports two kinds of deployment: deploying your model as a web endpoint, and using your model to perform a batch job. We’ll cover deploying a web endpoint in this section, then look at how batch jobs work in the next one.</p><p id="cdbc" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Web service deployment jobs are managed the same way training jobs are: using a Docker image of your choice, this time with the <code class="jw lo lp lq lr b">deploy</code> argument passed at runtime. When AWS SageMaker receives a deployment request, it starts by spinning up the EC2 instance (or instances) and loading in the container. It then uncompresses and injects the model artifact you generated earlier to the <code class="jw lo lp lq lr b">/opt/ml/model</code> path in the container.</p><p id="e11b" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Again using the <code class="jw lo lp lq lr b">sagemaker</code> Python API:</p><figure class="mu mv mw mx my ja"><div class="jv s am"><div class="mz jy s"></div></div></figure><p id="dcde" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">This code instantiates a new <code class="jw lo lp lq lr b">Model</code> using a model artifact, a Docker image, and some auth configuration. Recall that the demo image we built handles both <code class="jw lo lp lq lr b">train</code> and <code class="jw lo lp lq lr b">deploy</code> arguments; hence why we reuse it here. For more complex models you will likely want to use separate train and deploy images.</p><p id="c5d4" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">The image that you deploy is expected to respond to input on port <code class="jw lo lp lq lr b">8080</code> on two paths: <code class="jw lo lp lq lr b">/invocations</code> and <code class="jw lo lp lq lr b">/ping</code>.</p><p id="34c2" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">The <code class="jw lo lp lq lr b">/invocations</code> path is what does the actual work of servicing requests. It should accept <code class="jw lo lp lq lr b">POST</code> requests from users, run your model on the payload (presumably by uncorking the model artifact stored at <code class="jw lo lp lq lr b">${PATH}</code>), then respond with predictions and a status code of 200 (<code class="jw lo lp lq lr b">OK</code>). There is no restriction on your input and output types.</p><p id="35d7" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic"><code class="jw lo lp lq lr b">/invocations</code> have a timeout, which is 60 seconds by default. In other word, if your model takes longer than 60 seconds to respond your request will time out with an error! You may configure the timeout to be higher than 60 seconds if you’d like, but for long-running jobs you should use the batch prediction feature instead (covered in the next section).</p><p id="13f5" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">The other path is <code class="jw lo lp lq lr b">/ping</code>, which should accept <code class="jw lo lp lq lr b">GET</code> requests and act as a health check for your service. At startup time, the EC2 job runner uses <code class="jw lo lp lq lr b">/ping</code> to determine when the container is ready to service requests; your service will <em class="nh">not</em> become available until <code class="jw lo lp lq lr b">/ping</code> starts to return status 200. The HTML body may be empty, and you may implement whatever logic you’d like, including simply always returning status 200, so long as it executes within 2 seconds. The container must succeed a <code class="jw lo lp lq lr b">/ping</code> check within 30 seconds of container startup, otherwise SageMaker will cancel the build and declare it a failure. This means that all of your pre-serving configuration must succeed within 30 seconds (unless you raise this limit in config).</p><p id="1391" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Once the container is running and serving, the SageMaker job runner will continue to run <code class="jw lo lp lq lr b">/ping</code> every five seconds. Failing a <code class="jw lo lp lq lr b">/ping</code> check will temporarily mark your service unavailable.</p><p id="3048" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">So, without further ado, here’s a simple <code class="jw lo lp lq lr b">app.py</code> using <code class="jw lo lp lq lr b">flask</code> that implements all of the necessary logic:</p><figure class="mu mv mw mx my ja"><div class="jv s am"><div class="mz jy s"></div></div></figure><p id="3a07" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">In our example image this app is ultimately what is run whenever we <code class="jw lo lp lq lr b">deploy</code>. Once deployment succeeds you can use the SageMaker API to make requests (granted they have the right authorization, of course) using <code class="jw lo lp lq lr b">predictor.predict(your_data)</code>. For example:</p><pre class="mu mv mw mx my na nb nc"><span id="633f" class="ic nd lt hf lr b dk ne nf s ng">import pandas as pd<br/>X_test = (<br/>  pd.read_csv(&quot;./fashion-mnist_train.csv&quot;)<br/>    .head()<br/>    .iloc[:, 1:]<br/>    .values<br/>)<br/>input = &quot;\n&quot;.join(<br/>    [&quot;,&quot;.join(l) for l in X_test.astype(&#x27;str&#x27;).tolist()]<br/>)<br/>predictor.predict(input)</span><span id="a2ff" class="ic nd lt hf lr b dk ni nj nk nl nm nf s ng">b&#x27;4,\n9,\n4,\n0,\n3&#x27;</span></pre><p id="8a00" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Finally there will come a time when it is time to tear the endpoint down. To do so, run <code class="jw lo lp lq lr b">sess.delete_endpoint(predictor.endpoint)</code>.</p><h1 id="c55e" class="ls lt hf ba lu lv lw km lx ly lz kq ma mb mc md me mf mg mh mi mj mk ml mm mn ic">Step 4b: Deploy the model as a batch job</h1><p id="89da" class="kh ki hf kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le gy ic">The alternative to deploying the model you’ve built as a web endpoint is deploying it as a batch job. You can use the same image you use for deploying a web endpoint for deploying a batch job as well, but instead of using the image to stand up a web endpoint SageMaker will use it to run the model on your input.</p><figure class="mu mv mw mx my ja"><div class="jv s am"><div class="mz jy s"></div></div></figure><p id="1639" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Batch predictions allow for passing large amounts of data through your model, as they do not have the 60-second timeout present on web endpoint -based prediction jobs. Prediction jobs start off by passing an S3 object you specify to your algorithm, and they finish by writing the sum of all predictions to another file (the path to which is dependent on your model). Thus Amazon S3 acts as both the read source and write sink for batch prediction.</p><h1 id="fcf7" class="ls lt hf ba lu lv lw km lx ly lz kq ma mb mc md me mf mg mh mi mj mk ml mm mn ic">Conclusion</h1><p id="d107" class="kh ki hf kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le gy ic">Over the course of this article we saw how SageMaker custom builds allows us to train a flexible machine learning model, then run that model online as either a web endpoint or a batch prediction job. And you are now hopefully well-equipped for running your own machine learning model builds through AWS!</p><p id="66ff" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">As I alluded to in the introduction, the major practical benefit of AWS SageMaker is that it handles your compute for you, allowing you to dash off jobs and stand up experimental services with an abundance of ease. SageMaker can even be used to run in production — though that’s a whole other much more complicated bag of worms that we won’t cover here.</p><p id="91b5" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Feel free to use <a href="https://github.com/quiltdata/quilt-sagemaker-demo" class="cv kg" target="_blank" rel="noopener nofollow">the simple image we built in this article</a> as a template for your own custom SageMaker machine learning models!</p><h1 id="f8a6" class="ls lt hf ba lu lv lw km lx ly lz kq ma mb mc md me mf mg mh mi mj mk ml mm mn ic">Addendum</h1><p id="7fc6" class="kh ki hf kj b kk mo km kn ko mp kq kr ks mq ku kv kw mr ky kz la ms lc ld le gy ic">There is one more thing worth noting. Revisiting <code class="jw lo lp lq lr b">run.sh</code>, the container <code class="jw lo lp lq lr b">ENTRYPOINT</code> and the script that actually gets executed when we <code class="jw lo lp lq lr b">train</code> or <code class="jw lo lp lq lr b">deploy</code> our model:</p><figure class="mu mv mw mx my ja"><div class="jv s am"><div class="mz jy s"></div></div></figure><p id="b255" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">Recall that SageMaker injects our data into the image at runtime. If you try to run the image locally, that file will not auto-magically appear and our container won’t work. Even if you only ever intend to deploy on AWS, the inability to usefully deploy your image locally is a huge pain.</p><p id="0b63" class="kh ki hf kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le gy ic">For this reason I eschew SageMaker import magic and instead use the <a href="https://github.com/quiltdata/t4" class="cv kg" target="_blank" rel="noopener nofollow">Quilt T4</a> API to import the data explicitly — the first three lines in <code class="jw lo lp lq lr b">else</code> (you can also do this using raw <code class="jw lo lp lq lr b">boto3</code>). Make local containers great again!</p></div></div></section></div></article><div class="dl gx gd nn v nu ns nv" data-test-id="post-sidebar"><div class="n p"><div class="ao ap aq ar as at au v"><div class="nw n ah"><div class="gx"><div><div class="nx ny s"><p class="ba b nz oa ob ez oc">Written by</p><div class="jl jm s"><a href="https://medium.com/@aleksey.bilogur?source=post_sidebar--------------------------post_sidebar-----------" class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" rel="noopener"><h2 class="ba lu dk bc he ic gy">Aleksey Bilogur</h2></a></div><div class="od s"><h4 class="ba b bb bc ez">Building tools for doing data science. {📊, 💻, 🛠️}.</h4></div><div class="oe s"></div></div><div class="of og oh n"><div class="n o"><div class="s am oi oj ok ol om"><div class=""><div><div class="dh" role="tooltip" aria-hidden="false"><div class="bl on oo op oq or os ot r ou ov ow"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM18.63 2.22l-1.43-.47-.4 3.03zM11.79 1.75l-1.43.47 1.84 2.56zM24.47 14.3L21.45 9c-.29-.43-.69-.7-1.12-.78a1.16 1.16 0 0 0-.91.22c-.3.23-.48.52-.54.84l.05.07 2.85 5c1.95 3.56 1.32 6.97-1.85 10.14a8.46 8.46 0 0 1-.55.5 5.75 5.75 0 0 0 3.36-1.76c3.26-3.27 3.04-6.75 1.73-8.91M14.58 10.89c-.16-.83.1-1.57.7-2.15l-2.5-2.49c-.5-.5-1.38-.5-1.88 0-.18.18-.27.4-.33.63l4.01 4z"></path><path d="M17.81 10.04a1.37 1.37 0 0 0-.88-.6.81.81 0 0 0-.64.15c-.18.13-.71.55-.24 1.56l1.43 3.03a.54.54 0 1 1-.87.61L9.2 7.38a.99.99 0 1 0-1.4 1.4l4.4 4.4a.54.54 0 1 1-.76.76l-4.4-4.4L5.8 8.3a.99.99 0 0 0-1.4 0 .98.98 0 0 0 0 1.39l1.25 1.24 4.4 4.4a.54.54 0 0 1 0 .76.54.54 0 0 1-.76 0l-4.4-4.4a1 1 0 0 0-1.4 0 .98.98 0 0 0 0 1.4l1.86 1.85 2.76 2.77a.54.54 0 0 1-.76.76L4.58 15.7a.98.98 0 0 0-1.4 0 .99.99 0 0 0 0 1.4l5.33 5.32c3.37 3.37 6.64 4.98 10.49 1.12 2.74-2.74 3.27-5.54 1.62-8.56l-2.8-4.94z"></path></g></svg></div></div></div></div></div><div class="s ox oy oz pa pb pc pd"><div class="pe"><h4 class="ba b bb bc ez"><button class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq">781<!-- --> </button></h4></div></div></div></div><div class="og s"><button class="fx oo bl"><div class="pg n o aw"><svg width="25" height="25" class="r" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg><div class="s am ph pi pj pk pl pm pn po"><h4 class="ba b bb bc ez">8<!-- --> </h4></div></div></button></div><div><div class="iw"><div><div class="dh" role="tooltip" aria-hidden="false"><button class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" aria-label="Bookmark Post"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div><div class="dl gx nn gd no np nq nr ns nt"></div><div><div class="pp ja n ah p"><div class="n p"><div class="ao ap aq ar as hc au v"><div class="pq pr ps pt pu pv"><div class="pw s"><h2 class="ba lu px py lx pz qa ma qb qc me qd qe mi qf qg mm ic">Sign up for The Daily Pick</h2></div><div class="qh s"><h3 class="ba b qi bc ic">By Towards Data Science</h3></div><div class="qj qk s"><p class="ba b ql qm qn qo qp qq qr qs qt qu ic">Hands-on real-world examples, research,  tutorials, and cutting-edge techniques delivered Monday to Thursday. Make learning your daily ritual.<!-- --> <a href="https://medium.com/towards-data-science/newsletters/the-daily-pick?source=newsletter_v3_promo--------------------------newsletter_v3_promo-----------" class="cv ds bg bh bi bj bk bl bm bn bq fp fq kg" rel="noopener">Take a look</a></p></div><div class="n cf"><div class="qv s qw"><button class="ba b dk eq fd qx ff fg fh fi fj bn ec ed fk fl eh ei ej ek dh el"><span class="iv" aria-hidden="true"><svg width="20" height="16" viewBox="0 0 20 16"><path d="M0 .35v15.3h20V.35H0zm6.95 9.38l3.05 2.5 3.05-2.5 4.88 4.73H2.07l4.88-4.73zM1.2 13.64V5.02l4.82 3.94-4.82 4.68zm12.78-4.68l4.82-3.94v8.62l-4.82-4.68zm4.82-7.42v1.94l-8.8 7.2-8.8-7.2V1.54h17.6z"></path></svg></span>Get this newsletter</button></div><div class="qy qz s"><p class="ba b qi bc ic">Emails will be sent to <!-- -->aleksey.bilogur@gmail.com<!-- -->.<div class="s"><span><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Ftowardsdatascience.com%2Fbuilding-fully-custom-machine-learning-models-on-aws-sagemaker-a-practical-guide-c30df3895ef7&amp;source=newsletter_v3_promo--------------------------newsletter_v3_promo-----------" class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" rel="noopener"><button class="cv ds bg bh bi bj bk bl bm bn bq fp fq kg" target="_blank">Not you?</button></a></span></div></p></div></div></div><div class="n cf"></div><div class="n o cf"></div><div class="ra rb s"><div class="rb n bw it"><div class="n aw"><div class="rc s"><span class="s rd re rf e d"><div class="n o"><div class="s am oi oj ok ol om"><div class=""><div><div class="dh" role="tooltip" aria-hidden="false"><div class="bl on oo op oq or os ot r ou ov ow"><svg width="25" height="25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM16.63 1.22L15.2.75l-.4 3.03zM9.79.75l-1.43.47 1.84 2.56zM22.47 13.3L19.45 8c-.29-.43-.69-.7-1.12-.78a1.16 1.16 0 0 0-.91.22c-.3.23-.48.52-.54.84l.05.07 2.85 5c1.95 3.56 1.32 6.97-1.85 10.14a8.46 8.46 0 0 1-.55.5 5.75 5.75 0 0 0 3.36-1.76c3.26-3.27 3.04-6.75 1.73-8.91M12.58 9.89c-.16-.83.1-1.57.7-2.15l-2.5-2.49c-.5-.5-1.38-.5-1.88 0-.18.18-.27.4-.33.63l4.01 4z"></path><path d="M15.81 9.04a1.37 1.37 0 0 0-.88-.6.81.81 0 0 0-.64.15c-.18.13-.72.55-.24 1.56l1.43 3.03a.54.54 0 1 1-.87.61L7.2 6.38a.99.99 0 1 0-1.4 1.4l4.4 4.4a.54.54 0 1 1-.76.76l-4.4-4.4L3.8 7.3a.99.99 0 0 0-1.4 0 .98.98 0 0 0 0 1.39l1.25 1.24 4.4 4.4a.54.54 0 0 1 0 .76.54.54 0 0 1-.76 0l-4.4-4.4a1 1 0 0 0-1.4 0 .98.98 0 0 0 0 1.4l1.86 1.85 2.76 2.77a.54.54 0 0 1-.76.76L2.58 14.7a.98.98 0 0 0-1.4 0 .99.99 0 0 0 0 1.4l5.33 5.32c3.37 3.37 6.64 4.98 10.49 1.12 2.74-2.74 3.27-5.54 1.62-8.56l-2.8-4.94z"></path></g></svg></div></div></div></div></div><div class="s ox oy oz pa pb pc pd"><div class="am rg pe"><h4 class="ba b bb bc ic"><button class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq">781<span class="s h g f rh ri"> </span></button><span class="s h g f rh ri"></span></h4></div></div></div></span><span class="s h g f rh ri"><div class="n cc"><div class="s am oi oj"><div class=""><div><div class="dh" role="tooltip" aria-hidden="false"><div class="bl on oo op oq or os ot r ou ov ow"><svg width="33" height="33" aria-label="clap"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.85-6.78c-.37-.54-.88-.9-1.44-.99a1.5 1.5 0 0 0-1.16.28c-.42.33-.65.74-.7 1.2v.01l3.63 6.37c2.46 4.5 1.67 8.8-2.33 12.8-.27.27-.54.5-.81.73a7.55 7.55 0 0 0 4.45-2.26c4.16-4.17 3.87-8.6 2.21-11.36zm-4.83.82l-3.58-6.3c-.3-.44-.73-.74-1.19-.81a1.1 1.1 0 0 0-.89.2c-.64.51-.75 1.2-.33 2.1l1.83 3.86a.6.6 0 0 1-.2.75.6.6 0 0 1-.77-.07l-9.44-9.44c-.51-.5-1.4-.5-1.9 0a1.33 1.33 0 0 0-.4.95c0 .36.14.7.4.95l5.6 5.61a.6.6 0 1 1-.84.85l-5.6-5.6-.01-.01-1.58-1.59a1.35 1.35 0 0 0-1.9 0 1.35 1.35 0 0 0 0 1.9l1.58 1.59 5.6 5.6a.6.6 0 0 1-.84.86L4.68 13.7c-.51-.51-1.4-.51-1.9 0a1.33 1.33 0 0 0-.4.95c0 .36.14.7.4.95l2.36 2.36 3.52 3.52a.6.6 0 0 1-.84.85l-3.53-3.52a1.34 1.34 0 0 0-.95-.4 1.34 1.34 0 0 0-.95 2.3l6.78 6.78c3.72 3.71 9.33 5.6 13.5 1.43 3.52-3.52 4.2-7.13 2.08-11.01zM11.82 7.72c.06-.32.21-.63.46-.89a1.74 1.74 0 0 1 2.4 0l3.23 3.24a2.87 2.87 0 0 0-.76 2.99l-5.33-5.33zM13.29.48l-1.92.88 2.37 2.84zM21.72 1.36L19.79.5l-.44 3.7zM16.5 3.3L15.48 0h2.04z"></path></g></svg></div></div></div></div></div><div class="s ox oy oz pa rj rk rl rm rn ro"><div class="am rg pe"><h4 class="ba b bb bc ic"><button class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq">781<span class="s h g f rh ri"> </span></button><span class="s h g f rh ri"></span></h4></div></div></div></span></div><div class="s rp rq rr rs rt"></div><button class="fx oo bl"><div class="pg n o aw"><div><div class="dh" role="tooltip" aria-hidden="false"><span class="ru s h g f rh ri"><svg width="33" height="33" viewBox="0 0 33 33" fill="none" class="r" aria-label="responses"><path clip-rule="evenodd" d="M24.28 25.5l.32-.29c2.11-1.94 3.4-4.61 3.4-7.56C28 11.83 22.92 7 16.5 7S5 11.83 5 17.65s5.08 10.66 11.5 10.66c1.22 0 2.4-.18 3.5-.5l.5-.15.41.33a8.86 8.86 0 0 0 4.68 2.1 7.34 7.34 0 0 1-1.3-4.15v-.43zm1 .45c0 1.5.46 2.62 1.69 4.44.22.32.01.75-.38.75a9.69 9.69 0 0 1-6.31-2.37c-1.2.35-2.46.54-3.78.54C9.6 29.3 4 24.09 4 17.65 4 11.22 9.6 6 16.5 6S29 11.22 29 17.65c0 3.25-1.42 6.18-3.72 8.3z"></path></svg></span><span class="rv s rd re rf e d"><svg width="25" height="25" class="r" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></span></div></div><div class="s am rw pi rx pk ry pm rz sa sb sc"><h4 class="ba b bb bc ic">8<!-- --> </h4></div></div></button></div><div class="n o"><div class="iu s"><div class="dh" aria-hidden="false"><button class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div><div class="sd s cm"><div><div class="iw"><div><div class="dh" role="tooltip" aria-hidden="false"><button class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" aria-label="Bookmark Post"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div><div class="dh" aria-hidden="false"><div class="dh" aria-hidden="false"><div class="s cm"><button class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" aria-label="More options"><svg class="r iy iz" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div><div class="se rb s"><ul class="bl bm"><li class="dh sf iv sg"><a href="/tagged/docker" class="ba b qi sh ez si sj el s nb">Docker</a></li><li class="dh sf iv sg"><a href="/tagged/machine-learning" class="ba b qi sh ez si sj el s nb">Machine Learning</a></li><li class="dh sf iv sg"><a href="/tagged/aws" class="ba b qi sh ez si sj el s nb">AWS</a></li><li class="dh sf iv sg"><a href="/tagged/data-engineering" class="ba b qi sh ez si sj el s nb">Data Engineering</a></li><li class="dh sf iv sg"><a href="/tagged/deployment" class="ba b qi sh ez si sj el s nb">Deployment</a></li></ul></div></div></div><div><div class="n p"><div class="ao ap aq ar as hc au v"><div class="s sk sl it"></div></div></div><div class="s it"><div class="sm sn s pu"><div class="n p"><div class="ao ap aq ar as hc au v"><div class="n o bw"><h2 class="ba lu so qm sp lx sq qo sr ma ss qq st me su qs sv mi sw qu sx mm dg df sy sz ta tb ic"><a href="https://towardsdatascience.com/?source=follow_footer-------------------------------------" class="cv ds bg bh bi bj bk bl bm bn fn fo bq fp fq" rel="noopener">More from Towards Data Science</a></h2><div class="dh" aria-hidden="false"><button class="ba b bb bc fd dx ff fg fh fi fj bn ec ed fk fl eh ei ej ek dh el"><div class="n aw">Follow</div></button></div></div><div class="jm tc s"><h4 class="ba b bb bc ez">A Medium publication sharing concepts, ideas, and codes.</h4></div></div></div></div></div><div class="td s pu it"><div class="n p"><div class="jb jd jf te tf tg au v"><div class="th pp s"><div class="tg s kd"><a href="https://towardsdatascience.com/?source=follow_footer-------------------------------------" class="ba b bb bc fd fe ff fg fh fi fj bn ec ed fk fl eh ei ej ek dh el" rel="noopener">Read more from <!-- -->Towards Data Science</a></div></div></div></div></div><div class="s ti it"><div class="n p"><div class="ao ap aq ar as at au v"></div></div></div></div></div></div><div class="tj s tk tl"><div class="n p"><div class="ao ap aq ar as at au v"><div class="n ah"><div class="n o bw"><a href="https://medium.com/?source=post_page-----c30df3895ef7--------------------------------" aria-label="Go to homepage" class="cv ds bg bh bi bj bk bl bm bn tm tn bq to tp" rel="noopener"><svg viewBox="0 0 3940 610" class="ff tq"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><h4 class="ba b bb bc tr"><div class="qk ts n bw tt by"><h4 class="ba b dk eq tu"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----c30df3895ef7--------------------------------" class="cv ds bg bh bi bj bk bl bm bn tv bq to tp" rel="noopener">About</a></h4><h4 class="ba b dk eq tu"><a href="https://help.medium.com/hc/en-us?source=post_page-----c30df3895ef7--------------------------------" class="cv ds bg bh bi bj bk bl bm bn tv bq to tp" rel="noopener">Help</a></h4><h4 class="ba b dk eq tu"><a href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c30df3895ef7--------------------------------" class="cv ds bg bh bi bj bk bl bm bn tv bq to tp" rel="noopener">Legal</a></h4></div></h4></div><div class="aj tw tx by"><h4 class="ba b dk eq tr">Get the Medium app</h4></div><div class="aj tw ty by tz"><div class="ua s"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----c30df3895ef7--------------------------------" class="cv ds bg bh bi bj bk bl bm bn tm tn bq to tp" rel="noopener nofollow"><img alt="A button that says &#x27;Download on the App Store&#x27;, and if clicked it will lead you to the iOS App store" class="" src="https://miro.medium.com/max/270/1*Crl55Tm6yDNMoucPo1tvDg.png" width="135" height="41"/></a></div><div class="s"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----c30df3895ef7--------------------------------" class="cv ds bg bh bi bj bk bl bm bn tm tn bq to tp" rel="noopener nofollow"><img alt="A button that says &#x27;Get it on, Google Play&#x27;, and if clicked it will lead you to the Google Play store" class="" src="https://miro.medium.com/max/270/1*W_RAPQ62h0em559zluJLdQ.png" width="135" height="41"/></a></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__ = "main-20210115-211454-7fb6ff250f"</script><script>window.__GRAPHQL_URI__ = "https://towardsdatascience.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"auroraPage":{"isAuroraPageEnabled":true},"config":{"nodeEnv":"production","version":"main-20210115-211454-7fb6ff250f","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20210115-211454-7fb6ff250f"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"main-20210115-211454-7fb6ff250f","commit":"7fb6ff250fe43fb6fe50c022cd3444d92855bbce"}},"datacenter":"us"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e","9dc80918cc93","8a9336e5bb4","cef6983b292","54c98c43354d","193b68bd4fba","b7e45b22fec3","55760f21cdc5"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*3sela1OADrJr7dJk_CXaEQ.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"performanceTags":[],"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","errorTracking":"none"},"debug":{"requestId":"d3e63143-0602-4e1f-b5c2-0832f7b133b1","branchDeployConfig":null,"originalSpanCarrier":{"ot-tracer-spanid":"0424a9c32dfceb54","ot-tracer-traceid":"16bb6ce77230885","ot-tracer-sampled":"true"}},"session":{"user":{"id":"b6d2cfb88f3"},"xsrf":"7866ef70b26e","isSpoofed":false},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Ftowardsdatascience.com\u002Fbuilding-fully-custom-machine-learning-models-on-aws-sagemaker-a-practical-guide-c30df3895ef7","host":"towardsdatascience.com","hostname":"towardsdatascience.com","referrer":"https:\u002F\u002Fmedium.com\u002Fme\u002Fstories\u002Fpublic","susiModal":{"step":null,"operation":"register"},"postRead":false},"client":{"isBot":false,"isEu":false,"isUs":true,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"inAppBrowserName":"","routingEntity":{"type":"COLLECTION","id":"7f60cf5620c9","explicit":true},"supportsWebp":false,"useNeedForSpeed":false},"multiVote":{"clapsPerPost":{}},"tracing":{}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","variantFlags":[{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"android_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"assign_default_topic_to_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"bane_add_user","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"bane_verify_domain","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"branch_seo_metadata","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"covid_19_cdc_banner","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"default_seo_post_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_android_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_resume_reading_toast","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_mobile_featured_chunk","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_post_recommended_from_friends_provider","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_local_currency","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_annual_renewal_reminder_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_parse_expires_at","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook_renewal_failure","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_about_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_general_admission","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profile_follow_pages","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profile_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_sticky_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_tag_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_autotier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automated_mission_control_triggers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_text_me_the_app","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding_fonts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cleansweep_double_writes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_client_error_tracking","valueType":{"__typename":"VariantFlagString","value":"none"}},{"__typename":"VariantFlag","name":"enable_confirm_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cta_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_curation_priority_queue_experiment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_daily_read_digest_promo","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_dedicated_series_tab_api_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_feature_logging","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_tagline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_earn_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_edit_alt_text","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_email_sign_in_captcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_email_to_subscribers_after_publish","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_embedding_based_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_end_of_post_cleanup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_evhead_com_to_ev_medium_com_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_expanded_feature_chunk_pool","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_by_resend_rules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_expire_processor","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_from_authors_you_may_enjoy","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_fyf_authors_and_collections","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_global_susi_modal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_highlander_member_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_homepage_write_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_increased_digest_timeout","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_post_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_json_logs_trained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex_app_highlights","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex_daily_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_lo_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_notifications","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pay_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post_cd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post_highlights","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post_highlights_view_only","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_profile","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_homepage_for_selected_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_stories","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_unread_notification_count_mutation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_login_code_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_media_resource_try_catch","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_membership_remove_section_a","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_miro_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mission_control","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mute","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_checkout_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_collaborative_filtering_data","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_three_dot_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_no_name_follower_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_parsely","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_patronus_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_popularity_feature","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_page_nav_stickiness_removal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_settings_screen","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_primary_topic_for_mobile","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_design_reminder","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_page_seo_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_all","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_edit_and_delete","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_moderation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rtr_channel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_s3_sites","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_save_to_medium","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_signup_friction","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sohne","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace_ranker_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ticks_digest_promo","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipalti_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_topic_lifecycle_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trending_posts_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_triton_predictions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trumpland_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_unbound","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound"}},{"__typename":"VariantFlag","name":"google_sign_in_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_generic_home_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_iceland_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_pub_follow_email_opt_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"is_not_medium_subscriber","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_fastrak","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_stripe_express","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"make_nav_sticky","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"new_transition_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"provider_for_credit_card_form","valueType":{"__typename":"VariantFlagString","value":"BRAINTREE"}},{"__typename":"VariantFlag","name":"pub_sidebar","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefine_average_post_reading_time","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_post_post_similarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"retrained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"sign_up_with_email_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"skip_sign_in_recaptcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"suppress_apple_missing_expires_date_alert","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"use_new_admin_topic_backend","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"viewer":{"__ref":"User:b6d2cfb88f3"},"meterPost({\"postId\":\"c30df3895ef7\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Fme\u002Fstories\u002Fpublic\"}})":{"__ref":"MeteringInfo:{}"},"postResult({\"id\":\"c30df3895ef7\"})":{"__ref":"Post:c30df3895ef7"}},"User:b6d2cfb88f3":{"id":"b6d2cfb88f3","__typename":"User","username":"aleksey.bilogur","name":"Aleksey Bilogur","imageId":"1*P57nj94yF-yIPrWJ70GOLg.jpeg","mediumMemberAt":0,"hasPastMemberships":false,"isPartnerProgramEnrolled":false,"email":"aleksey.bilogur@gmail.com","unverifiedEmail":"","createdAt":1485660812058,"isAuroraVisible":true,"isEligibleToViewNewResponses":true,"isMembershipTrialEligible":true,"isSuspended":true,"styleEditorOnboardingVersionSeen":0,"allowEmailAddressSharingEditorWriter":false,"hasDomain":false,"dismissableFlags":["FOLLOWERS_TOOLTIP"],"hasCompletedProfile":false,"bio":"Building tools for doing data science. {📊, 💻, 🛠️}.","customStyleSheet":null,"socialStats":{"__typename":"SocialStats","followerCount":421},"isBlocking":false,"isMuting":false,"isFollowing":false,"allowNotes":true,"newsletterV3":null,"viewerIsUser":false,"twitterScreenName":""},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":[],"maxUnlockCount":3,"unlocksRemaining":3},"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png":{"id":"1*ChFMdf--f5jbm-AYv6VdYA@2x.png","__typename":"ImageMetadata"},"CustomStyleSheet:8001c43898e8":{"id":"8001c43898e8","__typename":"CustomStyleSheet","global":{"__typename":"GlobalStyles","colorPalette":{"__typename":"StyleSheetColorPalette","primary":{"__typename":"ColorValue","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFEDF4FC","point":0},{"__typename":"ColorPoint","color":"#FFE9F2FD","point":0.1},{"__typename":"ColorPoint","color":"#FFE6F1FD","point":0.2},{"__typename":"ColorPoint","color":"#FFE2EFFD","point":0.3},{"__typename":"ColorPoint","color":"#FFDFEEFD","point":0.4},{"__typename":"ColorPoint","color":"#FFDBECFE","point":0.5},{"__typename":"ColorPoint","color":"#FFD7EBFE","point":0.6},{"__typename":"ColorPoint","color":"#FFD4E9FE","point":0.7},{"__typename":"ColorPoint","color":"#FFD0E7FF","point":0.8},{"__typename":"ColorPoint","color":"#FFCCE6FF","point":0.9},{"__typename":"ColorPoint","color":"#FFC8E4FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF668AAA","point":0},{"__typename":"ColorPoint","color":"#FF61809D","point":0.1},{"__typename":"ColorPoint","color":"#FF5A7690","point":0.2},{"__typename":"ColorPoint","color":"#FF546C83","point":0.3},{"__typename":"ColorPoint","color":"#FF4D6275","point":0.4},{"__typename":"ColorPoint","color":"#FF455768","point":0.5},{"__typename":"ColorPoint","color":"#FF3D4C5A","point":0.6},{"__typename":"ColorPoint","color":"#FF34414C","point":0.7},{"__typename":"ColorPoint","color":"#FF2B353E","point":0.8},{"__typename":"ColorPoint","color":"#FF21282F","point":0.9},{"__typename":"ColorPoint","color":"#FF161B1F","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF355876","colorPoints":[{"__typename":"ColorPoint","color":"#FF355876","point":0},{"__typename":"ColorPoint","color":"#FF4D6C88","point":0.1},{"__typename":"ColorPoint","color":"#FF637F99","point":0.2},{"__typename":"ColorPoint","color":"#FF7791A8","point":0.3},{"__typename":"ColorPoint","color":"#FF8CA2B7","point":0.4},{"__typename":"ColorPoint","color":"#FF9FB3C6","point":0.5},{"__typename":"ColorPoint","color":"#FFB2C3D4","point":0.6},{"__typename":"ColorPoint","color":"#FFC5D2E1","point":0.7},{"__typename":"ColorPoint","color":"#FFD7E2EE","point":0.8},{"__typename":"ColorPoint","color":"#FFE9F1FA","point":0.9},{"__typename":"ColorPoint","color":"#FFFBFFFF","point":1}]}}},"background":null},"fonts":{"__typename":"StyleSheetFonts","font1":{"__typename":"StyleSheetFont","name":"SANS_SERIF_1"},"font2":{"__typename":"StyleSheetFont","name":"SANS_SERIF_1"},"font3":{"__typename":"StyleSheetFont","name":"SERIF_2"}}},"header":{"__typename":"HeaderStyles","backgroundColor":{"__typename":"ColorValue","colorPalette":{"__typename":"ColorPalette","tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF355876","colorPoints":[{"__typename":"ColorPoint","color":"#FF355876","point":0},{"__typename":"ColorPoint","color":"#FF4D6C88","point":0.1},{"__typename":"ColorPoint","color":"#FF637F99","point":0.2},{"__typename":"ColorPoint","color":"#FF7791A8","point":0.3},{"__typename":"ColorPoint","color":"#FF8CA2B7","point":0.4},{"__typename":"ColorPoint","color":"#FF9FB3C6","point":0.5},{"__typename":"ColorPoint","color":"#FFB2C3D4","point":0.6},{"__typename":"ColorPoint","color":"#FFC5D2E1","point":0.7},{"__typename":"ColorPoint","color":"#FFD7E2EE","point":0.8},{"__typename":"ColorPoint","color":"#FFE9F1FA","point":0.9},{"__typename":"ColorPoint","color":"#FFFBFFFF","point":1}]}},"rgb":"355876","alpha":"ff"},"postBackgroundColor":null,"headerScale":"HEADER_SCALE_MEDIUM","horizontalAlignment":"START","backgroundImageDisplayMode":"IMAGE_DISPLAY_MODE_FILL","backgroundImageVerticalAlignment":"START","backgroundColorDisplayMode":"COLOR_DISPLAY_MODE_SOLID","secondaryBackgroundColor":null,"backgroundImage":null,"nameColor":null,"nameTreatment":"NAME_TREATMENT_LOGO","postNameTreatment":"NAME_TREATMENT_LOGO","logoImage":{"__ref":"ImageMetadata:1*AGyTPCaRzVqL77kFwUwHKg.png"},"logoScale":"HEADER_SCALE_MEDIUM","taglineColor":{"__typename":"ColorValue","rgb":"ffffff","alpha":"ff"},"taglineTreatment":"TAGLINE_TREATMENT_HEADER"},"navigation":{"__typename":"HeaderNavigation","navItems":[{"__typename":"HeaderNavigationItem","name":"Editors' Picks","href":"https:\u002F\u002Ftowardsdatascience.com\u002Ftagged\u002Feditors-pick?fromNav=true","tagSlugs":[],"type":"NAV_TYPE_LINK"},{"__typename":"HeaderNavigationItem","name":"Features","href":"https:\u002F\u002Ftowardsdatascience.com\u002Ftagged\u002Ftds-features?fromNav=true","tagSlugs":[],"type":"NAV_TYPE_LINK"},{"__typename":"HeaderNavigationItem","name":"Explore","href":"https:\u002F\u002Ftowardsdatascience.com\u002Ftagged\u002Ftds-explore?fromNav=true","tagSlugs":[],"type":"NAV_TYPE_LINK"},{"__typename":"HeaderNavigationItem","name":"Contribute","href":"https:\u002F\u002Ftowardsdatascience.com\u002Fquestions-96667b06af5","tagSlugs":[],"type":"NAV_TYPE_LINK"}]},"postBody":null,"postBodyOLI":null,"postBodyULI":null,"postBodyIframe":null,"postBodyImage":null,"postHeaderTitle":null,"postHeaderSubtitle":null,"postHeaderKicker":null,"postBodyP":null,"postBodyBQ":null,"postBodyPQ":null,"postBodyH2":null,"postBodyH3":null,"postBodyHR":null,"postBodyPRE":null},"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png":{"id":"1*mG6i4Bh_LgixUYXJgQpYsg@2x.png","__typename":"ImageMetadata","originalWidth":337,"originalHeight":122},"User:895063a310f4":{"id":"895063a310f4","__typename":"User"},"ImageMetadata:1*hVxgUA6kP-PgL5TJjuyePg.png":{"id":"1*hVxgUA6kP-PgL5TJjuyePg.png","__typename":"ImageMetadata"},"NewsletterV3:d6fe9076899":{"id":"d6fe9076899","__typename":"NewsletterV3","slug":"the-daily-pick","isSubscribed":false,"showPromo":true,"name":"The Daily Pick","description":"Hands-on real-world examples, research,  tutorials, and cutting-edge techniques delivered Monday to Thursday. Make learning your daily ritual.","type":"NEWSLETTER_TYPE_COLLECTION","user":{"__typename":"User","name":"Ludovic Benistant"},"collection":{"__ref":"Collection:7f60cf5620c9"}},"Collection:7f60cf5620c9":{"id":"7f60cf5620c9","__typename":"Collection","domain":"towardsdatascience.com","googleAnalyticsId":null,"slug":"towards-data-science","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","isAuroraVisible":true,"favicon":{"__ref":"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png"},"name":"Towards Data Science","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFEDF4FC","point":0},{"__typename":"ColorPoint","color":"#FFE9F2FD","point":0.1},{"__typename":"ColorPoint","color":"#FFE6F1FD","point":0.2},{"__typename":"ColorPoint","color":"#FFE2EFFD","point":0.3},{"__typename":"ColorPoint","color":"#FFDFEEFD","point":0.4},{"__typename":"ColorPoint","color":"#FFDBECFE","point":0.5},{"__typename":"ColorPoint","color":"#FFD7EBFE","point":0.6},{"__typename":"ColorPoint","color":"#FFD4E9FE","point":0.7},{"__typename":"ColorPoint","color":"#FFD0E7FF","point":0.8},{"__typename":"ColorPoint","color":"#FFCCE6FF","point":0.9},{"__typename":"ColorPoint","color":"#FFC8E4FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF668AAA","point":0},{"__typename":"ColorPoint","color":"#FF61809D","point":0.1},{"__typename":"ColorPoint","color":"#FF5A7690","point":0.2},{"__typename":"ColorPoint","color":"#FF546C83","point":0.3},{"__typename":"ColorPoint","color":"#FF4D6275","point":0.4},{"__typename":"ColorPoint","color":"#FF455768","point":0.5},{"__typename":"ColorPoint","color":"#FF3D4C5A","point":0.6},{"__typename":"ColorPoint","color":"#FF34414C","point":0.7},{"__typename":"ColorPoint","color":"#FF2B353E","point":0.8},{"__typename":"ColorPoint","color":"#FF21282F","point":0.9},{"__typename":"ColorPoint","color":"#FF161B1F","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF355876","colorPoints":[{"__typename":"ColorPoint","color":"#FF355876","point":0},{"__typename":"ColorPoint","color":"#FF4D6C88","point":0.1},{"__typename":"ColorPoint","color":"#FF637F99","point":0.2},{"__typename":"ColorPoint","color":"#FF7791A8","point":0.3},{"__typename":"ColorPoint","color":"#FF8CA2B7","point":0.4},{"__typename":"ColorPoint","color":"#FF9FB3C6","point":0.5},{"__typename":"ColorPoint","color":"#FFB2C3D4","point":0.6},{"__typename":"ColorPoint","color":"#FFC5D2E1","point":0.7},{"__typename":"ColorPoint","color":"#FFD7E2EE","point":0.8},{"__typename":"ColorPoint","color":"#FFE9F1FA","point":0.9},{"__typename":"ColorPoint","color":"#FFFBFFFF","point":1}]}},"customStyleSheet":{"__ref":"CustomStyleSheet:8001c43898e8"},"tagline":"A Medium publication sharing concepts, ideas, and codes.","isAuroraEligible":true,"viewerIsEditor":false,"logo":{"__ref":"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png"},"navItems":[{"__typename":"NavItem","title":"Data Science","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-science\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Machine Learning","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fmachine-learning\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Programming","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fprogramming\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Visualization","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-visualization\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Video","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fvideo\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"★","url":"https:\u002F\u002Ftowardsdatascience.com\u002Feditors-picks\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"About","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fabout-us\u002Fhome","type":"TOPIC_PAGE"},{"__typename":"NavItem","title":"Contribute","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fcontribute\u002Fhome","type":"EXTERNAL_LINK_NAV_ITEM"}],"creator":{"__ref":"User:895063a310f4"},"subscriberCount":533141,"avatar":{"__ref":"ImageMetadata:1*hVxgUA6kP-PgL5TJjuyePg.png"},"isEnrolledInHightower":false,"newsletterV3":{"__ref":"NewsletterV3:d6fe9076899"},"viewerIsFollowing":false,"viewerIsSubscribedToLetters":false,"canToggleEmail":true,"isUserSubscribedToCollectionEmails":false,"viewerIsMuting":false,"viewerCanEditOwnPosts":true,"viewerCanEditPosts":false,"description":"A Medium publication sharing concepts, ideas, and codes.","ampEnabled":false,"twitterUsername":"TDataScience","facebookPageId":null},"ImageMetadata:1*AGyTPCaRzVqL77kFwUwHKg.png":{"id":"1*AGyTPCaRzVqL77kFwUwHKg.png","__typename":"ImageMetadata","originalWidth":1376,"originalHeight":429},"Paragraph:768461106eb4_0":{"id":"768461106eb4_0","__typename":"Paragraph","name":"97ee","text":"Building fully custom machine learning models on AWS SageMaker: a practical guide","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_1":{"id":"768461106eb4_1","__typename":"Paragraph","name":"01ae","text":"Photo by chuttersnap on Unsplash","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*15ISdDbHJfa-5b4eEQbtuw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":9,"end":20,"type":"A","href":"https:\u002F\u002Funsplash.com\u002Fphotos\u002FkyCNGGKCvyw?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":24,"end":32,"type":"A","href":"https:\u002F\u002Funsplash.com\u002Fsearch\u002Fphotos\u002Fcontainer?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_2":{"id":"768461106eb4_2","__typename":"Paragraph","name":"d085","text":"AWS SageMaker is a cloud machine learning SDK designed for speed of iteration, and it’s one of the fastest-growing toys in the Amazon AWS ecosystem. Since launching in late 2017 SageMaker’s growth has been remarkable — last year’s AWS re:Invent stated that there are now over 10,000 companies using SageMaker to standardize their machine learning processes. SageMaker allows you to to use a Jupyter notebook interface to launch and tear down machine learning processes in handfuls of lines of Python code, something that makes data scientists happy because it abstracts away many of the messy infrastructural details to training. The thesis: standing up your own machine learning algorithm should always be this easy!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":13,"type":"A","href":"https:\u002F\u002Faws.amazon.com\u002Fsagemaker\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_3":{"id":"768461106eb4_3","__typename":"Paragraph","name":"db56","text":"SageMaker has two APIs: a high-level API for working with a variety of pre-optimized machine learning libraries (like MXNet, TensorFlow, and scikit-learn), and a low-level API that allows running completely custom jobs where anything goes. Any library and any API you can fit into a Docker image can be used with SageMaker, and this approach has some notable advantages:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":118,"end":123,"type":"A","href":"https:\u002F\u002Fsagemaker.readthedocs.io\u002Fen\u002Fstable\u002Fsagemaker.mxnet.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":125,"end":135,"type":"A","href":"https:\u002F\u002Fsagemaker.readthedocs.io\u002Fen\u002Fstable\u002Fsagemaker.tensorflow.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":141,"end":153,"type":"A","href":"https:\u002F\u002Fsagemaker.readthedocs.io\u002Fen\u002Fstable\u002Fsagemaker.sklearn.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_4":{"id":"768461106eb4_4","__typename":"Paragraph","name":"5ee2","text":"Access to algorithms and libraries that don’t come pre-installed Amazon.","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_5":{"id":"768461106eb4_5","__typename":"Paragraph","name":"d460","text":"More flexibility than Amazon’s pre-builds. Pre-built algorithms are configured using a JSON specification, a strategy which has limitations.","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_6":{"id":"768461106eb4_6","__typename":"Paragraph","name":"2906","text":"Less vendor lock-in. JSON configs are unlikely to be common across cloud providers.","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_7":{"id":"768461106eb4_7","__typename":"Paragraph","name":"ed9c","text":"Compatibility with familiar local tools. You can train a model locally using your local machine or on a local Docker image, then tweak that image to work in SageMaker with minimal effort.","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_8":{"id":"768461106eb4_8","__typename":"Paragraph","name":"14f6","text":"Even if you’re completely comfortable sticking with the pre-built SageMaker algorithms, building and deploying your own algorithm is nevertheless valuable because it shows you about what SageMaker is doing under the hood — which will come in handy whenever it comes time to debug a model run.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_9":{"id":"768461106eb4_9","__typename":"Paragraph","name":"419a","text":"This article shows you how.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":26,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_10":{"id":"768461106eb4_10","__typename":"Paragraph","name":"9059","text":"We will build a simple fully custom image classifier, using a project structure that you can very easily lift and try using yourself for your own projects. Whether you’re totally new to the platform or have played with the SageMaker before, you should walk away from this article equipped with the knowledge necessary to run your own custom machine learning jobs and custom machine learning job infrastructure on top of AWS.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_11":{"id":"768461106eb4_11","__typename":"Paragraph","name":"d7af","text":"I recommend following along both here and by looking at the demo code on GitHub. If you are completely new to AWS SageMaker, a good way to get familiar with its feature-set is by reading the launch announcement. For a deeper evaluation I also highly recommend “Digging into AWS SageMaker — First Look” by philarmour.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":42,"end":79,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fquilt-sagemaker-demo","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":187,"end":210,"type":"A","href":"https:\u002F\u002Faws.amazon.com\u002Fblogs\u002Faws\u002Fsagemaker\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":261,"end":300,"type":"A","href":"https:\u002F\u002Fengineering.upside.com\u002Fdigging-into-aws-sagemaker-first-look-90975d80cd87","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":305,"end":315,"type":"A","href":null,"anchorType":"USER","userId":"80193450a873","linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_12":{"id":"768461106eb4_12","__typename":"Paragraph","name":"f06e","text":"Note that to run the code samples in this article for yourself you will need to change the paths in the demo to point to an Amazon S3 bucket you have permissions to— s3:\u002F\u002Fquilt-example just happens to be a bucket we use for testing internally.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":166,"end":184,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_13":{"id":"768461106eb4_13","__typename":"Paragraph","name":"cc96","text":"First let’s understand how SageMaker works","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_14":{"id":"768461106eb4_14","__typename":"Paragraph","name":"3208","text":"Like many other advanced Amazon SDKs SageMaker builds on top of other AWS services you may already be familiar with — specifically Amazon S3 (blob storage), Amazon ECR (Docker registry), and Amazon EC2 (compute).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":131,"end":140,"type":"A","href":"https:\u002F\u002Faws.amazon.com\u002Fs3\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":157,"end":167,"type":"A","href":"https:\u002F\u002Faws.amazon.com\u002Fecr\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":191,"end":201,"type":"A","href":"https:\u002F\u002Faws.amazon.com\u002Fec2\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_15":{"id":"768461106eb4_15","__typename":"Paragraph","name":"d703","text":"The rest of the article will cover deploying the custom model in four steps:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_16":{"id":"768461106eb4_16","__typename":"Paragraph","name":"5c05","text":"Wrapping a model training pipeline in a SageMaker-compatible Docker image","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_17":{"id":"768461106eb4_17","__typename":"Paragraph","name":"a285","text":"Uploading that image to Amazon ECR.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_18":{"id":"768461106eb4_18","__typename":"Paragraph","name":"e42d","text":"Using the Python API to schedule that pipeline as a job on an EC2 cluster, saving the model artifacts produced by that run to S3.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_19":{"id":"768461106eb4_19","__typename":"Paragraph","name":"bf2f","text":"Consuming that freshly trained estimator as either (1) a service or (2) a batch job.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_20":{"id":"768461106eb4_20","__typename":"Paragraph","name":"0720","text":"Without further ado let’s get started.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_21":{"id":"768461106eb4_21","__typename":"Paragraph","name":"d055","text":"Step 1: Writing the image","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_22":{"id":"768461106eb4_22","__typename":"Paragraph","name":"5dc4","text":"Since SageMaker machine learning training jobs are managed using Docker image, the first step to running the job is building the container.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_23":{"id":"768461106eb4_23","__typename":"Paragraph","name":"49d4","text":"If you are unfamiliar with Docker you should pause here and read “A Beginner Friendly Introduction to Containers, VMs, and Docker”.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":66,"end":129,"type":"A","href":"https:\u002F\u002Fmedium.freecodecamp.org\u002Fa-beginner-friendly-introduction-to-containers-vms-and-docker-79a9e3e119b","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_24":{"id":"768461106eb4_24","__typename":"Paragraph","name":"d1cd","text":"When SageMaker launches a training image it injects a handful of files and environment variables from the estimator definition. The full list of resources injected is provided in the documentation. AWS uses these context clues to configure pre-built algorithm runs, but it doesn’t require that custom training jobs do the same, so you can ignore these until you actually need them.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":176,"end":196,"type":"A","href":"https:\u002F\u002Fdocs.aws.amazon.com\u002Fsagemaker\u002Flatest\u002Fdg\u002Fyour-algorithms-training-algo.html?shortFooter=true#your-algorithms-training-algo-dockerfile","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_25":{"id":"768461106eb4_25","__typename":"Paragraph","name":"3947","text":"SageMaker also in turn it expects the image to write outputs to specific places inside the container:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_26":{"id":"768461106eb4_26","__typename":"Paragraph","name":"a32c","text":"\u002Fopt\u002Fml\u002Foutput\u002Ffailure. If the training job fails, AWS SageMaker recommends writing the reason why to this file, however this is completely optional.","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":22,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_27":{"id":"768461106eb4_27","__typename":"Paragraph","name":"10af","text":"\u002Fopt\u002Fml\u002Fmodel, This directory is expected to contain a list of model artifacts created by the training job. AWS SageMaker will automatically harvest the files in this folder at the end of the training run, tar them, and upload them to S3.","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":13,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":206,"end":209,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_28":{"id":"768461106eb4_28","__typename":"Paragraph","name":"568d","text":"With that in mind, let’s examine an example Docker image that’s SageMaker compatible. Starting with the Dockerfile:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":104,"end":114,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_29":{"id":"768461106eb4_29","__typename":"Paragraph","name":"8783","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:89a6d645342f329b8267b88623914cc0"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_30":{"id":"768461106eb4_30","__typename":"Paragraph","name":"4a05","text":"The SageMaker job runner requires that your container image define an ENTRYPOINT using the exec syntax (e.g. ENTRYPOINT [\"some\", \"commands\"]), not the shell syntax (e.g. ENTRYPOINT some command), as it needs to be able to send SIGTERM and SIGKILL signals to the container.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":70,"end":80,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":109,"end":140,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":170,"end":193,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":227,"end":234,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":239,"end":246,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_31":{"id":"768461106eb4_31","__typename":"Paragraph","name":"d8ad","text":"Additionally, when executing the container the SageMaker job runner will pass a run-time argument. If it is running the container in training model this will be train; if the image is being deployed to an endpoint this will be deploy. If you use the same image for both training your model and for deploying it, you will need to parse this argument to check which mode the container is executing in.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":161,"end":166,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":227,"end":233,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_32":{"id":"768461106eb4_32","__typename":"Paragraph","name":"9e65","text":"That’s it — that’s the full list of restrictions SageMaker places on your image configuration!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_33":{"id":"768461106eb4_33","__typename":"Paragraph","name":"2dd4","text":"Here’s the entry-point for this demo Dockerfile, run.sh. Ignore the else clause for now, we will come back to that later.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":37,"end":47,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":49,"end":55,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":68,"end":72,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_34":{"id":"768461106eb4_34","__typename":"Paragraph","name":"55c1","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:0e4bc755a92cb3f61e5742e359af7cb1"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_35":{"id":"768461106eb4_35","__typename":"Paragraph","name":"4de4","text":"Personally when experimenting with a new model I usually find it most convenient to do my model training in a Jupyter notebook. Here training a new version of a model meaning re-running a build.ipynb notebook in-place, with nbconvert doing all of the heavy lifting. Note that I pass it the --ExecutePreprocessor.timeout=1 argument to disable to process timeout, which might otherwise interrupt our model build before it’s finished.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":188,"end":199,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":290,"end":321,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":224,"end":233,"type":"A","href":"https:\u002F\u002Fnbconvert.readthedocs.io\u002Fen\u002Flatest\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":345,"end":360,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fjupyter\u002Fnbconvert\u002Fissues\u002F256","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_36":{"id":"768461106eb4_36","__typename":"Paragraph","name":"e16d","text":"I will omit the example model-building notebook itself from this post as it is somewhat besides the point (but you can leaf through it out on GitHub). Basically the notebook loads some input data (using the Quilt T4 API, but you may also use raw boto3) and then trains and validates a simple convolutional neural network (CNN) based on that data. The notebook ends with the following code cell:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":246,"end":251,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":107,"end":148,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fquilt-sagemaker-demo","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":207,"end":215,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Ft4","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_37":{"id":"768461106eb4_37","__typename":"Paragraph","name":"bb9c","text":"clf.save('clf.h5')\n!cp clf.h5 \u002Fopt\u002Fml\u002Fmodel\u002Fclf.h5","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_38":{"id":"768461106eb4_38","__typename":"Paragraph","name":"05ab","text":"This creates a model artifact (using the save utility function in the keras library) and then copies that artifact to the \u002Fopt\u002Fml\u002Fmodel path for export to S3.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":41,"end":45,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":70,"end":75,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":122,"end":135,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_39":{"id":"768461106eb4_39","__typename":"Paragraph","name":"e27e","text":"Step 2: Upload the image to Amazon ECR","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_40":{"id":"768461106eb4_40","__typename":"Paragraph","name":"a251","text":"Now that we’ve written a SageMaker-compatible image definition the next step is registering the image with Amazon’s container registry service, Amazon ECR, so that SageMaker has access to it. Here’s how we do it (using the contents of the quilt-sagemaker-demo folder, which you get when you clone the repository):","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":239,"end":259,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":291,"end":311,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fquilt-sagemaker-demo","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_41":{"id":"768461106eb4_41","__typename":"Paragraph","name":"7a35","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:1c10af0de0c1362b818f941fff3d90c4"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_42":{"id":"768461106eb4_42","__typename":"Paragraph","name":"f00f","text":"If you’re not familiar with the aws CLI this script is admittedly a little overwhelming. Here’s what it does, step-by-step:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":32,"end":35,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_43":{"id":"768461106eb4_43","__typename":"Paragraph","name":"083a","text":"Gets your region and account number to construct the home ECR registry for your account: \"${account}.dkr.ecr.${region}.amazonaws.com.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":89,"end":132,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_44":{"id":"768461106eb4_44","__typename":"Paragraph","name":"a0ce","text":"Generates a fullname for your image, which consists of your ECR home registry string plus the name and tag of the image you are about to push.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":12,"end":20,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_45":{"id":"768461106eb4_45","__typename":"Paragraph","name":"dfb3","text":"Logs you into ECR.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_46":{"id":"768461106eb4_46","__typename":"Paragraph","name":"a481","text":"Builds the image locally, then pushes it to ECR.","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_47":{"id":"768461106eb4_47","__typename":"Paragraph","name":"be05","text":"When running this script yourself, make sure that the environment you are running it in has upload access to ECR. The default SageMaker cloud notebook environment for example does not have this.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_48":{"id":"768461106eb4_48","__typename":"Paragraph","name":"3e8e","text":"Step 3: Train the model","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_49":{"id":"768461106eb4_49","__typename":"Paragraph","name":"368b","text":"It’s now time to train the model.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_50":{"id":"768461106eb4_50","__typename":"Paragraph","name":"60a3","text":"The best way to interact with SageMaker jobs programmatically is using the sagemaker Python API. You can install it from PyPi by running the usual pip install sagemaker command. Then you run the following to actually fit the model:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":75,"end":84,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":147,"end":168,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_51":{"id":"768461106eb4_51","__typename":"Paragraph","name":"e5ce","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:4ff8a91c3695f2e33c17439f035baf9f"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_52":{"id":"768461106eb4_52","__typename":"Paragraph","name":"1649","text":"Training flows through the sagemaker.estimator.Estimator object, which is parameterized with the image URI, the AWS role and session information used to authorize the run, and the number (\u003E1 == distributed training) and type of EC2 instances to be used for training job. Running the fit method will spin up new EC2 instance(s), load the training image, and the launch a docker build ${image} train job on the image.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":27,"end":56,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":283,"end":286,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":370,"end":397,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":194,"end":214,"type":"A","href":"https:\u002F\u002Fdocs.aws.amazon.com\u002Fsagemaker\u002Flatest\u002Fdg\u002Fsagemaker-rl-distributed.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_53":{"id":"768461106eb4_53","__typename":"Paragraph","name":"7db8","text":"Notice the output_path parameter. Recall from earlier that after completing a container run, SageMaker will harvest any model files written to the \u002Fopt\u002Fml\u002Fmodel path in the image, tar them, and write them to S3. Use output_path to specify where that artifact should go.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":11,"end":22,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":147,"end":160,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":180,"end":183,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":216,"end":227,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_54":{"id":"768461106eb4_54","__typename":"Paragraph","name":"f9f0","text":"Now that the model is defined it’s time to deploy it. AWS SageMaker currently supports two kinds of deployment: deploying your model as a web endpoint, and using your model to perform a batch job. We’ll cover deploying a web endpoint in this section, then look at how batch jobs work in the next one.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_55":{"id":"768461106eb4_55","__typename":"Paragraph","name":"d098","text":"Step 4a: Deploy the model as a web service","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_56":{"id":"768461106eb4_56","__typename":"Paragraph","name":"c979","text":"Now that the model is defined it’s time to deploy it. AWS SageMaker currently supports two kinds of deployment: deploying your model as a web endpoint, and using your model to perform a batch job. We’ll cover deploying a web endpoint in this section, then look at how batch jobs work in the next one.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_57":{"id":"768461106eb4_57","__typename":"Paragraph","name":"cdbc","text":"Web service deployment jobs are managed the same way training jobs are: using a Docker image of your choice, this time with the deploy argument passed at runtime. When AWS SageMaker receives a deployment request, it starts by spinning up the EC2 instance (or instances) and loading in the container. It then uncompresses and injects the model artifact you generated earlier to the \u002Fopt\u002Fml\u002Fmodel path in the container.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":128,"end":134,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":381,"end":394,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_58":{"id":"768461106eb4_58","__typename":"Paragraph","name":"e11b","text":"Again using the sagemaker Python API:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":16,"end":25,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_59":{"id":"768461106eb4_59","__typename":"Paragraph","name":"cd06","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:b9db02b04edc93eb647f6cffe31746a8"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_60":{"id":"768461106eb4_60","__typename":"Paragraph","name":"dcde","text":"This code instantiates a new Model using a model artifact, a Docker image, and some auth configuration. Recall that the demo image we built handles both train and deploy arguments; hence why we reuse it here. For more complex models you will likely want to use separate train and deploy images.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":29,"end":34,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":153,"end":158,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":163,"end":169,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_61":{"id":"768461106eb4_61","__typename":"Paragraph","name":"c5d4","text":"The image that you deploy is expected to respond to input on port 8080 on two paths: \u002Finvocations and \u002Fping.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":66,"end":70,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":85,"end":97,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":102,"end":107,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_62":{"id":"768461106eb4_62","__typename":"Paragraph","name":"34c2","text":"The \u002Finvocations path is what does the actual work of servicing requests. It should accept POST requests from users, run your model on the payload (presumably by uncorking the model artifact stored at ${PATH}), then respond with predictions and a status code of 200 (OK). There is no restriction on your input and output types.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":4,"end":16,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":91,"end":95,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":201,"end":208,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":267,"end":269,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_63":{"id":"768461106eb4_63","__typename":"Paragraph","name":"35d7","text":"\u002Finvocations have a timeout, which is 60 seconds by default. In other word, if your model takes longer than 60 seconds to respond your request will time out with an error! You may configure the timeout to be higher than 60 seconds if you’d like, but for long-running jobs you should use the batch prediction feature instead (covered in the next section).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":12,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_64":{"id":"768461106eb4_64","__typename":"Paragraph","name":"13f5","text":"The other path is \u002Fping, which should accept GET requests and act as a health check for your service. At startup time, the EC2 job runner uses \u002Fping to determine when the container is ready to service requests; your service will not become available until \u002Fping starts to return status 200. The HTML body may be empty, and you may implement whatever logic you’d like, including simply always returning status 200, so long as it executes within 2 seconds. The container must succeed a \u002Fping check within 30 seconds of container startup, otherwise SageMaker will cancel the build and declare it a failure. This means that all of your pre-serving configuration must succeed within 30 seconds (unless you raise this limit in config).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":18,"end":23,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":45,"end":48,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":143,"end":148,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":256,"end":261,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":484,"end":489,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":229,"end":232,"type":"EM","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_65":{"id":"768461106eb4_65","__typename":"Paragraph","name":"1391","text":"Once the container is running and serving, the SageMaker job runner will continue to run \u002Fping every five seconds. Failing a \u002Fping check will temporarily mark your service unavailable.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":89,"end":94,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":125,"end":130,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_66":{"id":"768461106eb4_66","__typename":"Paragraph","name":"3048","text":"So, without further ado, here’s a simple app.py using flask that implements all of the necessary logic:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":41,"end":47,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":54,"end":59,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_67":{"id":"768461106eb4_67","__typename":"Paragraph","name":"36ac","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:57ca39cb1c585d4826a17dc3419bf357"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_68":{"id":"768461106eb4_68","__typename":"Paragraph","name":"3a07","text":"In our example image this app is ultimately what is run whenever we deploy. Once deployment succeeds you can use the SageMaker API to make requests (granted they have the right authorization, of course) using predictor.predict(your_data). For example:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":68,"end":74,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":209,"end":237,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_69":{"id":"768461106eb4_69","__typename":"Paragraph","name":"633f","text":"import pandas as pd\nX_test = (\n  pd.read_csv(\".\u002Ffashion-mnist_train.csv\")\n    .head()\n    .iloc[:, 1:]\n    .values\n)\ninput = \"\\n\".join(\n    [\",\".join(l) for l in X_test.astype('str').tolist()]\n)\npredictor.predict(input)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_70":{"id":"768461106eb4_70","__typename":"Paragraph","name":"a2ff","text":"b'4,\\n9,\\n4,\\n0,\\n3'","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_71":{"id":"768461106eb4_71","__typename":"Paragraph","name":"8a00","text":"Finally there will come a time when it is time to tear the endpoint down. To do so, run sess.delete_endpoint(predictor.endpoint).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":88,"end":128,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_72":{"id":"768461106eb4_72","__typename":"Paragraph","name":"c55e","text":"Step 4b: Deploy the model as a batch job","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_73":{"id":"768461106eb4_73","__typename":"Paragraph","name":"89da","text":"The alternative to deploying the model you’ve built as a web endpoint is deploying it as a batch job. You can use the same image you use for deploying a web endpoint for deploying a batch job as well, but instead of using the image to stand up a web endpoint SageMaker will use it to run the model on your input.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_74":{"id":"768461106eb4_74","__typename":"Paragraph","name":"2b5f","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:0a3c62b6bd1b7f4173a0f3830ce96779"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_75":{"id":"768461106eb4_75","__typename":"Paragraph","name":"1639","text":"Batch predictions allow for passing large amounts of data through your model, as they do not have the 60-second timeout present on web endpoint -based prediction jobs. Prediction jobs start off by passing an S3 object you specify to your algorithm, and they finish by writing the sum of all predictions to another file (the path to which is dependent on your model). Thus Amazon S3 acts as both the read source and write sink for batch prediction.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_76":{"id":"768461106eb4_76","__typename":"Paragraph","name":"fcf7","text":"Conclusion","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_77":{"id":"768461106eb4_77","__typename":"Paragraph","name":"d107","text":"Over the course of this article we saw how SageMaker custom builds allows us to train a flexible machine learning model, then run that model online as either a web endpoint or a batch prediction job. And you are now hopefully well-equipped for running your own machine learning model builds through AWS!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_78":{"id":"768461106eb4_78","__typename":"Paragraph","name":"66ff","text":"As I alluded to in the introduction, the major practical benefit of AWS SageMaker is that it handles your compute for you, allowing you to dash off jobs and stand up experimental services with an abundance of ease. SageMaker can even be used to run in production — though that’s a whole other much more complicated bag of worms that we won’t cover here.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_79":{"id":"768461106eb4_79","__typename":"Paragraph","name":"91b5","text":"Feel free to use the simple image we built in this article as a template for your own custom SageMaker machine learning models!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":17,"end":58,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fquilt-sagemaker-demo","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_80":{"id":"768461106eb4_80","__typename":"Paragraph","name":"f8a6","text":"Addendum","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_81":{"id":"768461106eb4_81","__typename":"Paragraph","name":"7fc6","text":"There is one more thing worth noting. Revisiting run.sh, the container ENTRYPOINT and the script that actually gets executed when we train or deploy our model:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":49,"end":55,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":71,"end":81,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":133,"end":138,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":142,"end":148,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:768461106eb4_82":{"id":"768461106eb4_82","__typename":"Paragraph","name":"ce45","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:0e4bc755a92cb3f61e5742e359af7cb1"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_83":{"id":"768461106eb4_83","__typename":"Paragraph","name":"b255","text":"Recall that SageMaker injects our data into the image at runtime. If you try to run the image locally, that file will not auto-magically appear and our container won’t work. Even if you only ever intend to deploy on AWS, the inability to usefully deploy your image locally is a huge pain.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:768461106eb4_84":{"id":"768461106eb4_84","__typename":"Paragraph","name":"0b63","text":"For this reason I eschew SageMaker import magic and instead use the Quilt T4 API to import the data explicitly — the first three lines in else (you can also do this using raw boto3). Make local containers great again!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":138,"end":142,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":175,"end":180,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":68,"end":76,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Ft4","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"ImageMetadata:1*15ISdDbHJfa-5b4eEQbtuw.png":{"id":"1*15ISdDbHJfa-5b4eEQbtuw.png","__typename":"ImageMetadata","originalHeight":766,"originalWidth":2197,"focusPercentX":null,"focusPercentY":null,"alt":null},"MediaResource:89a6d645342f329b8267b88623914cc0":{"id":"89a6d645342f329b8267b88623914cc0","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"Dockerfile"},"MediaResource:0e4bc755a92cb3f61e5742e359af7cb1":{"id":"0e4bc755a92cb3f61e5742e359af7cb1","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"run.sh"},"MediaResource:1c10af0de0c1362b818f941fff3d90c4":{"id":"1c10af0de0c1362b818f941fff3d90c4","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"push.sh"},"MediaResource:4ff8a91c3695f2e33c17439f035baf9f":{"id":"4ff8a91c3695f2e33c17439f035baf9f","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"run_model_training_job.py"},"MediaResource:b9db02b04edc93eb647f6cffe31746a8":{"id":"b9db02b04edc93eb647f6cffe31746a8","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"deploy_model.py"},"MediaResource:57ca39cb1c585d4826a17dc3419bf357":{"id":"57ca39cb1c585d4826a17dc3419bf357","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"app.py"},"MediaResource:0a3c62b6bd1b7f4173a0f3830ce96779":{"id":"0a3c62b6bd1b7f4173a0f3830ce96779","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"run_batch_prediction_job.py"},"Tag:docker":{"id":"docker","__typename":"Tag","displayTitle":"Docker"},"Tag:machine-learning":{"id":"machine-learning","__typename":"Tag","displayTitle":"Machine Learning"},"Tag:aws":{"id":"aws","__typename":"Tag","displayTitle":"AWS"},"Tag:data-engineering":{"id":"data-engineering","__typename":"Tag","displayTitle":"Data Engineering"},"Tag:deployment":{"id":"deployment","__typename":"Tag","displayTitle":"Deployment"},"Post:c30df3895ef7":{"id":"c30df3895ef7","__typename":"Post","canonicalUrl":"","collection":{"__ref":"Collection:7f60cf5620c9"},"content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Fme\u002Fstories\u002Fpublic\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","isCacheableContent":false,"bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:768461106eb4_0"},{"__ref":"Paragraph:768461106eb4_1"},{"__ref":"Paragraph:768461106eb4_2"},{"__ref":"Paragraph:768461106eb4_3"},{"__ref":"Paragraph:768461106eb4_4"},{"__ref":"Paragraph:768461106eb4_5"},{"__ref":"Paragraph:768461106eb4_6"},{"__ref":"Paragraph:768461106eb4_7"},{"__ref":"Paragraph:768461106eb4_8"},{"__ref":"Paragraph:768461106eb4_9"},{"__ref":"Paragraph:768461106eb4_10"},{"__ref":"Paragraph:768461106eb4_11"},{"__ref":"Paragraph:768461106eb4_12"},{"__ref":"Paragraph:768461106eb4_13"},{"__ref":"Paragraph:768461106eb4_14"},{"__ref":"Paragraph:768461106eb4_15"},{"__ref":"Paragraph:768461106eb4_16"},{"__ref":"Paragraph:768461106eb4_17"},{"__ref":"Paragraph:768461106eb4_18"},{"__ref":"Paragraph:768461106eb4_19"},{"__ref":"Paragraph:768461106eb4_20"},{"__ref":"Paragraph:768461106eb4_21"},{"__ref":"Paragraph:768461106eb4_22"},{"__ref":"Paragraph:768461106eb4_23"},{"__ref":"Paragraph:768461106eb4_24"},{"__ref":"Paragraph:768461106eb4_25"},{"__ref":"Paragraph:768461106eb4_26"},{"__ref":"Paragraph:768461106eb4_27"},{"__ref":"Paragraph:768461106eb4_28"},{"__ref":"Paragraph:768461106eb4_29"},{"__ref":"Paragraph:768461106eb4_30"},{"__ref":"Paragraph:768461106eb4_31"},{"__ref":"Paragraph:768461106eb4_32"},{"__ref":"Paragraph:768461106eb4_33"},{"__ref":"Paragraph:768461106eb4_34"},{"__ref":"Paragraph:768461106eb4_35"},{"__ref":"Paragraph:768461106eb4_36"},{"__ref":"Paragraph:768461106eb4_37"},{"__ref":"Paragraph:768461106eb4_38"},{"__ref":"Paragraph:768461106eb4_39"},{"__ref":"Paragraph:768461106eb4_40"},{"__ref":"Paragraph:768461106eb4_41"},{"__ref":"Paragraph:768461106eb4_42"},{"__ref":"Paragraph:768461106eb4_43"},{"__ref":"Paragraph:768461106eb4_44"},{"__ref":"Paragraph:768461106eb4_45"},{"__ref":"Paragraph:768461106eb4_46"},{"__ref":"Paragraph:768461106eb4_47"},{"__ref":"Paragraph:768461106eb4_48"},{"__ref":"Paragraph:768461106eb4_49"},{"__ref":"Paragraph:768461106eb4_50"},{"__ref":"Paragraph:768461106eb4_51"},{"__ref":"Paragraph:768461106eb4_52"},{"__ref":"Paragraph:768461106eb4_53"},{"__ref":"Paragraph:768461106eb4_54"},{"__ref":"Paragraph:768461106eb4_55"},{"__ref":"Paragraph:768461106eb4_56"},{"__ref":"Paragraph:768461106eb4_57"},{"__ref":"Paragraph:768461106eb4_58"},{"__ref":"Paragraph:768461106eb4_59"},{"__ref":"Paragraph:768461106eb4_60"},{"__ref":"Paragraph:768461106eb4_61"},{"__ref":"Paragraph:768461106eb4_62"},{"__ref":"Paragraph:768461106eb4_63"},{"__ref":"Paragraph:768461106eb4_64"},{"__ref":"Paragraph:768461106eb4_65"},{"__ref":"Paragraph:768461106eb4_66"},{"__ref":"Paragraph:768461106eb4_67"},{"__ref":"Paragraph:768461106eb4_68"},{"__ref":"Paragraph:768461106eb4_69"},{"__ref":"Paragraph:768461106eb4_70"},{"__ref":"Paragraph:768461106eb4_71"},{"__ref":"Paragraph:768461106eb4_72"},{"__ref":"Paragraph:768461106eb4_73"},{"__ref":"Paragraph:768461106eb4_74"},{"__ref":"Paragraph:768461106eb4_75"},{"__ref":"Paragraph:768461106eb4_76"},{"__ref":"Paragraph:768461106eb4_77"},{"__ref":"Paragraph:768461106eb4_78"},{"__ref":"Paragraph:768461106eb4_79"},{"__ref":"Paragraph:768461106eb4_80"},{"__ref":"Paragraph:768461106eb4_81"},{"__ref":"Paragraph:768461106eb4_82"},{"__ref":"Paragraph:768461106eb4_83"},{"__ref":"Paragraph:768461106eb4_84"}],"sections":[{"__typename":"Section","name":"3daf","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"creator":{"__ref":"User:b6d2cfb88f3"},"customStyleSheet":{"__ref":"CustomStyleSheet:8001c43898e8"},"firstPublishedAt":1550019922829,"isLocked":false,"isPublished":true,"isShortform":false,"layerCake":4,"primaryTopic":null,"title":"Building fully custom machine learning models on AWS SageMaker: a practical guide","mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fbuilding-fully-custom-machine-learning-models-on-aws-sagemaker-a-practical-guide-c30df3895ef7","isLimitedState":false,"visibility":"PUBLIC","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"","sequence":null,"tags":[{"__ref":"Tag:docker"},{"__ref":"Tag:machine-learning"},{"__ref":"Tag:aws"},{"__ref":"Tag:data-engineering"},{"__ref":"Tag:deployment"}],"topics":[{"__typename":"Topic","topicId":"1eca0103fff3","name":"Machine Learning","slug":"machine-learning"},{"__typename":"Topic","topicId":"decb52b64abf","name":"Programming","slug":"programming"}],"viewerClapCount":0,"showSubscribeToProfilePromo":false,"showSubscribeToCollectionNewsletterV3Promo":true,"inResponseToPostResult":null,"isNewsletter":false,"socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1550019922829,"readingTime":9.690566037735849,"previewContent":{"__typename":"PreviewContent","subtitle":"AWS SageMaker is a cloud machine learning SDK designed for speed of iteration, and it’s one of the fastest-growing toys in the Amazon AWS…"},"previewImage":{"__ref":"ImageMetadata:1*15ISdDbHJfa-5b4eEQbtuw.png"},"creatorPartnerProgramEnrollmentStatus":"NOT_ENROLLED","clapCount":781,"lockedSource":"LOCKED_POST_SOURCE_NONE","isSuspended":false,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"pinnedByCreatorAt":0,"curationEligibleAt":0,"shareKey":"6f81588a194dbec7951100d8d4888f9f","responsesCount":8,"collaborators":[],"translationSourcePost":null,"inResponseToMediaResource":null,"isDistributionAlertDismissed":false,"audioVersionUrl":"","seoTitle":"","updatedAt":1603149278264,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","postResponses":{"__typename":"PostResponses","count":8},"latestPublishedVersion":"768461106eb4","isPublishToEmail":false,"readingList":"READING_LIST_NONE","voterCount":153,"recommenders":[]}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.9f0a59eb.js"></script><script src="https://cdn-client.medium.com/lite/static/js/4739.78fb2a04.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.6b01daef.js"></script><script src="https://cdn-client.medium.com/lite/static/js/5573.159bf40f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/instrumentation.b5262cb2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2d4858fa.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1826.f1c2fa77.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4464.c01c0ad8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8342.6aa0b45e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1148.27bc51ff.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5064.fedfa9f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9274.431d8f19.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2846.2eab6f86.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7012.5f022c24.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7993.d921811a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6839.76c7a097.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5127.25f1bb68.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5967.577a90dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8751.0b0595e4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6010.0c79e639.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7131.65798e19.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9809.2014403c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9978.10a970d1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7106.32df7fe7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3277.e57d6ad0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3721.34f2c2c7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2514.34c0377a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2602.6f7e7156.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1304.124bf019.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6098.d8904caa.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8578.935a6d3a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9889.79178434.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3981.14502e6d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/Post.8a4e777c.chunk.js"></script><script>window.main();</script></body></html>