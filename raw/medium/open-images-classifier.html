<!doctype html><html lang="en"><head><script>!function(n,e){var t,o,i,c=[],f={passive:!0,capture:!0},r=new Date,a="pointerup",u="pointercancel";function p(n,c){t||(t=c,o=n,i=new Date,w(e),s())}function s(){o>=0&&o<i-r&&(c.forEach((function(n){n(o,t)})),c=[])}function l(t){if(t.cancelable){var o=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,o){function i(){p(t,o),r()}function c(){r()}function r(){e(a,i,f),e(u,c,f)}n(a,i,f),n(u,c,f)}(o,t):p(o,t)}}function w(n){["click","mousedown","keydown","touchstart","pointerdown"].forEach((function(e){n(e,l,f)}))}w(n),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){c.push(n),s()}}(addEventListener,removeEventListener)</script><script defer src="https://cdn.optimizely.com/js/16180790160.js"></script><title data-rh="true">How to classify photos in 600 classes using nine million Open Images | by Aleksey Bilogur | freeCodeCamp.org | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2019-02-20T18:16:51.360Z"/><meta data-rh="true" name="title" content="How to classify photos in 600 classes using nine million Open Images | by Aleksey Bilogur | freeCodeCamp.org | Medium"/><meta data-rh="true" property="og:title" content="How to classify photos in 600 classes using nine million Open Images"/><meta data-rh="true" property="twitter:title" content="How to classify photos in 600 classes using nine million Open Images"/><meta data-rh="true" name="twitter:site" content="@freecodecamp"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/65847da1a319"/><meta data-rh="true" property="al:android:url" content="medium://p/65847da1a319"/><meta data-rh="true" property="al:ios:url" content="medium://p/65847da1a319"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="If you’re looking build an image classifier but need training data, look no further than Google Open Images. This massive image dataset contains over 30 million images and 15 million bounding boxes…"/><meta data-rh="true" property="og:description" content="If you’re looking to train an image classifier for fun or profit and are in need of data to do it, look no further than Google Open Images…"/><meta data-rh="true" property="twitter:description" content="If you’re looking to train an image classifier for fun or profit and are in need of data to do it, look no further than Google Open Images…"/><meta data-rh="true" property="og:url" content="https://medium.com/free-code-camp/how-to-classify-photos-in-600-classes-using-nine-million-open-images-65847da1a319"/><meta data-rh="true" property="al:web:url" content="https://medium.com/free-code-camp/how-to-classify-photos-in-600-classes-using-nine-million-open-images-65847da1a319"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1200/1*EI4YPmaav7hc79e0GH__BQ.png"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/1*EI4YPmaav7hc79e0GH__BQ.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://medium.com/@aleksey.bilogur"/><meta data-rh="true" name="author" content="Aleksey Bilogur"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" value="Reading time"/><meta data-rh="true" name="twitter:data1" value="8 min read"/><meta data-rh="true" name="parsely-post-id" content="65847da1a319"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/fit/c/152/152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/fit/c/120/120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/fit/c/76/76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/fit/c/60/60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" rel="author" href="https://medium.com/@aleksey.bilogur"/><link data-rh="true" rel="canonical" href="https://medium.com/free-code-camp/how-to-classify-photos-in-600-classes-using-nine-million-open-images-65847da1a319"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/65847da1a319"/><link data-rh="true" rel="icon" href="https://miro.medium.com/1*m-R_BkNf1Qjr1YbyOIJY2w.png"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*EI4YPmaav7hc79e0GH__BQ.png"],"url":"https:\u002F\u002Fmedium.com\u002Ffree-code-camp\u002Fhow-to-classify-photos-in-600-classes-using-nine-million-open-images-65847da1a319","dateCreated":"2019-02-20T18:16:51.360Z","datePublished":"2019-02-20T18:16:51.360Z","dateModified":"2020-10-19T23:11:28.416Z","headline":"How to classify photos in 600 classes using nine million Open Images","name":"How to classify photos in 600 classes using nine million Open Images","description":"If you’re looking build an image classifier but need training data, look no further than Google Open Images. This massive image dataset contains over 30 million images and 15 million bounding boxes…","identifier":"65847da1a319","keywords":["Lite:true","Tag:Machine Learning","Tag:Data Science","Tag:Computer Vision","Tag:Programming","Tag:Technology","Topic:Machine Learning","Topic:Data Science","Topic:Programming","Publication:free-code-camp","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:4"],"author":{"@type":"Person","name":"Aleksey Bilogur","url":"https:\u002F\u002Fmedium.com\u002F@aleksey.bilogur"},"creator":["Aleksey Bilogur"],"publisher":{"@type":"Organization","name":"freeCodeCamp.org","url":"https:\u002F\u002Fmedium.com\u002Ffree-code-camp","logo":{"@type":"ImageObject","width":500,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1000\u002F1*wViBNJ1o9rM5p6b-gf3vxg.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Ffree-code-camp\u002Fhow-to-classify-photos-in-600-classes-using-nine-million-open-images-65847da1a319"}</script><script data-rh="true" >(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="494" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-moz-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:35px}.r{fill:rgba(41, 41, 41, 1)}.s{display:block}.t{position:absolute}.u{top:0}.v{left:0}.w{right:0}.x{z-index:500}.y{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ah{max-width:1192px}.ai{min-width:0}.aj{width:100%}.ak{height:65px}.an{flex:1 0 auto}.ao{height:25px}.ap{fill:rgba(25, 25, 25, 1)}.aq{visibility:hidden}.ar{margin-left:16px}.as{display:none}.au{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.av{font-size:14px}.aw{line-height:20px}.ax{color:rgba(117, 117, 117, 1)}.ay{color:rgba(66, 154, 53, 1)}.az{fill:rgba(66, 154, 53, 1)}.ba{font-size:inherit}.bb{border:inherit}.bc{font-family:inherit}.bd{letter-spacing:inherit}.be{font-weight:inherit}.bf{padding:0}.bg{margin:0}.bh:hover{cursor:pointer}.bi:hover{color:rgba(62, 132, 50, 1)}.bj:hover{fill:rgba(62, 132, 50, 1)}.bk:disabled{cursor:default}.bl:disabled{color:rgba(26, 137, 23, 0.3)}.bm:disabled{fill:rgba(26, 137, 23, 0.3)}.bn{flex:0 0 auto}.bo{fill:rgba(117, 117, 117, 1)}.bp{justify-content:flex-end}.bq{fill:rgba(61, 61, 61, 1)}.br:hover{fill:rgba(8, 8, 8, 1)}.bs{display:inline-block}.bt{padding-bottom:10px}.bu{padding-top:10px}.bx{color:inherit}.by{fill:inherit}.bz:hover{color:rgba(25, 25, 25, 1)}.ca:hover{fill:rgba(25, 25, 25, 1)}.cb:disabled{color:rgba(117, 117, 117, 1)}.cc:disabled{fill:rgba(117, 117, 117, 1)}.cd{margin-left:12px}.ce{margin-right:6px}.cf{margin-top:16px}.cg{margin-bottom:16px}.ch{display:inherit}.ci{max-width:210px}.cj{text-overflow:ellipsis}.ck{overflow:hidden}.cl{white-space:nowrap}.cm{border:none}.cn{outline:none}.co{font:inherit}.cp{font-size:16px}.cq{opacity:0}.cr{background-color:transparent}.cs{color:rgba(41, 41, 41, 1)}.ct::placeholder{color:rgba(117, 117, 117, 1)}.cu{position:relative}.cv{padding:0px}.cw{width:0px}.cx{transition:width 140ms ease-in, padding 140ms ease-in}.cy{padding:4px}.da{margin-right:16px}.db{margin:15px 0}.dc{border-radius:50%}.dd{height:32px}.de{width:32px}.df{border-top:none}.dg{background-color:rgba(0, 100, 0, 1)}.dh{height:54px}.di{margin-right:40px}.dj{height:36px}.dk{width:300px}.dl{overflow:auto}.dm{flex:0 1 auto}.dn{list-style-type:none}.do{line-height:40px}.dp{overflow-x:auto}.dq{align-items:flex-start}.dr{margin-top:20px}.ds{padding-top:20px}.dt{height:80px}.du{height:20px}.dv{margin-right:15px}.dw{margin-left:15px}.dx:first-child{margin-left:0}.dy{min-width:1px}.dz{background-color:rgba(160, 206, 146, 1)}.ea{font-size:13px}.eb{color:rgba(223, 248, 212, 1)}.ec{text-transform:uppercase}.ed{letter-spacing:1px}.ee:hover{color:rgba(233, 252, 223, 1)}.ef:hover{fill:rgba(233, 252, 223, 1)}.eg:disabled{color:rgba(181, 221, 168, 1)}.eh:disabled{fill:rgba(181, 221, 168, 1)}.ei{margin-bottom:0px}.ej{margin-top:0px}.ek{height:119px}.en{padding-left:24px}.eo{padding-right:24px}.ep{margin-left:auto}.eq{margin-right:auto}.er{max-width:728px}.es{box-sizing:border-box}.et{top:calc(100vh + 100px)}.eu{bottom:calc(100vh + 100px)}.ev{width:10px}.ew{pointer-events:none}.ex{word-break:break-word}.ey{word-wrap:break-word}.ez:after{display:block}.fa:after{content:""}.fb:after{clear:both}.fc{max-width:680px}.fd{line-height:1.23}.fe{letter-spacing:0}.ff{font-style:normal}.fg{font-family:fell, Georgia, Cambria, "Times New Roman", Times, serif}.gb{margin-bottom:-0.27em}.gc{margin-top:32px}.gd{justify-content:space-between}.gh{height:48px}.gi{width:48px}.gj{margin-bottom:2px}.gl{max-height:20px}.gm{display:-webkit-box}.gn{-webkit-line-clamp:1}.go{-webkit-box-orient:vertical}.gq:hover{text-decoration:underline}.gr{margin-left:8px}.gs{align-items:flex-end}.ha{padding-right:6px}.hb{margin-right:8px}.hc{margin-right:-6px}.hd:focus{fill:rgba(8, 8, 8, 1)}.he{clear:both}.hn{max-width:2560px}.ht{padding-bottom:5px}.hu{padding-top:5px}.hw{cursor:zoom-in}.hx{z-index:auto}.hy:focus{transform:scale(1.01)}.hz{transition:opacity 100ms 400ms}.ia{height:100%}.ib{will-change:transform}.ic{transform:translateZ(0)}.id{margin:auto}.ie{background-color:rgba(242, 242, 242, 1)}.if{padding-bottom:56.25%}.ig{height:0}.ih{filter:blur(20px)}.ii{transform:scale(1.1)}.ij{visibility:visible}.ik{margin-top:10px}.il{text-align:center}.io{text-decoration:underline}.ip{line-height:1.58}.iq{letter-spacing:-0.004em}.ir{font-family:charter, Georgia, Cambria, "Times New Roman", Times, serif}.jm{margin-bottom:-0.46em}.jn{line-height:1.12}.jo{letter-spacing:-0.022em}.jp{font-weight:500}.ki{margin-bottom:-0.28em}.ko{padding-bottom:NaN%}.kp{padding:20px}.kq{background:rgba(242, 242, 242, 1)}.kr{line-height:1.18}.ks{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.kt{margin-top:-0.09em}.ku{margin-bottom:-0.09em}.kv{white-space:pre-wrap}.kw{padding:2px 4px}.kx{font-size:75%}.ky> strong{font-family:inherit}.kz{max-width:1484px}.la{padding-bottom:97.03504043126685%}.lg{max-width:1392px}.lh{padding-bottom:18.103448275862068%}.li{max-width:1335px}.lj{padding-bottom:18.876404494382022%}.lk{font-weight:700}.ll{list-style-type:disc}.lm{margin-left:30px}.ln{padding-left:0px}.lt{will-change:opacity}.lu{position:fixed}.lv{width:188px}.lw{left:50%}.lx{transform:translateX(406px)}.ly{top:calc(65px + 54px + 14px)}.mb{top:159px}.md{width:131px}.me{flex-direction:column}.mf{padding-bottom:28px}.mg{border-bottom:1px solid rgba(230, 230, 230, 1)}.mh{padding-bottom:20px}.mi{padding-top:2px}.mj{max-height:120px}.mk{-webkit-line-clamp:6}.ml{color:rgba(255, 255, 255, 1)}.mm{padding:4px 12px 6px}.mn{fill:rgba(255, 255, 255, 1)}.mo{background:rgba(66, 154, 53, 1)}.mp{border-color:rgba(66, 154, 53, 1)}.mq:hover{background:rgba(62, 132, 50, 1)}.mr:hover{border-color:rgba(62, 132, 50, 1)}.ms:disabled{cursor:inherit}.mt:disabled{opacity:0.3}.mu:disabled:hover{background:rgba(66, 154, 53, 1)}.mv:disabled:hover{border-color:rgba(66, 154, 53, 1)}.mw{border-radius:4px}.mx{border-width:1px}.my{border-style:solid}.mz{text-decoration:none}.na{flex-direction:row}.nb{padding-top:28px}.nc{margin-bottom:19px}.nd{margin-left:-3px}.nj{outline:0}.nk{border:0}.nl{user-select:none}.nm{cursor:not-allowed}.nn> svg{pointer-events:none}.no:active{border-style:none}.np{-webkit-user-select:none}.nq:focus{fill:rgba(41, 41, 41, 1)}.nr:hover{fill:rgba(41, 41, 41, 1)}.ns{opacity:0.25}.oa button{text-align:left}.ob{opacity:0.4}.oc{cursor:pointer}.od{padding-right:9px}.om{margin-top:40px}.on{flex-wrap:wrap}.oo{margin-top:25px}.op{margin-bottom:8px}.oq{line-height:22px}.or{border-radius:3px}.os{padding:5px 10px}.ot{max-width:155px}.ox{top:1px}.pl{margin-left:-1px}.pm{margin-left:-4px}.pu{padding-right:8px}.pv{padding-top:32px}.pw{border-top:1px solid rgba(230, 230, 230, 1)}.px{margin-bottom:25px}.pz{margin-bottom:32px}.qa{min-height:80px}.qf{width:80px}.qg{padding-left:102px}.qi{line-height:18px}.qj{letter-spacing:0.077em}.qk{margin-bottom:6px}.ql{font-size:22px}.qm{line-height:28px}.qn{max-width:555px}.qo{max-width:450px}.qp{line-height:24px}.qr{max-width:550px}.qs{padding-top:24px}.qt{margin-top:5px}.qu{height:40px}.qv{width:40px}.qw{font-size:12px}.qx{line-height:16px}.qy{letter-spacing:0.083em}.qz{padding-top:8px}.ra{padding:0px 8px 1px}.rb{padding-top:25px}.rd{background:rgba(255, 255, 255, 1)}.re{padding:60px 0}.rf{background-color:rgba(0, 0, 0, 0.9)}.rh{padding-bottom:48px}.ri{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.rj{margin:0 -12px}.rk{margin:0 12px}.rl{flex:1 1 0}.rm{padding-bottom:8px}.rn:hover{color:rgba(255, 255, 255, 0.99)}.ro:hover{fill:rgba(255, 255, 255, 0.99)}.rp:disabled{color:rgba(255, 255, 255, 0.7)}.rq:disabled{fill:rgba(255, 255, 255, 0.7)}.rr{font-size:20px}.rs{color:rgba(255, 255, 255, 0.98)}.rt{color:rgba(255, 255, 255, 0.7)}.ru{height:22px}.rv{width:200px}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ag{margin:0 64px}.fx{font-size:48px}.fy{margin-top:0.55em}.fz{line-height:60px}.ga{letter-spacing:-0.011em}.gz{margin-left:30px}.hm{max-width:1192px}.hs{margin-top:56px}.ji{font-size:21px}.jj{margin-top:2em}.jk{line-height:32px}.jl{letter-spacing:-0.003em}.ke{font-size:30px}.kf{margin-top:1.95em}.kg{line-height:36px}.kh{letter-spacing:0}.kn{margin-top:0.86em}.lf{margin-top:1.91em}.ls{margin-top:1.05em}.ni{margin-right:5px}.nz{margin-top:5px}.ol{padding-left:6px}.oz{display:inline-block}.pe{margin-left:7px}.pf{margin-top:8px}.pk{width:25px}.ps{padding-left:7px}.pt{top:3px}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.gy{margin-left:30px}.im{margin-left:auto}.in{text-align:center}.nh{margin-right:5px}.ny{margin-top:5px}.ok{padding-left:6px}.oy{display:inline-block}.pc{margin-left:7px}.pd{margin-top:8px}.pj{width:25px}.pq{padding-left:7px}.pr{top:3px}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.cz{display:flex}.gx{margin-left:30px}.ng{margin-right:5px}.nx{margin-top:5px}.oi{padding-left:6px}.oj{top:3px}.ow{display:inline-block}.pa{margin-left:7px}.pb{margin-top:8px}.pi{width:15px}.pp{padding-left:3px}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.al{height:56px}.am{display:flex}.at{display:block}.bv{margin-left:10px}.bw{margin-right:10px}.el{margin-bottom:0px}.em{height:110px}.gf{margin-top:32px}.gg{flex-direction:column-reverse}.gv{margin-bottom:30px}.gw{margin-left:0px}.nf{margin-left:8px}.nv{margin-top:2px}.nw{margin-right:8px}.og{padding-left:6px}.oh{top:3px}.ov{display:inline-block}.ph{width:15px}.po{padding-left:3px}.py{padding-top:0}.qb{margin-bottom:24px}.qc{align-items:center}.qd{width:102px}.qe{position:relative}.qh{padding-left:0}.qq{margin-top:24px}.rc{border-top:none}.rg{padding:32px 0}.rw{width:140px}.rx{margin-bottom:16px}.ry{margin-top:30px}.rz{width:100%}.sa{flex-direction:row}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ab{margin:0 24px}.fh{font-size:34px}.fi{margin-top:0.56em}.fj{line-height:42px}.fk{letter-spacing:-0.016em}.ge{margin-top:32px}.gk{margin-bottom:0px}.gt{margin-bottom:30px}.gu{margin-left:0px}.hf{margin:0}.hg{max-width:100%}.ho{margin-top:40px}.is{font-size:18px}.it{margin-top:1.56em}.iu{line-height:28px}.iv{letter-spacing:-0.003em}.jq{font-size:22px}.jr{margin-top:1.2em}.js{letter-spacing:0}.kj{margin-top:0.67em}.lb{margin-top:1.41em}.lo{margin-top:1.34em}.ne{margin-left:8px}.nt{margin-top:2px}.nu{margin-right:8px}.oe{padding-left:6px}.of{top:3px}.ou{display:inline-block}.pg{width:15px}.pn{padding-left:3px}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.af{margin:0 64px}.ft{font-size:48px}.fu{margin-top:0.55em}.fv{line-height:60px}.fw{letter-spacing:-0.011em}.hl{max-width:1192px}.hr{margin-top:56px}.je{font-size:21px}.jf{margin-top:2em}.jg{line-height:32px}.jh{letter-spacing:-0.003em}.ka{font-size:30px}.kb{margin-top:1.95em}.kc{line-height:36px}.kd{letter-spacing:0}.km{margin-top:0.86em}.le{margin-top:1.91em}.lr{margin-top:1.05em}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.ae{margin:0 48px}.fp{font-size:48px}.fq{margin-top:0.55em}.fr{line-height:60px}.fs{letter-spacing:-0.011em}.hj{margin:0}.hk{max-width:100%}.hq{margin-top:56px}.ja{font-size:21px}.jb{margin-top:2em}.jc{line-height:32px}.jd{letter-spacing:-0.003em}.jw{font-size:30px}.jx{margin-top:1.95em}.jy{line-height:36px}.jz{letter-spacing:0}.kl{margin-top:0.86em}.ld{margin-top:1.91em}.lq{margin-top:1.05em}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ac{margin:0 24px}.fl{font-size:34px}.fm{margin-top:0.56em}.fn{line-height:42px}.fo{letter-spacing:-0.016em}.hh{margin:0}.hi{max-width:100%}.hp{margin-top:40px}.iw{font-size:18px}.ix{margin-top:1.56em}.iy{line-height:28px}.iz{letter-spacing:-0.003em}.jt{font-size:22px}.ju{margin-top:1.2em}.jv{letter-spacing:0}.kk{margin-top:0.67em}.lc{margin-top:1.41em}.lp{margin-top:1.34em}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="print">.z{display:none}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.gp{max-height:none}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.hv{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.lz{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="all and (max-width: 1230px)">.ma{display:none}</style><style type="text/css" data-fela-rehydration="494" data-fela-type="RULE" media="all and (max-width: 1198px)">.mc{display:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><div class="s"><nav class="s t u v w c x y z"><div><div class="s c"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="ak n o al am"><div class="n o an x"><a rel="noopener" href="/?source=post_page-----65847da1a319--------------------------------"><svg viewBox="0 0 1043.63 592.71" class="ao ap"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a><div class="aq" id="li-ShowPostUnderCollection-navbar-open-in-app-button"><div class="ar as at"><span class="au b av aw ax"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F65847da1a319&amp;~feature=LiOpenInAppButton&amp;~channel=ShowPostUnderCollection&amp;~stage=mobileNavBar&amp;source=post_page-----65847da1a319--------------------------------" class="ay az ba bb bc bd be bf bg bh bi bj bk bl bm" rel="noopener nofollow">Open in app</a></span></div></div></div><div class="s bn x"><div class="n o bp"><div class="bs" aria-hidden="false"><div class="bt bu ar n bv bw am"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc"><svg class="bq br" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg><span style="border:0;clip:rect(1px, 1px, 1px, 1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;word-wrap:normal !important">Post management tools menu</span></button></div></div><div class="cd ce n f"><div class="bs" aria-hidden="false"><div class="n"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc"><span class="cy s"><svg width="25" height="25" viewBox="0 0 25 25" class="bo"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></span></button><input class="cm cn co cp aw cq cr cs ct cu cv cw cx" placeholder="Search freeCodeCamp.org" value=""/></div></div></div><div class="as cz"><a href="/search?source=post_page-----65847da1a319--------------------------------" aria-label="Search" class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" rel="noopener"><span class="ar da s bv bw"><svg width="25" height="25" viewBox="0 0 25 25" class="bo"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></span></a></div><div class="da n bw"><span class="db s"><svg width="25" height="25" viewBox="-293 409 25 25" class="bo"><path d="M-273.33 423.67l-1.67-1.52v-3.65a5.5 5.5 0 0 0-6.04-5.47 5.66 5.66 0 0 0-4.96 5.71v3.41l-1.68 1.55a1 1 0 0 0-.32.74V427a1 1 0 0 0 1 1h3.49a3.08 3.08 0 0 0 3.01 2.45 3.08 3.08 0 0 0 3.01-2.45h3.49a1 1 0 0 0 1-1v-2.59a1 1 0 0 0-.33-.74zm-7.17 5.63c-.84 0-1.55-.55-1.81-1.3h3.62a1.92 1.92 0 0 1-1.81 1.3zm6.35-2.45h-12.7v-2.35l1.63-1.5c.24-.22.37-.53.37-.85v-3.41a4.51 4.51 0 0 1 3.92-4.57 4.35 4.35 0 0 1 4.78 4.33v3.65c0 .32.14.63.38.85l1.62 1.48v2.37z"></path></svg></span></div><div class="n" aria-hidden="false"><div class="n o"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc"><img alt="Aleksey Bilogur" class="s dc dd de" src="https://miro.medium.com/fit/c/64/64/1*P57nj94yF-yIPrWJ70GOLg.jpeg" width="32" height="32"/></button></div></div></div></div></div></div></div></div><div class="df s dg at"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="dh ck n o"><div class="di s bn"><a href="/free-code-camp?source=post_page-----65847da1a319--------------------------------" rel="noopener"><div class="dj dk s"><img alt="freeCodeCamp.org" class="" src="https://miro.medium.com/max/600/1*wViBNJ1o9rM5p6b-gf3vxg.png" width="300" height="36"/></div></a></div><div class="dl s dm"><ul class="dn bg do cl dp n dq g dr ds dt"><li class="n o du dv dw dx"><span class="au b ea aw eb ec ed"><a href="https://medium.com/free-code-camp/archive?source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh ee ef bk eg eh" rel="noopener">Archive</a></span></li><span class="du dy dz"></span><li class="n o du dv dw dx"><span class="au b ea aw eb ec ed"><a href="https://www.freecodecamp.org/news?source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh ee ef bk eg eh" rel="noopener nofollow">Check out our new site: freeCodeCamp News</a></span></li></ul></div></div></div></div></div></div></nav><div class="ei ej ek s el em"></div><article><section class="en eo ep eq aj er es s"></section><span class="s"></span><div><div class="t v et eu ev ew"></div><section class="ex ey ez fa fb"><div class="n p"><div class="ab ac ae af ag fc ai aj"><div class=""><h1 id="6987" class="fd fe ff fg b fh fi fj fk fl fm fn fo fp fq fr fs ft fu fv fw fx fy fz ga gb cs">How to classify photos in 600 classes using nine million Open Images</h1><div class="gc"><div class="n gd ge gf gg"><div class="o n"><div><a rel="noopener" href="/@aleksey.bilogur?source=post_page-----65847da1a319--------------------------------"><img alt="Aleksey Bilogur" class="s dc gh gi" src="https://miro.medium.com/fit/c/96/96/1*P57nj94yF-yIPrWJ70GOLg.jpeg" width="48" height="48"/></a></div><div class="cd aj s"><div class="n"><div style="flex:1"><span class="au b av aw cs"><div class="gj n o gk"><span class="au b av aw ck gl cj gm gn go gp cs"><a class="bx by ba bb bc bd be bf bg bh gq bk cb cc" rel="noopener" href="/@aleksey.bilogur?source=post_page-----65847da1a319--------------------------------">Aleksey Bilogur</a></span><div class="gr s bn h"></div></div></span></div></div><span class="au b av aw ax"><span class="au b av aw ck gl cj gm gn go gp ax"><div><a class="bx by ba bb bc bd be bf bg bh gq bk cb cc" rel="noopener" href="/free-code-camp/how-to-classify-photos-in-600-classes-using-nine-million-open-images-65847da1a319?source=post_page-----65847da1a319--------------------------------">Feb 20, 2019</a> <!-- -->·<!-- --> <!-- -->8<!-- --> min read</div></span></span></div></div><div class="n gs gt gu gv gw gx gy gz z"><div class="n o"><div class="ha s bn"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" aria-label="Share on twitter"><svg width="29" height="29" class="bo"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="ha s bn"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="bo"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="ha s bn"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" aria-label="Share on facebook"><svg width="29" height="29" class="bo"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="hb s"><div><div class="bq"><div><div class="bs" role="tooltip" aria-hidden="false"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" aria-label="Bookmark Post"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div><div class="hc s an"><div class="bs" aria-hidden="false"><div class="bs" aria-hidden="false"><div class="s bn"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" aria-label="More options"><svg class="r br hd" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div></div><div class="he"><div class="n p"><div class="hf hg hh hi hj hk af hl ag hm ai aj"><figure class="ho hp hq hr hs he ht hu paragraph-image"><div role="button" tabindex="0" class="hv hw cu hx aj hy"><div class="ep eq hn"><div class="id s cu ie"><div class="if ig s"><div class="cq hz t u v ia aj ck ib ic"><img alt="Image for post" class="t u v ia aj ih ii ij" src="https://miro.medium.com/max/60/1*EI4YPmaav7hc79e0GH__BQ.png?q=20" width="2560" height="1440"/></div><img alt="Image for post" class="cq hz t u v ia aj c" width="2560" height="1440"/><noscript><img alt="Image for post" class="t u v ia aj" src="https://miro.medium.com/max/5120/1*EI4YPmaav7hc79e0GH__BQ.png" width="2560" height="1440" srcSet="https://miro.medium.com/max/552/1*EI4YPmaav7hc79e0GH__BQ.png 276w, https://miro.medium.com/max/1104/1*EI4YPmaav7hc79e0GH__BQ.png 552w, https://miro.medium.com/max/1280/1*EI4YPmaav7hc79e0GH__BQ.png 640w, https://miro.medium.com/max/1456/1*EI4YPmaav7hc79e0GH__BQ.png 728w, https://miro.medium.com/max/1632/1*EI4YPmaav7hc79e0GH__BQ.png 816w, https://miro.medium.com/max/1808/1*EI4YPmaav7hc79e0GH__BQ.png 904w, https://miro.medium.com/max/1984/1*EI4YPmaav7hc79e0GH__BQ.png 992w, https://miro.medium.com/max/2000/1*EI4YPmaav7hc79e0GH__BQ.png 1000w" sizes="1000px"/></noscript></div></div></div></div><figcaption class="ik il er ep eq im in au b av aw ax">Sandwiches, visualized using the <a href="https://storage.googleapis.com/openimages/web/visualizer/index.html?set=train&amp;c=%2Fm%2F0l515" class="bx io" target="_blank" rel="noopener nofollow">Google Open Images Explorer</a></figcaption></figure></div></div></div><div class="n p"><div class="ab ac ae af ag fc ai aj"><p id="3a5e" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">If you’re looking build an image classifier but need training data, look no further than <a href="https://storage.googleapis.com/openimages/web/index.html" class="bx io" target="_blank" rel="noopener nofollow">Google Open Images</a>.</p><p id="5b5d" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">This massive image dataset contains over 30 million images and 15 million bounding boxes. That’s 18 terabytes of image data!</p><p id="4100" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Plus, Open Images is much more open and accessible than certain other image datasets at this scale. For example, ImageNet has restrictive licensing.</p><p id="3394" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">However, it’s not easy for developers on single machines to sift through that much data.You need to download and process multiple metadata files, and roll their own storage space (or apply for access to a Google Cloud bucket).</p><p id="1bc4" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">On the other hand, there aren’t many custom image training sets in the wild, because frankly they’re a pain to create and share.</p><p id="976b" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">In this article, we’ll build and distribute a simple end-to-end machine learning pipeline using Open Images.</p><p id="7d87" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">We’ll see how to create your own dataset around any of the 600 labels included in the Open Images bounding box data.</p><p id="6350" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">We’ll show off our handiwork by building “open sandwiches”. These are simple, reproducible image classifiers built to answer an age-old question: <a href="https://english.stackexchange.com/questions/246580/is-a-hamburger-considered-a-sandwich" class="bx io" target="_blank" rel="noopener nofollow">is a hamburger a sandwich</a>?</p><p id="52e2" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Want to see the code? You can follow along in <a href="https://github.com/quiltdata/open-images" class="bx io" target="_blank" rel="noopener nofollow">the repository on GitHub</a>.</p><h1 id="a307" class="jn jo ff au jp jq jr iu js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki cs">Downloading the data</h1><p id="7c0d" class="ip iq ff ir b is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji kn jk jl jm ex cs">We need to download the relevant data before we can do anything with it.</p><p id="e6d4" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">This is the core challenge when working with Google Open Images (or any external dataset really). There is no easy way to download a subset of the data. We need to write a script that does so for us.</p><p id="3ee6" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">I’ve written a Python script that searches the metadata in the <a href="https://github.com/openimages/dataset" class="bx io" target="_blank" rel="noopener nofollow">Open Images data set</a> for keywords that you specify. It finds the original URLs of the corresponding images (on <a href="https://www.flickr.com/" class="bx io" target="_blank" rel="noopener nofollow">Flickr</a>), then downloads them to disk.</p><p id="521b" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">It’s a testament to the power of Python that you can do all of this in just 50 lines of code:</p><figure class="ho hp hq hr hs he"><div class="id s cu"><div class="ko ig s"></div></div><figcaption class="ik il er ep eq im in au b av aw ax">For comments on the code and instructions for using it yourself see <a href="https://github.com/quiltdata/open-images" class="bx io" target="_blank" rel="noopener nofollow">the GitHub repository</a>.</figcaption></figure><p id="5495" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">This script enables you to download the subset of raw images which have bounding box information for any subset of categories of our choice:</p><pre class="ho hp hq hr hs kp kq dp"><span id="6782" class="cs kr jo ff ks b cp kt ku s kv">$ git clone <a href="https://github.com/quiltdata/open-images.git" class="bx io" target="_blank" rel="noopener nofollow">https://github.com/quiltdata/open-images.git</a><br/>$ cd open-images/<br/>$ conda env create -f environment.yml<br/>$ source activate quilt-open-images-dev<br/>$ cd src/openimager/<br/>$ python openimager.py &quot;Sandwiches&quot; &quot;Hamburgers&quot;</span></pre><p id="d353" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Categories are organized in a hierarchical way.</p><p id="27b6" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">For example, <code class="ie kw kx ky ks b">sandwich</code> and <code class="ie kw kx ky ks b">hamburger</code> are both sub-labels of <code class="ie kw kx ky ks b">food</code> (but <code class="ie kw kx ky ks b">hamburger</code> is not a sub-label of <code class="ie kw kx ky ks b">sandwich</code> — hmm).</p><p id="0a5d" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">We can visualize the ontology as a radial tree using Vega:</p><figure class="ho hp hq hr hs he ep eq paragraph-image"><div role="button" tabindex="0" class="hv hw cu hx aj hy"><div class="ep eq kz"><div class="id s cu ie"><div class="la ig s"><div class="cq hz t u v ia aj ck ib ic"><img alt="Image for post" class="t u v ia aj ih ii ij" src="https://miro.medium.com/max/60/1*Wp0-dUSPLuwC6KN7hELNLw.png?q=20" width="1484" height="1440"/></div><img alt="Image for post" class="cq hz t u v ia aj c" width="1484" height="1440"/><noscript><img alt="Image for post" class="t u v ia aj" src="https://miro.medium.com/max/2968/1*Wp0-dUSPLuwC6KN7hELNLw.png" width="1484" height="1440" srcSet="https://miro.medium.com/max/552/1*Wp0-dUSPLuwC6KN7hELNLw.png 276w, https://miro.medium.com/max/1104/1*Wp0-dUSPLuwC6KN7hELNLw.png 552w, https://miro.medium.com/max/1280/1*Wp0-dUSPLuwC6KN7hELNLw.png 640w, https://miro.medium.com/max/1400/1*Wp0-dUSPLuwC6KN7hELNLw.png 700w" sizes="700px"/></noscript></div></div></div></div></figure><p id="10bc" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">You can view an interactive annotated version of this chart (and download the code behind it) <a href="https://alpha.quiltdata.com/b/quilt-example/tree/quilt/open_images/" class="bx io" target="_blank" rel="noopener nofollow">here</a>.</p><p id="76d0" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Not all categories in Open Images have bounding box data associated with them.</p><p id="bc8f" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">But this script will allow you to download any subset of the 600 labels that do. Here’s a taste of what’s possible:</p><p id="656e" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs"><code class="ie kw kx ky ks b">football</code>, <code class="ie kw kx ky ks b">toy</code>, <code class="ie kw kx ky ks b">bird</code>, <code class="ie kw kx ky ks b">cat</code>, <code class="ie kw kx ky ks b">vase</code>, <code class="ie kw kx ky ks b">hair dryer</code>, <code class="ie kw kx ky ks b">kangaroo</code>, <code class="ie kw kx ky ks b">knife</code>, <code class="ie kw kx ky ks b">briefcase</code>, <code class="ie kw kx ky ks b">pencil case</code>, <code class="ie kw kx ky ks b">tennis ball</code>, <code class="ie kw kx ky ks b">nail</code>, <code class="ie kw kx ky ks b">high heels</code>, <code class="ie kw kx ky ks b">sushi</code>, <code class="ie kw kx ky ks b">skyscraper</code>, <code class="ie kw kx ky ks b">tree</code>, <code class="ie kw kx ky ks b">truck</code>, <code class="ie kw kx ky ks b">violin</code>, <code class="ie kw kx ky ks b">wine</code>, <code class="ie kw kx ky ks b">wheel</code>, <code class="ie kw kx ky ks b">whale</code>, <code class="ie kw kx ky ks b">pizza cutter</code>, <code class="ie kw kx ky ks b">bread</code>, <code class="ie kw kx ky ks b">helicopter</code>, <code class="ie kw kx ky ks b">lemon</code>, <code class="ie kw kx ky ks b">dog</code>, <code class="ie kw kx ky ks b">elephant</code>, <code class="ie kw kx ky ks b">shark</code>, <code class="ie kw kx ky ks b">flower</code>, <code class="ie kw kx ky ks b">furniture</code>, <code class="ie kw kx ky ks b">airplane</code>, <code class="ie kw kx ky ks b">spoon</code>, <code class="ie kw kx ky ks b">bench</code>, <code class="ie kw kx ky ks b">swan</code>, <code class="ie kw kx ky ks b">peanut</code>, <code class="ie kw kx ky ks b">camera</code>, <code class="ie kw kx ky ks b">flute</code>, <code class="ie kw kx ky ks b">helmet</code>, <code class="ie kw kx ky ks b">pomegranate</code>, <code class="ie kw kx ky ks b">crown</code>…</p><p id="c002" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">For the purposes of this article, we’ll limit ourselves to just two: <code class="ie kw kx ky ks b">hamburger</code> and <code class="ie kw kx ky ks b">sandwich</code>.</p><h1 id="6872" class="jn jo ff au jp jq jr iu js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki cs">Clean it, crop it</h1><p id="731f" class="ip iq ff ir b is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji kn jk jl jm ex cs">Once we’ve run the script and localized the images, we can inspect them with <code class="ie kw kx ky ks b">matplotlib</code> to see what we’ve got:</p><pre class="ho hp hq hr hs kp kq dp"><span id="8971" class="cs kr jo ff ks b cp kt ku s kv">import matplotlib.pyplot as plt<br/>from matplotlib.image import imread<br/>%matplotlib inline<br/>import os</span><span id="5492" class="cs kr jo ff ks b cp lb lc ld le lf ku s kv">fig, axarr = plt.subplots(1, 5, figsize=(24, 4))<br/>for i, img in enumerate(os.listdir(&#x27;../data/images/&#x27;)[:5]):<br/>    axarr[i].imshow(imread(&#x27;../data/images/&#x27; + img))</span></pre></div></div><div class="he"><div class="n p"><div class="hf hg hh hi hj hk af hl ag hm ai aj"><figure class="ho hp hq hr hs he ht hu paragraph-image"><div role="button" tabindex="0" class="hv hw cu hx aj hy"><div class="ep eq lg"><div class="id s cu ie"><div class="lh ig s"><div class="cq hz t u v ia aj ck ib ic"><img alt="Image for post" class="t u v ia aj ih ii ij" src="https://miro.medium.com/max/60/1*8ytDl01L-ZoUKYxYREMkuw.png?q=20" width="1392" height="252"/></div><img alt="Image for post" class="cq hz t u v ia aj c" width="1392" height="252"/><noscript><img alt="Image for post" class="t u v ia aj" src="https://miro.medium.com/max/2784/1*8ytDl01L-ZoUKYxYREMkuw.png" width="1392" height="252" srcSet="https://miro.medium.com/max/552/1*8ytDl01L-ZoUKYxYREMkuw.png 276w, https://miro.medium.com/max/1104/1*8ytDl01L-ZoUKYxYREMkuw.png 552w, https://miro.medium.com/max/1280/1*8ytDl01L-ZoUKYxYREMkuw.png 640w, https://miro.medium.com/max/1456/1*8ytDl01L-ZoUKYxYREMkuw.png 728w, https://miro.medium.com/max/1632/1*8ytDl01L-ZoUKYxYREMkuw.png 816w, https://miro.medium.com/max/1808/1*8ytDl01L-ZoUKYxYREMkuw.png 904w, https://miro.medium.com/max/1984/1*8ytDl01L-ZoUKYxYREMkuw.png 992w, https://miro.medium.com/max/2000/1*8ytDl01L-ZoUKYxYREMkuw.png 1000w" sizes="1000px"/></noscript></div></div></div></div><figcaption class="ik il er ep eq im in au b av aw ax">Five example {hamburger, sandwich} images from Google Open Images V4.</figcaption></figure></div></div></div><div class="n p"><div class="ab ac ae af ag fc ai aj"><p id="2279" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">These images are not easy ones to train on. They have all of the issues associated with building a dataset using an external source from the public Internet.</p><p id="ec48" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Just this small sample here demonstrates the different sizes, orientations, and occlusions possible in our target classes.</p><p id="1412" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">In one case, we didn’t even succeed in downloading the actual image. Instead, we got a placeholder telling us that the image we wanted has since been deleted!</p><p id="4b88" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Downloading this data nets us a few thousand sample images like these. The next step is to take advantage of the bounding box information to clip our images down to just the sandwich-y, hamburger-y parts.</p><p id="ad9d" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Here’s another image array, this time with bounding boxes included, to demonstrate what this entails:</p></div></div><div class="he"><div class="n p"><div class="hf hg hh hi hj hk af hl ag hm ai aj"><figure class="ho hp hq hr hs he ht hu paragraph-image"><div role="button" tabindex="0" class="hv hw cu hx aj hy"><div class="ep eq li"><div class="id s cu ie"><div class="lj ig s"><div class="cq hz t u v ia aj ck ib ic"><img alt="Image for post" class="t u v ia aj ih ii ij" src="https://miro.medium.com/max/60/1*ii670RcCgXExc2CQgc-QEg.png?q=20" width="1335" height="252"/></div><img alt="Image for post" class="cq hz t u v ia aj c" width="1335" height="252"/><noscript><img alt="Image for post" class="t u v ia aj" src="https://miro.medium.com/max/2670/1*ii670RcCgXExc2CQgc-QEg.png" width="1335" height="252" srcSet="https://miro.medium.com/max/552/1*ii670RcCgXExc2CQgc-QEg.png 276w, https://miro.medium.com/max/1104/1*ii670RcCgXExc2CQgc-QEg.png 552w, https://miro.medium.com/max/1280/1*ii670RcCgXExc2CQgc-QEg.png 640w, https://miro.medium.com/max/1456/1*ii670RcCgXExc2CQgc-QEg.png 728w, https://miro.medium.com/max/1632/1*ii670RcCgXExc2CQgc-QEg.png 816w, https://miro.medium.com/max/1808/1*ii670RcCgXExc2CQgc-QEg.png 904w, https://miro.medium.com/max/1984/1*ii670RcCgXExc2CQgc-QEg.png 992w, https://miro.medium.com/max/2000/1*ii670RcCgXExc2CQgc-QEg.png 1000w" sizes="1000px"/></noscript></div></div></div></div><figcaption class="ik il er ep eq im in au b av aw ax">Bounding boxes. Notice (1) the dataset includes “depictions” and (2) raw images can contain many object instances.</figcaption></figure></div></div></div><div class="n p"><div class="ab ac ae af ag fc ai aj"><p id="e1dd" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs"><a href="https://github.com/quiltdata/open-images/blob/master/notebooks/build-dataset.ipynb" class="bx io" target="_blank" rel="noopener nofollow">This annotated Jupyter notebook</a> in the <a href="https://github.com/quiltdata/open-images" class="bx io" target="_blank" rel="noopener nofollow">demo GitHub repository</a> does this work.</p><p id="66a8" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">I will omit showing that code here because it is slightly complicated. This is especially since we also need to (1) refactor our image metadata to match the clipped image outputs and (2) extract the images that have since been deleted. Definitely check out the notebook if you wish to see the code.</p><p id="5352" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">After running the notebook code, we will have an <code class="ie kw kx ky ks b">images_cropped</code> folder on disk containing all of the cropped images.</p><h1 id="55f9" class="jn jo ff au jp jq jr iu js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki cs">Building the model</h1><p id="e6bf" class="ip iq ff ir b is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji kn jk jl jm ex cs">Once we have downloaded the data, and cropped and cleaned it, we’re ready to train the model.</p><p id="fb05" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">We will train a <a href="https://medium.freecodecamp.org/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050" class="bx io" target="_blank" rel="noopener nofollow">convolutional neural network</a> (or ‘CNN’) on the data.</p><p id="d464" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">CNNs are a special type of neural network which build progressively higher level features out of groups of pixels commonly found in the images.</p><p id="0357" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">How an image scores on these various features is then weighted to generate a final classification result.</p><p id="cdcd" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">This architecture works extremely well because it takes advantage of locality. This is because any one pixel is likely to have far more in common with pixels nearby than those far away.</p><p id="923e" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">CNNs also have other attractive properties, like noise tolerance and scale invariance (to an extent). These further improve their classification properties.</p><p id="ac9d" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">If you’re unfamiliar with CNNs, I recommend skimming Brandon Rohrer’s excellent “<a href="https://brohrer.github.io/how_convolutional_neural_networks_work.html" class="bx io" target="_blank" rel="noopener nofollow">How convolutional neural networks work</a>” to learn more about them.</p><p id="51f9" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">We will train a very simple convolutional neural network and see how even that gets decent results on our problem. I use <a href="https://keras.io/" class="bx io" target="_blank" rel="noopener nofollow">Keras</a> to define and train the model.</p><p id="e635" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">We start by laying out the images in a certain directory structure:</p><pre class="ho hp hq hr hs kp kq dp"><span id="6c9a" class="cs kr jo ff ks b cp kt ku s kv">images_cropped/<br/>    sandwich/<br/>        some_image.jpg<br/>        some_other_image.jpg<br/>        ...<br/>    hamburger/<br/>        yet_another_image.jpg<br/>        ...</span></pre><p id="38be" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">We then point Keras at this folder using the following code:</p><figure class="ho hp hq hr hs he"><div class="id s cu"><div class="ko ig s"></div></div></figure><p id="a432" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Keras will inspect the input folders, and determine there are two classes in our classification problem. It will assign class names based on the subfolder names, and create “image generators” that serve out of those folders.</p><p id="a4a8" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">But we don’t just return the images themselves. Instead, we return randomly subsampled, skewed, and zoomed selections from the images (via <code class="ie kw kx ky ks b">train_datagen.flow_from_directory</code>).</p><p id="d7d4" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">This is an example of data augmentation<strong class="ir lk"> </strong>in action.</p><p id="3649" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Data augmentation is the practice of feeding an image classifier randomly cropped and distorted versions of an input dataset. This helps us overcome the small size of our dataset. We can train our model on a single image multiple times. Each time we use a slightly different segment of the image preprocessed in a slightly different way.</p><p id="e20f" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">With our data input defined, the next step is defining the model itself:</p><figure class="ho hp hq hr hs he"><div class="id s cu"><div class="ko ig s"></div></div></figure><p id="c1de" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">This is a simple convolutional neural network model. It contains just three convolutional layers: a single densely connected post-processing layer just before the output layer, and strong regularization in the form of a dropout layer and <code class="ie kw kx ky ks b">relu</code> activation.</p><p id="4265" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">These things all work together to make it more difficult for this model to <a href="https://machinelearningmastery.com/overfitting-and-underfitting-with-machine-learning-algorithms/" class="bx io" target="_blank" rel="noopener nofollow">overfit</a>. This is important, given the small size of our input dataset.</p><p id="fb14" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Finally, the last step is actually fitting the model.</p><figure class="ho hp hq hr hs he"><div class="id s cu"><div class="ko ig s"></div></div></figure><p id="acea" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">This code selects an epoch step size determined by our image sample size and chosen batch size (16). Then it trains on that data for 50 epochs.</p><p id="d0ba" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Training is likely to be suspended early by the <code class="ie kw kx ky ks b">EarlyStopping</code> callback. This returns the best performing model ahead of the 50 epoch limit if it does not see improvement in the validation score in the previous four epochs.</p><p id="b552" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">We selected such a large patience value because there is a significant amount of variability in model validation loss.</p><p id="14d1" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">This simple training regimen results in a model with about 75% accuracy:</p><pre class="ho hp hq hr hs kp kq dp"><span id="8dd2" class="cs kr jo ff ks b cp kt ku s kv">              precision    recall  f1-score   support<br/><br/>           0       0.90      0.59      0.71      1399<br/>           1       0.64      0.92      0.75      1109<br/><br/>   micro avg       0.73      0.73      0.73      2508<br/>   macro avg       0.77      0.75      0.73      2508<br/>weighted avg       0.78      0.73      0.73      2508</span></pre><p id="f25a" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">It’s interesting to note that our model is under-confident when classifying hamburgers (class 0), but over-confident when classifying hamburgers (class 1).</p><p id="9b5a" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">90% of images classified as hamburgers are actually hamburgers. But only 59% of all actual hamburgers are classified correctly.</p><p id="811f" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">On the other hand, just 64% of images classified as sandwiches are actually sandwiches. But 92% of sandwiches are classified correctly.</p><p id="468c" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">These results are in line with the 80% accuracy Francois Chollet got by applying a very similar model to a similarly-sized subset of the classic <a href="https://www.kaggle.com/c/dogs-vs-cats" class="bx io" target="_blank" rel="noopener nofollow">Cats versus Dogs</a> dataset.</p><p id="171b" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">The difference is probably mainly due to increased level of occlusion and noise in the Google Open Images V4 dataset.</p><p id="a50f" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">The dataset also includes illustrations as well as photographic images. These sometimes take large artistic liberties, making classification more difficult. You may choose to remove these when building a model yourself.</p><p id="d228" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">This performance can be further improved using <a href="https://towardsdatascience.com/keras-transfer-learning-for-beginners-6c9b8b7143e" class="bx io" target="_blank" rel="noopener">transfer learning</a> techniques. To learn more, check out Keras author Francois Chollet’s blog post “<a href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" class="bx io" target="_blank" rel="noopener nofollow">Building powerful image classification models using very little data</a>”.</p><h1 id="5eed" class="jn jo ff au jp jq jr iu js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki cs">Distributing the model</h1><p id="3c21" class="ip iq ff ir b is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji kn jk jl jm ex cs">Now that we’ve now built a custom dataset and trained a model, it’d be a shame if we didn’t share it.</p><p id="ae27" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Machine Learning projects should be reproducible. I outline the following strategy in a previous article, “<a href="https://blog.quiltdata.com/reproduce-a-machine-learning-model-build-in-four-lines-of-code-b4f0a5c5f8c8" class="bx io" target="_blank" rel="noopener nofollow">Reproduce a machine learning model build in four lines of code</a>”.</p><ul class=""><li id="1881" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ll lm ln cs">Separate dependencies into data, code, and environment components.</li><li id="08ad" class="ip iq ff ir b is lo iu iv iw lp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ll lm ln cs">Data dependencies version control (1) the model definition and (2) the training data. Save these to versioned blob storage, e.g. <a href="https://aws.amazon.com/s3/" class="bx io" target="_blank" rel="noopener nofollow">Amazon S3</a> with <a href="https://github.com/quiltdata/t4" class="bx io" target="_blank" rel="noopener nofollow">Quilt T4</a>.</li><li id="95f5" class="ip iq ff ir b is lo iu iv iw lp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ll lm ln cs">Code dependencies version controls the code used to train the model (use git).</li><li id="fec1" class="ip iq ff ir b is lo iu iv iw lp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ll lm ln cs">Environment dependencies version control the environment used to train the model. In a production environment this should probably be a Docker file, but you can use <code class="ie kw kx ky ks b">pip</code> or <code class="ie kw kx ky ks b">conda</code> locally.</li><li id="c333" class="ip iq ff ir b is lo iu iv iw lp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ll lm ln cs">To provide someone with a retrainable copy of the model, give them the corresponding <code class="ie kw kx ky ks b">{data, code, environment}</code> tuple.</li></ul><p id="51e1" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Following these principles makes getting everything you need to train your own copy of this model fit into a handful of lines of code:</p><pre class="ho hp hq hr hs kp kq dp"><span id="856c" class="cs kr jo ff ks b cp kt ku s kv">git clone <a href="https://github.com/quiltdata/open-images.git" class="bx io" target="_blank" rel="noopener nofollow">https://github.com/quiltdata/open-images.git</a><br/>conda env create -f open-images/environment.yml<br/>source activate quilt-open-images-dev<br/>python -c &quot;import t4; t4.Package.install(&#x27;quilt/open_images&#x27;, dest=&#x27;open-images/&#x27;, registry=&#x27;s3://quilt-example&#x27;)&quot;</span></pre><p id="97be" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">To learn more about <code class="ie kw kx ky ks b">{data, code, environment}</code> see <a href="https://github.com/quiltdata/open-images" class="bx io" target="_blank" rel="noopener nofollow">the GitHub repository</a> and/or <a href="https://blog.quiltdata.com/reproduce-a-machine-learning-model-build-in-four-lines-of-code-b4f0a5c5f8c8" class="bx io" target="_blank" rel="noopener nofollow">the corresponding article</a>.</p><h1 id="08a3" class="jn jo ff au jp jq jr iu js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki cs">Conclusion</h1><p id="9acf" class="ip iq ff ir b is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji kn jk jl jm ex cs">In this article we demonstrated an end-to-end image classification machine learning pipeline. We covered everything from downloading/transforming a dataset to training a model. We then distributed it in a way that lets anyone else rebuild it themselves later.</p><p id="c421" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Because custom datasets are difficult to generate and distribute, over time there has emerged a cabal of example datasets which get used everywhere. This is not because they’re actually that good (they’re not). Instead, it’s because they’re easy.</p><p id="e74b" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">For example, Google’s recently released Machine Learning Crash Course makes heavy use of the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.fetch_california_housing.html" class="bx io" target="_blank" rel="noopener nofollow">California Housing Dataset</a>. That data is now almost two decades old!</p><p id="0523" class="ip iq ff ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ex cs">Consider instead exploring new horizons. Using real images from the living Internet with interesting categorical breakdowns. It’s easier than you think!</p></div></div></section></div></article><div class="cq ew lu lt aj mb lz mc" data-test-id="post-sidebar"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="md n me"><div class="ew"><div><div class="mf mg s"><a href="/free-code-camp?source=post_sidebar--------------------------post_sidebar-----------" class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" rel="noopener"><h2 class="au jp cp aw fe cs ex">freeCodeCamp.org</h2></a><div class="mh mi s"><h4 class="au b av aw ck mj cj gm mk go gp ax">This is no longer updated.</h4></div><div class="bs" aria-hidden="false"><button class="au b av aw ml mm mn mo mp mq mr bh ms mt mu mv mw mx my es bs mz"><div class="n na">Follow</div></button></div></div><div class="nb nc nd n"><div class="n o"><div class="s cu ne nf ng nh ni"><div class=""><div><div class="bs" role="tooltip" aria-hidden="false"><div class="bf nj nk nl nm nn no np r nq nr ns"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM18.63 2.22l-1.43-.47-.4 3.03zM11.79 1.75l-1.43.47 1.84 2.56zM24.47 14.3L21.45 9c-.29-.43-.69-.7-1.12-.78a1.16 1.16 0 0 0-.91.22c-.3.23-.48.52-.54.84l.05.07 2.85 5c1.95 3.56 1.32 6.97-1.85 10.14a8.46 8.46 0 0 1-.55.5 5.75 5.75 0 0 0 3.36-1.76c3.26-3.27 3.04-6.75 1.73-8.91M14.58 10.89c-.16-.83.1-1.57.7-2.15l-2.5-2.49c-.5-.5-1.38-.5-1.88 0-.18.18-.27.4-.33.63l4.01 4z"></path><path d="M17.81 10.04a1.37 1.37 0 0 0-.88-.6.81.81 0 0 0-.64.15c-.18.13-.71.55-.24 1.56l1.43 3.03a.54.54 0 1 1-.87.61L9.2 7.38a.99.99 0 1 0-1.4 1.4l4.4 4.4a.54.54 0 1 1-.76.76l-4.4-4.4L5.8 8.3a.99.99 0 0 0-1.4 0 .98.98 0 0 0 0 1.39l1.25 1.24 4.4 4.4a.54.54 0 0 1 0 .76.54.54 0 0 1-.76 0l-4.4-4.4a1 1 0 0 0-1.4 0 .98.98 0 0 0 0 1.4l1.86 1.85 2.76 2.77a.54.54 0 0 1-.76.76L4.58 15.7a.98.98 0 0 0-1.4 0 .99.99 0 0 0 0 1.4l5.33 5.32c3.37 3.37 6.64 4.98 10.49 1.12 2.74-2.74 3.27-5.54 1.62-8.56l-2.8-4.94z"></path></g></svg></div></div></div></div></div><div class="s nt nu nv nw nx ny nz"><div class="oa"><h4 class="au b av aw ax"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc">833<!-- --> </button></h4></div></div></div></div><div class="nc s"><button class="oc nk bf"><div class="od n o na"><svg width="25" height="25" class="r" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg><div class="s cu oe of og oh oi oj ok ol"><h4 class="au b av aw ax">2<!-- --> </h4></div></div></button></div><div><div class="bq"><div><div class="bs" role="tooltip" aria-hidden="false"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" aria-label="Bookmark Post"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div><div class="cq ew lt lu lv lw lx ly lz ma"></div><div><div class="om he n me p"><div class="n p"><div class="ab ac ae af ag fc ai aj"><div class="n on"><div class="s"><h4 class="au b ea aw ax">Thanks to <!-- -->Aneesh Karve<!-- --> <!-- -->(<button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc">hide</button>)<!-- --> and <!-- -->Cecelia Shao<!-- --> <!-- -->(<button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc">hide</button>)<!-- -->. </h4></div></div><div class="n o on"></div><div class="oo s"><ul class="bf bg"><li class="bs dn hb op"><a href="https://medium.com/free-code-camp/tagged/machine-learning" class="au b ea oq ax or os mz s kq">Machine Learning</a></li><li class="bs dn hb op"><a href="https://medium.com/free-code-camp/tagged/data-science" class="au b ea oq ax or os mz s kq">Data Science</a></li><li class="bs dn hb op"><a href="https://medium.com/free-code-camp/tagged/computer-vision" class="au b ea oq ax or os mz s kq">Computer Vision</a></li><li class="bs dn hb op"><a href="https://medium.com/free-code-camp/tagged/programming" class="au b ea oq ax or os mz s kq">Programming</a></li><li class="bs dn hb op"><a href="https://medium.com/free-code-camp/tagged/technology" class="au b ea oq ax or os mz s kq">Technology</a></li></ul></div><div class="oo n gd z"><div class="n na"><div class="ot s"><span class="s ou ov ow e d"><div class="n o"><div class="s cu ne nf ng nh ni"><div class=""><div><div class="bs" role="tooltip" aria-hidden="false"><div class="bf nj nk nl nm nn no np r nq nr ns"><svg width="25" height="25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM16.63 1.22L15.2.75l-.4 3.03zM9.79.75l-1.43.47 1.84 2.56zM22.47 13.3L19.45 8c-.29-.43-.69-.7-1.12-.78a1.16 1.16 0 0 0-.91.22c-.3.23-.48.52-.54.84l.05.07 2.85 5c1.95 3.56 1.32 6.97-1.85 10.14a8.46 8.46 0 0 1-.55.5 5.75 5.75 0 0 0 3.36-1.76c3.26-3.27 3.04-6.75 1.73-8.91M12.58 9.89c-.16-.83.1-1.57.7-2.15l-2.5-2.49c-.5-.5-1.38-.5-1.88 0-.18.18-.27.4-.33.63l4.01 4z"></path><path d="M15.81 9.04a1.37 1.37 0 0 0-.88-.6.81.81 0 0 0-.64.15c-.18.13-.72.55-.24 1.56l1.43 3.03a.54.54 0 1 1-.87.61L7.2 6.38a.99.99 0 1 0-1.4 1.4l4.4 4.4a.54.54 0 1 1-.76.76l-4.4-4.4L3.8 7.3a.99.99 0 0 0-1.4 0 .98.98 0 0 0 0 1.39l1.25 1.24 4.4 4.4a.54.54 0 0 1 0 .76.54.54 0 0 1-.76 0l-4.4-4.4a1 1 0 0 0-1.4 0 .98.98 0 0 0 0 1.4l1.86 1.85 2.76 2.77a.54.54 0 0 1-.76.76L2.58 14.7a.98.98 0 0 0-1.4 0 .99.99 0 0 0 0 1.4l5.33 5.32c3.37 3.37 6.64 4.98 10.49 1.12 2.74-2.74 3.27-5.54 1.62-8.56l-2.8-4.94z"></path></g></svg></div></div></div></div></div><div class="s nt nu nv nw nx ny nz"><div class="cu ox oa"><h4 class="au b av aw cs"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc">833<span class="s h g f oy oz"> <!-- -->claps</span></button><span class="s h g f oy oz"></span></h4></div></div></div></span><span class="s h g f oy oz"><div class="n dq"><div class="s cu ne nf"><div class=""><div><div class="bs" role="tooltip" aria-hidden="false"><div class="bf nj nk nl nm nn no np r nq nr ns"><svg width="33" height="33" aria-label="clap"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.85-6.78c-.37-.54-.88-.9-1.44-.99a1.5 1.5 0 0 0-1.16.28c-.42.33-.65.74-.7 1.2v.01l3.63 6.37c2.46 4.5 1.67 8.8-2.33 12.8-.27.27-.54.5-.81.73a7.55 7.55 0 0 0 4.45-2.26c4.16-4.17 3.87-8.6 2.21-11.36zm-4.83.82l-3.58-6.3c-.3-.44-.73-.74-1.19-.81a1.1 1.1 0 0 0-.89.2c-.64.51-.75 1.2-.33 2.1l1.83 3.86a.6.6 0 0 1-.2.75.6.6 0 0 1-.77-.07l-9.44-9.44c-.51-.5-1.4-.5-1.9 0a1.33 1.33 0 0 0-.4.95c0 .36.14.7.4.95l5.6 5.61a.6.6 0 1 1-.84.85l-5.6-5.6-.01-.01-1.58-1.59a1.35 1.35 0 0 0-1.9 0 1.35 1.35 0 0 0 0 1.9l1.58 1.59 5.6 5.6a.6.6 0 0 1-.84.86L4.68 13.7c-.51-.51-1.4-.51-1.9 0a1.33 1.33 0 0 0-.4.95c0 .36.14.7.4.95l2.36 2.36 3.52 3.52a.6.6 0 0 1-.84.85l-3.53-3.52a1.34 1.34 0 0 0-.95-.4 1.34 1.34 0 0 0-.95 2.3l6.78 6.78c3.72 3.71 9.33 5.6 13.5 1.43 3.52-3.52 4.2-7.13 2.08-11.01zM11.82 7.72c.06-.32.21-.63.46-.89a1.74 1.74 0 0 1 2.4 0l3.23 3.24a2.87 2.87 0 0 0-.76 2.99l-5.33-5.33zM13.29.48l-1.92.88 2.37 2.84zM21.72 1.36L19.79.5l-.44 3.7zM16.5 3.3L15.48 0h2.04z"></path></g></svg></div></div></div></div></div><div class="s nt nu nv nw pa pb pc pd pe pf"><div class="cu ox oa"><h4 class="au b av aw cs"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc">833<span class="s h g f oy oz"> <!-- -->claps</span></button><span class="s h g f oy oz"></span></h4></div></div></div></span></div><div class="s pg ph pi pj pk"></div><button class="oc nk bf"><div class="od n o na"><span class="pl s h g f oy oz"><svg width="33" height="33" viewBox="0 0 33 33" fill="none" class="r" aria-label="responses"><path clip-rule="evenodd" d="M24.28 25.5l.32-.29c2.11-1.94 3.4-4.61 3.4-7.56C28 11.83 22.92 7 16.5 7S5 11.83 5 17.65s5.08 10.66 11.5 10.66c1.22 0 2.4-.18 3.5-.5l.5-.15.41.33a8.86 8.86 0 0 0 4.68 2.1 7.34 7.34 0 0 1-1.3-4.15v-.43zm1 .45c0 1.5.46 2.62 1.69 4.44.22.32.01.75-.38.75a9.69 9.69 0 0 1-6.31-2.37c-1.2.35-2.46.54-3.78.54C9.6 29.3 4 24.09 4 17.65 4 11.22 9.6 6 16.5 6S29 11.22 29 17.65c0 3.25-1.42 6.18-3.72 8.3z"></path></svg></span><span class="pm s ou ov ow e d"><svg width="25" height="25" class="r" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></span><div class="s cu pn of po oh pp oj pq pr ps pt"><h4 class="au b av aw cs">2<!-- --> <span class="s h g f oy oz">response<!-- -->s</span></h4></div></div></button></div><div class="n o"><div class="ha s bn"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" aria-label="Share on twitter"><svg width="29" height="29" class="bo"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="ha s bn"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" aria-label="Share on linkedin"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="bo"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="ha s bn"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" aria-label="Share on facebook"><svg width="29" height="29" class="bo"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="pu s bn"><div><div class="bq"><div><div class="bs" role="tooltip" aria-hidden="false"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" aria-label="Bookmark Post"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div><div class="bs" aria-hidden="false"><div class="bs" aria-hidden="false"><div class="s bn"><button class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" aria-label="More options"><svg class="r br hd" width="25" height="25"><path d="M5 12.5c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41A1.93 1.93 0 0 0 7 10.5c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41zm5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59.55 0 1.02-.2 1.41-.59.4-.39.59-.86.59-1.41 0-.55-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59-.39.39-.58.86-.58 1.41zm5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59.56 0 1.03-.2 1.42-.59.39-.39.58-.86.58-1.41 0-.55-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59-.39.39-.58.86-.58 1.41z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div><div><div class="n p"><div class="ab ac ae af ag fc ai aj"><div class="pv pw px oo s py z"><div class="s g"><div class="pz qa s cu"><span class="s qb am qc"><div class="s t qd qe"><a rel="noopener" href="/@aleksey.bilogur?source=follow_footer-------------------------------------"><img alt="Aleksey Bilogur" class="s dc dt qf" src="https://miro.medium.com/fit/c/160/160/1*P57nj94yF-yIPrWJ70GOLg.jpeg" width="80" height="80"/></a></div><span class="s"><div class="qg s qh"><p class="au b ea qi qj ax ec">Written by</p></div><div class="qg qk n qh"><div class="aj n o gd"><h2 class="au jp ql qm fe cs"><a class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" rel="noopener" href="/@aleksey.bilogur?source=follow_footer-------------------------------------">Aleksey Bilogur</a></h2><div class="s g"></div></div></div></span></span><div class="qg qn s qh at"><div class="qo s"><h4 class="au b cp qp ax">Building tools for doing data science. {📊, 💻, 🛠️}.</h4></div><div class="as qq at"></div></div></div><div class="pv s"></div><div class="pz qa s cu"><span class="s qb am qc"><div class="s t qd qe"><a href="/free-code-camp?source=follow_footer-------------------------------------" rel="noopener"><img alt="freeCodeCamp.org" class="mw qf dt" src="https://miro.medium.com/fit/c/160/160/1*MotlWcSa2n6FrOx3ul89kw.png" width="80" height="80"/></a></div><span class="s"><div class="qg qk n qh"><div class="aj n o gd"><h2 class="au jp ql qm fe cs"><a href="/free-code-camp?source=follow_footer-------------------------------------" class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" rel="noopener">freeCodeCamp.org</a></h2><div class="s g"><div class="bs" aria-hidden="false"><button class="au b av aw ml mm mn mo mp mq mr bh ms mt mu mv mw mx my es bs mz"><div class="n na">Follow</div></button></div></div></div></div></span></span><div class="qg qr s qh at"><div class="qo s"><h4 class="au b cp qp ax">This is no longer updated. Go to https://freecodecamp.org/news instead</h4></div><div class="as qq at"><div class="bs" aria-hidden="false"><button class="au b av aw ml mm mn mo mp mq mr bh ms mt mu mv mw mx my es bs mz"><div class="n na">Follow</div></button></div></div></div></div></div><div class="as at"><div class="qs s"><div class="n na"><div class="qt s"><a rel="noopener" href="/@aleksey.bilogur?source=follow_footer-------------------------------------"><img alt="Aleksey Bilogur" class="s dc qu qv" src="https://miro.medium.com/fit/c/80/80/1*P57nj94yF-yIPrWJ70GOLg.jpeg" width="40" height="40"/></a></div><div class="cd s"><p class="au b qw qx qy ax ec">Written by</p><div class="n na"><h2 class="au jp cp aw fe cs"><a class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" rel="noopener" href="/@aleksey.bilogur?source=follow_footer-------------------------------------">Aleksey Bilogur</a></h2><div class="cd s"></div></div><div class="qz s"><h4 class="au b av aw ax">Building tools for doing data science. {📊, 💻, 🛠️}.</h4></div></div></div><div class="qs s"><div class="n na"><a href="/free-code-camp?source=follow_footer-------------------------------------" rel="noopener"><img alt="freeCodeCamp.org" class="mw qv qu" src="https://miro.medium.com/fit/c/80/80/1*MotlWcSa2n6FrOx3ul89kw.png" width="40" height="40"/></a><div class="cd s"><div class="n na"><h2 class="au jp cp aw fe cs"><a href="/free-code-camp?source=follow_footer-------------------------------------" class="bx by ba bb bc bd be bf bg bh bz ca bk cb cc" rel="noopener">freeCodeCamp.org</a></h2><div class="cd s"><div class="bs" aria-hidden="false"><button class="au b ea aw ml ra mn mo mp mq mr bh ms mt mu mv mw mx my es bs mz"><div class="n na">Follow</div></button></div></div></div><div class="qz s"><h4 class="au b av aw ax">This is no longer updated. Go to https://freecodecamp.org/news instead</h4></div></div></div></div></div></div></div><div class="rb pw s py rc z"></div></div></div><div class="s rd z"><div class="n p"><div class="ab ac ae af ag ah ai aj"></div></div></div></div></div></div><div class="re s rf rg"><div class="n p"><div class="ab ac ae af ag ah ai aj"><div class="rh ri pz n gd g"><div class="rj n gd"><div class="rk s rl"><div class="rm s"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh rn ro bk rp rq" rel="noopener"><h2 class="au jp rr qp fe rs">Learn more.</h2></a></div><h4 class="au b av aw rt">Medium<!-- --> is an open platform where 170 million readers come to find insightful and dynamic thinking. Here, expert and undiscovered voices alike dive into the heart of any topic and bring new ideas to the surface.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh bk rp rq io" rel="noopener">Learn more</a></h4></div><div class="rk s rl"><div class="rm s"><a href="https://medium.com/topics?source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh rn ro bk rp rq" rel="noopener"><h2 class="au jp rr qp fe rs">Make <!-- -->Medium<!-- --> yours.</h2></a></div><h4 class="au b av aw rt">Follow the writers, publications, and topics that matter to you, and you’ll see them on your homepage and in your inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh bk rp rq io" rel="noopener">Explore</a></h4></div><div class="rk s rl"><div class="rm s"><a href="https://about.medium.com/creators/?source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh rn ro bk rp rq" rel="noopener"><h2 class="au jp rr qp fe rs">Share your thinking.</h2></a></div><h4 class="au b av aw rt">If you have a story to tell, knowledge to share, or a perspective to offer — welcome home. It’s easy and free to post your thinking on any topic.<!-- --> <a href="https://about.medium.com/creators/?source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh bk rp rq io" rel="noopener">Write on <!-- -->Medium</a></h4></div></div></div><div class="n me"><div class="n o gd"><a aria-label="Go to homepage" class="bx by ba bb bc bd be bf bg bh rn ro bk rp rq" rel="noopener" href="/?source=post_page-----65847da1a319--------------------------------"><svg viewBox="0 0 3940 610" class="mn ru"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><h4 class="au b av aw rt"><div class="qz rv n gd rw am"><h4 class="au b cp qp rs"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh gq bk rp rq" rel="noopener">About</a></h4><h4 class="au b cp qp rs"><a href="https://help.medium.com/hc/en-us?source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh gq bk rp rq" rel="noopener">Help</a></h4><h4 class="au b cp qp rs"><a href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh gq bk rp rq" rel="noopener">Legal</a></h4></div></h4></div><div class="as rx ry am"><h4 class="au b cp qp rt">Get the Medium app</h4></div><div class="as rx rz am sa"><div class="da s"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh rn ro bk rp rq" rel="noopener nofollow"><img alt="A button that says &#x27;Download on the App Store&#x27;, and if clicked it will lead you to the iOS App store" class="" src="https://miro.medium.com/max/270/1*Crl55Tm6yDNMoucPo1tvDg.png" width="135" height="41"/></a></div><div class="s"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----65847da1a319--------------------------------" class="bx by ba bb bc bd be bf bg bh rn ro bk rp rq" rel="noopener nofollow"><img alt="A button that says &#x27;Get it on, Google Play&#x27;, and if clicked it will lead you to the Google Play store" class="" src="https://miro.medium.com/max/270/1*W_RAPQ62h0em559zluJLdQ.png" width="135" height="41"/></a></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__ = "main-20210115-211454-7fb6ff250f"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"auroraPage":{"isAuroraPageEnabled":false},"config":{"nodeEnv":"production","version":"main-20210115-211454-7fb6ff250f","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20210115-211454-7fb6ff250f"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"main-20210115-211454-7fb6ff250f","commit":"7fb6ff250fe43fb6fe50c022cd3444d92855bbce"}},"datacenter":"us"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e","9dc80918cc93","8a9336e5bb4","cef6983b292","54c98c43354d","193b68bd4fba","b7e45b22fec3","55760f21cdc5"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*3sela1OADrJr7dJk_CXaEQ.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"performanceTags":[],"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","errorTracking":"none"},"debug":{"requestId":"cea2b074-b75a-436b-aa69-70f3672acbd3","branchDeployConfig":null,"originalSpanCarrier":{"ot-tracer-spanid":"696d278c7f0f284e","ot-tracer-traceid":"6a539289a654dde5","ot-tracer-sampled":"true"}},"session":{"user":{"id":"b6d2cfb88f3"},"xsrf":"e407bd5f82a3","isSpoofed":false},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Ffree-code-camp\u002Fhow-to-classify-photos-in-600-classes-using-nine-million-open-images-65847da1a319","host":"medium.com","hostname":"medium.com","referrer":"https:\u002F\u002Fmedium.com\u002Fme\u002Fstories\u002Fpublic","susiModal":{"step":null,"operation":"register"},"postRead":false},"client":{"isBot":false,"isEu":false,"isUs":true,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"inAppBrowserName":"","routingEntity":{"type":"DEFAULT","explicit":false},"supportsWebp":false,"useNeedForSpeed":false},"multiVote":{"clapsPerPost":{}},"tracing":{}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","variantFlags":[{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"android_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"assign_default_topic_to_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"bane_add_user","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"bane_verify_domain","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"branch_seo_metadata","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"covid_19_cdc_banner","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"default_seo_post_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_android_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_resume_reading_toast","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_mobile_featured_chunk","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_post_recommended_from_friends_provider","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_local_currency","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_annual_renewal_reminder_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_parse_expires_at","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook_renewal_failure","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_about_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_general_admission","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profile_follow_pages","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profile_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_sticky_nav","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_tag_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_autotier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automated_mission_control_triggers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_text_me_the_app","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding_fonts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cleansweep_double_writes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_client_error_tracking","valueType":{"__typename":"VariantFlagString","value":"none"}},{"__typename":"VariantFlag","name":"enable_confirm_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cta_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_curation_priority_queue_experiment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_daily_read_digest_promo","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_dedicated_series_tab_api_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_feature_logging","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_tagline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_earn_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_edit_alt_text","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_email_sign_in_captcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_email_to_subscribers_after_publish","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_embedding_based_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_end_of_post_cleanup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_evhead_com_to_ev_medium_com_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_expanded_feature_chunk_pool","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_by_resend_rules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_expire_processor","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_from_authors_you_may_enjoy","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_fyf_authors_and_collections","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_global_susi_modal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_highlander_member_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_homepage_write_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_increased_digest_timeout","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_post_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_json_logs_trained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex_app_highlights","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex_daily_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_lo_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_notifications","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pay_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post_cd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post_highlights","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post_highlights_view_only","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_profile","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_homepage_for_selected_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_stories","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_unread_notification_count_mutation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_login_code_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_media_resource_try_catch","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_membership_remove_section_a","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_miro_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mission_control","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mute","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_checkout_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_collaborative_filtering_data","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_three_dot_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_no_name_follower_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_parsely","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_patronus_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_popularity_feature","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_page_nav_stickiness_removal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_settings_screen","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_primary_topic_for_mobile","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_design_reminder","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_page_seo_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_all","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_edit_and_delete","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_moderation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rtr_channel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_s3_sites","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_save_to_medium","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_signup_friction","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sohne","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace_ranker_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ticks_digest_promo","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipalti_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_topic_lifecycle_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trending_posts_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_triton_predictions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trumpland_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_unbound","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound"}},{"__typename":"VariantFlag","name":"google_sign_in_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_generic_home_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_iceland_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_pub_follow_email_opt_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"is_not_medium_subscriber","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_fastrak","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_stripe_express","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"make_nav_sticky","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"new_transition_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"provider_for_credit_card_form","valueType":{"__typename":"VariantFlagString","value":"BRAINTREE"}},{"__typename":"VariantFlag","name":"pub_sidebar","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefine_average_post_reading_time","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_post_post_similarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"retrained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"sign_up_with_email_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"skip_sign_in_recaptcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"suppress_apple_missing_expires_date_alert","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"use_new_admin_topic_backend","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"viewer":{"__ref":"User:b6d2cfb88f3"},"meterPost({\"postId\":\"65847da1a319\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Fme\u002Fstories\u002Fpublic\"}})":{"__ref":"MeteringInfo:{}"},"postResult({\"id\":\"65847da1a319\"})":{"__ref":"Post:65847da1a319"}},"User:b6d2cfb88f3":{"id":"b6d2cfb88f3","__typename":"User","username":"aleksey.bilogur","name":"Aleksey Bilogur","imageId":"1*P57nj94yF-yIPrWJ70GOLg.jpeg","mediumMemberAt":0,"hasPastMemberships":false,"isPartnerProgramEnrolled":false,"email":"aleksey.bilogur@gmail.com","unverifiedEmail":"","createdAt":1485660812058,"isAuroraVisible":true,"isEligibleToViewNewResponses":true,"isMembershipTrialEligible":true,"isSuspended":true,"styleEditorOnboardingVersionSeen":0,"allowEmailAddressSharingEditorWriter":false,"hasDomain":false,"dismissableFlags":["FOLLOWERS_TOOLTIP"],"hasCompletedProfile":false,"bio":"Building tools for doing data science. {📊, 💻, 🛠️}.","customStyleSheet":null,"socialStats":{"__typename":"SocialStats","followerCount":421},"isBlocking":false,"isMuting":false,"isFollowing":false,"allowNotes":true,"newsletterV3":null,"viewerIsUser":true,"twitterScreenName":""},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":[],"maxUnlockCount":3,"unlocksRemaining":3},"ImageMetadata:":{"id":"","__typename":"ImageMetadata"},"ImageMetadata:1*wViBNJ1o9rM5p6b-gf3vxg.png":{"id":"1*wViBNJ1o9rM5p6b-gf3vxg.png","__typename":"ImageMetadata","originalWidth":600,"originalHeight":72},"User:8b318225c16a":{"id":"8b318225c16a","__typename":"User"},"ImageMetadata:1*MotlWcSa2n6FrOx3ul89kw.png":{"id":"1*MotlWcSa2n6FrOx3ul89kw.png","__typename":"ImageMetadata"},"Collection:336d898217ee":{"id":"336d898217ee","__typename":"Collection","domain":null,"googleAnalyticsId":"UA-55446531-3","slug":"free-code-camp","colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","isAuroraVisible":false,"favicon":{"__ref":"ImageMetadata:"},"name":"freeCodeCamp.org","colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFE3FBD9","point":0},{"__typename":"ColorPoint","color":"#FFDEFAD3","point":0.1},{"__typename":"ColorPoint","color":"#FFD9FACC","point":0.2},{"__typename":"ColorPoint","color":"#FFD3F9C6","point":0.3},{"__typename":"ColorPoint","color":"#FFCEF9C0","point":0.4},{"__typename":"ColorPoint","color":"#FFC9F8B9","point":0.5},{"__typename":"ColorPoint","color":"#FFC3F8B3","point":0.6},{"__typename":"ColorPoint","color":"#FFBDF7AD","point":0.7},{"__typename":"ColorPoint","color":"#FFB8F7A6","point":0.8},{"__typename":"ColorPoint","color":"#FFB2F6A0","point":0.9},{"__typename":"ColorPoint","color":"#FFACF699","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF429A35","point":0},{"__typename":"ColorPoint","color":"#FF408F33","point":0.1},{"__typename":"ColorPoint","color":"#FF3E8432","point":0.2},{"__typename":"ColorPoint","color":"#FF3B7830","point":0.3},{"__typename":"ColorPoint","color":"#FF376C2D","point":0.4},{"__typename":"ColorPoint","color":"#FF33602A","point":0.5},{"__typename":"ColorPoint","color":"#FF2E5426","point":0.6},{"__typename":"ColorPoint","color":"#FF284721","point":0.7},{"__typename":"ColorPoint","color":"#FF223A1C","point":0.8},{"__typename":"ColorPoint","color":"#FF1A2C15","point":0.9},{"__typename":"ColorPoint","color":"#FF111E0D","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF006400","colorPoints":[{"__typename":"ColorPoint","color":"#FF006400","point":0},{"__typename":"ColorPoint","color":"#FF2A7920","point":0.1},{"__typename":"ColorPoint","color":"#FF458C39","point":0.2},{"__typename":"ColorPoint","color":"#FF5D9E50","point":0.3},{"__typename":"ColorPoint","color":"#FF74AF66","point":0.4},{"__typename":"ColorPoint","color":"#FF8ABF7C","point":0.5},{"__typename":"ColorPoint","color":"#FFA0CE92","point":0.6},{"__typename":"ColorPoint","color":"#FFB5DDA8","point":0.7},{"__typename":"ColorPoint","color":"#FFCAEBBE","point":0.8},{"__typename":"ColorPoint","color":"#FFDFF8D4","point":0.9},{"__typename":"ColorPoint","color":"#FFF3FFEA","point":1}]}},"customStyleSheet":null,"tagline":"This is no longer updated.","isAuroraEligible":false,"viewerIsEditor":false,"logo":{"__ref":"ImageMetadata:1*wViBNJ1o9rM5p6b-gf3vxg.png"},"navItems":[{"__typename":"NavItem","title":"Archive","url":"https:\u002F\u002Fmedium.com\u002Ffree-code-camp\u002Farchive","type":"ARCHIVE_NAV_ITEM"},{"__typename":"NavItem","title":"Check out our new site: freeCodeCamp News","url":"https:\u002F\u002Fwww.freecodecamp.org\u002Fnews","type":"EXTERNAL_LINK_NAV_ITEM"}],"creator":{"__ref":"User:8b318225c16a"},"subscriberCount":617868,"avatar":{"__ref":"ImageMetadata:1*MotlWcSa2n6FrOx3ul89kw.png"},"isEnrolledInHightower":false,"newsletterV3":null,"viewerIsFollowing":false,"viewerIsSubscribedToLetters":false,"canToggleEmail":false,"isUserSubscribedToCollectionEmails":false,"viewerIsMuting":false,"viewerCanEditOwnPosts":true,"viewerCanEditPosts":false,"description":"This is no longer updated. Go to https:\u002F\u002Ffreecodecamp.org\u002Fnews instead","ampEnabled":false,"twitterUsername":"freecodecamp","facebookPageId":null},"Paragraph:8ac9e3176731_0":{"id":"8ac9e3176731_0","__typename":"Paragraph","name":"6987","text":"How to classify photos in 600 classes using nine million Open Images","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_1":{"id":"8ac9e3176731_1","__typename":"Paragraph","name":"e9cf","text":"Sandwiches, visualized using the Google Open Images Explorer","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*EI4YPmaav7hc79e0GH__BQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":33,"end":60,"type":"A","href":"https:\u002F\u002Fstorage.googleapis.com\u002Fopenimages\u002Fweb\u002Fvisualizer\u002Findex.html?set=train&c=%2Fm%2F0l515","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_2":{"id":"8ac9e3176731_2","__typename":"Paragraph","name":"3a5e","text":"If you’re looking build an image classifier but need training data, look no further than Google Open Images.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":89,"end":107,"type":"A","href":"https:\u002F\u002Fstorage.googleapis.com\u002Fopenimages\u002Fweb\u002Findex.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_3":{"id":"8ac9e3176731_3","__typename":"Paragraph","name":"5b5d","text":"This massive image dataset contains over 30 million images and 15 million bounding boxes. That’s 18 terabytes of image data!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_4":{"id":"8ac9e3176731_4","__typename":"Paragraph","name":"4100","text":"Plus, Open Images is much more open and accessible than certain other image datasets at this scale. For example, ImageNet has restrictive licensing.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_5":{"id":"8ac9e3176731_5","__typename":"Paragraph","name":"3394","text":"However, it’s not easy for developers on single machines to sift through that much data.You need to download and process multiple metadata files, and roll their own storage space (or apply for access to a Google Cloud bucket).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_6":{"id":"8ac9e3176731_6","__typename":"Paragraph","name":"1bc4","text":"On the other hand, there aren’t many custom image training sets in the wild, because frankly they’re a pain to create and share.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_7":{"id":"8ac9e3176731_7","__typename":"Paragraph","name":"976b","text":"In this article, we’ll build and distribute a simple end-to-end machine learning pipeline using Open Images.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_8":{"id":"8ac9e3176731_8","__typename":"Paragraph","name":"7d87","text":"We’ll see how to create your own dataset around any of the 600 labels included in the Open Images bounding box data.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_9":{"id":"8ac9e3176731_9","__typename":"Paragraph","name":"6350","text":"We’ll show off our handiwork by building “open sandwiches”. These are simple, reproducible image classifiers built to answer an age-old question: is a hamburger a sandwich?","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":146,"end":171,"type":"A","href":"https:\u002F\u002Fenglish.stackexchange.com\u002Fquestions\u002F246580\u002Fis-a-hamburger-considered-a-sandwich","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_10":{"id":"8ac9e3176731_10","__typename":"Paragraph","name":"52e2","text":"Want to see the code? You can follow along in the repository on GitHub.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":46,"end":70,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fopen-images","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_11":{"id":"8ac9e3176731_11","__typename":"Paragraph","name":"a307","text":"Downloading the data","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_12":{"id":"8ac9e3176731_12","__typename":"Paragraph","name":"7c0d","text":"We need to download the relevant data before we can do anything with it.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_13":{"id":"8ac9e3176731_13","__typename":"Paragraph","name":"e6d4","text":"This is the core challenge when working with Google Open Images (or any external dataset really). There is no easy way to download a subset of the data. We need to write a script that does so for us.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_14":{"id":"8ac9e3176731_14","__typename":"Paragraph","name":"3ee6","text":"I’ve written a Python script that searches the metadata in the Open Images data set for keywords that you specify. It finds the original URLs of the corresponding images (on Flickr), then downloads them to disk.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":63,"end":83,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fopenimages\u002Fdataset","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":174,"end":180,"type":"A","href":"https:\u002F\u002Fwww.flickr.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_15":{"id":"8ac9e3176731_15","__typename":"Paragraph","name":"521b","text":"It’s a testament to the power of Python that you can do all of this in just 50 lines of code:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_16":{"id":"8ac9e3176731_16","__typename":"Paragraph","name":"1c67","text":"For comments on the code and instructions for using it yourself see the GitHub repository.","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:be4a182e90d24b46368b8b9dd6964833"}},"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":68,"end":89,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fopen-images","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_17":{"id":"8ac9e3176731_17","__typename":"Paragraph","name":"5495","text":"This script enables you to download the subset of raw images which have bounding box information for any subset of categories of our choice:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_18":{"id":"8ac9e3176731_18","__typename":"Paragraph","name":"6782","text":"$ git clone https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fopen-images.git\n$ cd open-images\u002F\n$ conda env create -f environment.yml\n$ source activate quilt-open-images-dev\n$ cd src\u002Fopenimager\u002F\n$ python openimager.py \"Sandwiches\" \"Hamburgers\"","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":12,"end":56,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fopen-images.git","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_19":{"id":"8ac9e3176731_19","__typename":"Paragraph","name":"d353","text":"Categories are organized in a hierarchical way.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_20":{"id":"8ac9e3176731_20","__typename":"Paragraph","name":"27b6","text":"For example, sandwich and hamburger are both sub-labels of food (but hamburger is not a sub-label of sandwich — hmm).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":13,"end":21,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":26,"end":35,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":59,"end":63,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":69,"end":78,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":101,"end":109,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_21":{"id":"8ac9e3176731_21","__typename":"Paragraph","name":"0a5d","text":"We can visualize the ontology as a radial tree using Vega:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_22":{"id":"8ac9e3176731_22","__typename":"Paragraph","name":"d0b5","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Wp0-dUSPLuwC6KN7hELNLw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_23":{"id":"8ac9e3176731_23","__typename":"Paragraph","name":"10bc","text":"You can view an interactive annotated version of this chart (and download the code behind it) here.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":94,"end":98,"type":"A","href":"https:\u002F\u002Falpha.quiltdata.com\u002Fb\u002Fquilt-example\u002Ftree\u002Fquilt\u002Fopen_images\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_24":{"id":"8ac9e3176731_24","__typename":"Paragraph","name":"76d0","text":"Not all categories in Open Images have bounding box data associated with them.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_25":{"id":"8ac9e3176731_25","__typename":"Paragraph","name":"bc8f","text":"But this script will allow you to download any subset of the 600 labels that do. Here’s a taste of what’s possible:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_26":{"id":"8ac9e3176731_26","__typename":"Paragraph","name":"656e","text":"football, toy, bird, cat, vase, hair dryer, kangaroo, knife, briefcase, pencil case, tennis ball, nail, high heels, sushi, skyscraper, tree, truck, violin, wine, wheel, whale, pizza cutter, bread, helicopter, lemon, dog, elephant, shark, flower, furniture, airplane, spoon, bench, swan, peanut, camera, flute, helmet, pomegranate, crown…","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":8,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":10,"end":13,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":15,"end":19,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":21,"end":24,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":26,"end":30,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":32,"end":42,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":44,"end":52,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":54,"end":59,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":61,"end":70,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":72,"end":83,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":85,"end":96,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":98,"end":102,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":104,"end":114,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":116,"end":121,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":123,"end":133,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":135,"end":139,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":141,"end":146,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":148,"end":154,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":156,"end":160,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":162,"end":167,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":169,"end":174,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":176,"end":188,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":190,"end":195,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":197,"end":207,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":209,"end":214,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":216,"end":219,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":221,"end":229,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":231,"end":236,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":238,"end":244,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":246,"end":255,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":257,"end":265,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":267,"end":272,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":274,"end":279,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":281,"end":285,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":287,"end":293,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":295,"end":301,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":303,"end":308,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":310,"end":316,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":318,"end":329,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":331,"end":336,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_27":{"id":"8ac9e3176731_27","__typename":"Paragraph","name":"c002","text":"For the purposes of this article, we’ll limit ourselves to just two: hamburger and sandwich.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":69,"end":78,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":83,"end":91,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_28":{"id":"8ac9e3176731_28","__typename":"Paragraph","name":"6872","text":"Clean it, crop it","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_29":{"id":"8ac9e3176731_29","__typename":"Paragraph","name":"731f","text":"Once we’ve run the script and localized the images, we can inspect them with matplotlib to see what we’ve got:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":77,"end":87,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_30":{"id":"8ac9e3176731_30","__typename":"Paragraph","name":"8971","text":"import matplotlib.pyplot as plt\nfrom matplotlib.image import imread\n%matplotlib inline\nimport os","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_31":{"id":"8ac9e3176731_31","__typename":"Paragraph","name":"5492","text":"fig, axarr = plt.subplots(1, 5, figsize=(24, 4))\nfor i, img in enumerate(os.listdir('..\u002Fdata\u002Fimages\u002F')[:5]):\n    axarr[i].imshow(imread('..\u002Fdata\u002Fimages\u002F' + img))","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_32":{"id":"8ac9e3176731_32","__typename":"Paragraph","name":"f024","text":"Five example {hamburger, sandwich} images from Google Open Images V4.","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8ytDl01L-ZoUKYxYREMkuw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_33":{"id":"8ac9e3176731_33","__typename":"Paragraph","name":"2279","text":"These images are not easy ones to train on. They have all of the issues associated with building a dataset using an external source from the public Internet.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_34":{"id":"8ac9e3176731_34","__typename":"Paragraph","name":"ec48","text":"Just this small sample here demonstrates the different sizes, orientations, and occlusions possible in our target classes.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_35":{"id":"8ac9e3176731_35","__typename":"Paragraph","name":"1412","text":"In one case, we didn’t even succeed in downloading the actual image. Instead, we got a placeholder telling us that the image we wanted has since been deleted!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_36":{"id":"8ac9e3176731_36","__typename":"Paragraph","name":"4b88","text":"Downloading this data nets us a few thousand sample images like these. The next step is to take advantage of the bounding box information to clip our images down to just the sandwich-y, hamburger-y parts.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_37":{"id":"8ac9e3176731_37","__typename":"Paragraph","name":"ad9d","text":"Here’s another image array, this time with bounding boxes included, to demonstrate what this entails:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_38":{"id":"8ac9e3176731_38","__typename":"Paragraph","name":"3a37","text":"Bounding boxes. Notice (1) the dataset includes “depictions” and (2) raw images can contain many object instances.","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ii670RcCgXExc2CQgc-QEg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_39":{"id":"8ac9e3176731_39","__typename":"Paragraph","name":"e1dd","text":"This annotated Jupyter notebook in the demo GitHub repository does this work.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":31,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fopen-images\u002Fblob\u002Fmaster\u002Fnotebooks\u002Fbuild-dataset.ipynb","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":39,"end":61,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fopen-images","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_40":{"id":"8ac9e3176731_40","__typename":"Paragraph","name":"66a8","text":"I will omit showing that code here because it is slightly complicated. This is especially since we also need to (1) refactor our image metadata to match the clipped image outputs and (2) extract the images that have since been deleted. Definitely check out the notebook if you wish to see the code.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_41":{"id":"8ac9e3176731_41","__typename":"Paragraph","name":"5352","text":"After running the notebook code, we will have an images_cropped folder on disk containing all of the cropped images.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":49,"end":63,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_42":{"id":"8ac9e3176731_42","__typename":"Paragraph","name":"55f9","text":"Building the model","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_43":{"id":"8ac9e3176731_43","__typename":"Paragraph","name":"e6bf","text":"Once we have downloaded the data, and cropped and cleaned it, we’re ready to train the model.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_44":{"id":"8ac9e3176731_44","__typename":"Paragraph","name":"fb05","text":"We will train a convolutional neural network (or ‘CNN’) on the data.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":16,"end":44,"type":"A","href":"https:\u002F\u002Fmedium.freecodecamp.org\u002Fan-intuitive-guide-to-convolutional-neural-networks-260c2de0a050","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_45":{"id":"8ac9e3176731_45","__typename":"Paragraph","name":"d464","text":"CNNs are a special type of neural network which build progressively higher level features out of groups of pixels commonly found in the images.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_46":{"id":"8ac9e3176731_46","__typename":"Paragraph","name":"0357","text":"How an image scores on these various features is then weighted to generate a final classification result.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_47":{"id":"8ac9e3176731_47","__typename":"Paragraph","name":"cdcd","text":"This architecture works extremely well because it takes advantage of locality. This is because any one pixel is likely to have far more in common with pixels nearby than those far away.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_48":{"id":"8ac9e3176731_48","__typename":"Paragraph","name":"923e","text":"CNNs also have other attractive properties, like noise tolerance and scale invariance (to an extent). These further improve their classification properties.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_49":{"id":"8ac9e3176731_49","__typename":"Paragraph","name":"ac9d","text":"If you’re unfamiliar with CNNs, I recommend skimming Brandon Rohrer’s excellent “How convolutional neural networks work” to learn more about them.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":81,"end":119,"type":"A","href":"https:\u002F\u002Fbrohrer.github.io\u002Fhow_convolutional_neural_networks_work.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_50":{"id":"8ac9e3176731_50","__typename":"Paragraph","name":"51f9","text":"We will train a very simple convolutional neural network and see how even that gets decent results on our problem. I use Keras to define and train the model.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":121,"end":126,"type":"A","href":"https:\u002F\u002Fkeras.io\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_51":{"id":"8ac9e3176731_51","__typename":"Paragraph","name":"e635","text":"We start by laying out the images in a certain directory structure:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_52":{"id":"8ac9e3176731_52","__typename":"Paragraph","name":"6c9a","text":"images_cropped\u002F\n    sandwich\u002F\n        some_image.jpg\n        some_other_image.jpg\n        ...\n    hamburger\u002F\n        yet_another_image.jpg\n        ...","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_53":{"id":"8ac9e3176731_53","__typename":"Paragraph","name":"38be","text":"We then point Keras at this folder using the following code:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_54":{"id":"8ac9e3176731_54","__typename":"Paragraph","name":"d388","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:e1767a7acc4819c35f73598cd7183088"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_55":{"id":"8ac9e3176731_55","__typename":"Paragraph","name":"a432","text":"Keras will inspect the input folders, and determine there are two classes in our classification problem. It will assign class names based on the subfolder names, and create “image generators” that serve out of those folders.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_56":{"id":"8ac9e3176731_56","__typename":"Paragraph","name":"a4a8","text":"But we don’t just return the images themselves. Instead, we return randomly subsampled, skewed, and zoomed selections from the images (via train_datagen.flow_from_directory).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":139,"end":172,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_57":{"id":"8ac9e3176731_57","__typename":"Paragraph","name":"d7d4","text":"This is an example of data augmentation in action.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":39,"end":40,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_58":{"id":"8ac9e3176731_58","__typename":"Paragraph","name":"3649","text":"Data augmentation is the practice of feeding an image classifier randomly cropped and distorted versions of an input dataset. This helps us overcome the small size of our dataset. We can train our model on a single image multiple times. Each time we use a slightly different segment of the image preprocessed in a slightly different way.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_59":{"id":"8ac9e3176731_59","__typename":"Paragraph","name":"e20f","text":"With our data input defined, the next step is defining the model itself:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_60":{"id":"8ac9e3176731_60","__typename":"Paragraph","name":"c68d","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:160672b01e7ab2186adb288bbe311887"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_61":{"id":"8ac9e3176731_61","__typename":"Paragraph","name":"c1de","text":"This is a simple convolutional neural network model. It contains just three convolutional layers: a single densely connected post-processing layer just before the output layer, and strong regularization in the form of a dropout layer and relu activation.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":238,"end":242,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_62":{"id":"8ac9e3176731_62","__typename":"Paragraph","name":"4265","text":"These things all work together to make it more difficult for this model to overfit. This is important, given the small size of our input dataset.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":75,"end":82,"type":"A","href":"https:\u002F\u002Fmachinelearningmastery.com\u002Foverfitting-and-underfitting-with-machine-learning-algorithms\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_63":{"id":"8ac9e3176731_63","__typename":"Paragraph","name":"fb14","text":"Finally, the last step is actually fitting the model.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_64":{"id":"8ac9e3176731_64","__typename":"Paragraph","name":"e704","text":"","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"hasDropCap":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:e2951097f73f72338cca7f495344af0b"}},"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_65":{"id":"8ac9e3176731_65","__typename":"Paragraph","name":"acea","text":"This code selects an epoch step size determined by our image sample size and chosen batch size (16). Then it trains on that data for 50 epochs.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_66":{"id":"8ac9e3176731_66","__typename":"Paragraph","name":"d0ba","text":"Training is likely to be suspended early by the EarlyStopping callback. This returns the best performing model ahead of the 50 epoch limit if it does not see improvement in the validation score in the previous four epochs.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":48,"end":61,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_67":{"id":"8ac9e3176731_67","__typename":"Paragraph","name":"b552","text":"We selected such a large patience value because there is a significant amount of variability in model validation loss.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_68":{"id":"8ac9e3176731_68","__typename":"Paragraph","name":"14d1","text":"This simple training regimen results in a model with about 75% accuracy:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_69":{"id":"8ac9e3176731_69","__typename":"Paragraph","name":"8dd2","text":"              precision    recall  f1-score   support\n\n           0       0.90      0.59      0.71      1399\n           1       0.64      0.92      0.75      1109\n\n   micro avg       0.73      0.73      0.73      2508\n   macro avg       0.77      0.75      0.73      2508\nweighted avg       0.78      0.73      0.73      2508","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_70":{"id":"8ac9e3176731_70","__typename":"Paragraph","name":"f25a","text":"It’s interesting to note that our model is under-confident when classifying hamburgers (class 0), but over-confident when classifying hamburgers (class 1).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_71":{"id":"8ac9e3176731_71","__typename":"Paragraph","name":"9b5a","text":"90% of images classified as hamburgers are actually hamburgers. But only 59% of all actual hamburgers are classified correctly.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_72":{"id":"8ac9e3176731_72","__typename":"Paragraph","name":"811f","text":"On the other hand, just 64% of images classified as sandwiches are actually sandwiches. But 92% of sandwiches are classified correctly.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_73":{"id":"8ac9e3176731_73","__typename":"Paragraph","name":"468c","text":"These results are in line with the 80% accuracy Francois Chollet got by applying a very similar model to a similarly-sized subset of the classic Cats versus Dogs dataset.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":145,"end":161,"type":"A","href":"https:\u002F\u002Fwww.kaggle.com\u002Fc\u002Fdogs-vs-cats","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_74":{"id":"8ac9e3176731_74","__typename":"Paragraph","name":"171b","text":"The difference is probably mainly due to increased level of occlusion and noise in the Google Open Images V4 dataset.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_75":{"id":"8ac9e3176731_75","__typename":"Paragraph","name":"a50f","text":"The dataset also includes illustrations as well as photographic images. These sometimes take large artistic liberties, making classification more difficult. You may choose to remove these when building a model yourself.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_76":{"id":"8ac9e3176731_76","__typename":"Paragraph","name":"d228","text":"This performance can be further improved using transfer learning techniques. To learn more, check out Keras author Francois Chollet’s blog post “Building powerful image classification models using very little data”.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":47,"end":64,"type":"A","href":"https:\u002F\u002Ftowardsdatascience.com\u002Fkeras-transfer-learning-for-beginners-6c9b8b7143e","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":145,"end":213,"type":"A","href":"https:\u002F\u002Fblog.keras.io\u002Fbuilding-powerful-image-classification-models-using-very-little-data.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_77":{"id":"8ac9e3176731_77","__typename":"Paragraph","name":"5eed","text":"Distributing the model","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_78":{"id":"8ac9e3176731_78","__typename":"Paragraph","name":"3c21","text":"Now that we’ve now built a custom dataset and trained a model, it’d be a shame if we didn’t share it.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_79":{"id":"8ac9e3176731_79","__typename":"Paragraph","name":"ae27","text":"Machine Learning projects should be reproducible. I outline the following strategy in a previous article, “Reproduce a machine learning model build in four lines of code”.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":107,"end":169,"type":"A","href":"https:\u002F\u002Fblog.quiltdata.com\u002Freproduce-a-machine-learning-model-build-in-four-lines-of-code-b4f0a5c5f8c8","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_80":{"id":"8ac9e3176731_80","__typename":"Paragraph","name":"1881","text":"Separate dependencies into data, code, and environment components.","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_81":{"id":"8ac9e3176731_81","__typename":"Paragraph","name":"08ad","text":"Data dependencies version control (1) the model definition and (2) the training data. Save these to versioned blob storage, e.g. Amazon S3 with Quilt T4.","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":129,"end":138,"type":"A","href":"https:\u002F\u002Faws.amazon.com\u002Fs3\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":144,"end":152,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Ft4","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_82":{"id":"8ac9e3176731_82","__typename":"Paragraph","name":"95f5","text":"Code dependencies version controls the code used to train the model (use git).","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_83":{"id":"8ac9e3176731_83","__typename":"Paragraph","name":"fec1","text":"Environment dependencies version control the environment used to train the model. In a production environment this should probably be a Docker file, but you can use pip or conda locally.","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":165,"end":168,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":172,"end":177,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_84":{"id":"8ac9e3176731_84","__typename":"Paragraph","name":"c333","text":"To provide someone with a retrainable copy of the model, give them the corresponding {data, code, environment} tuple.","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":85,"end":110,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_85":{"id":"8ac9e3176731_85","__typename":"Paragraph","name":"51e1","text":"Following these principles makes getting everything you need to train your own copy of this model fit into a handful of lines of code:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_86":{"id":"8ac9e3176731_86","__typename":"Paragraph","name":"856c","text":"git clone https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fopen-images.git\nconda env create -f open-images\u002Fenvironment.yml\nsource activate quilt-open-images-dev\npython -c \"import t4; t4.Package.install('quilt\u002Fopen_images', dest='open-images\u002F', registry='s3:\u002F\u002Fquilt-example')\"","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":10,"end":54,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fopen-images.git","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_87":{"id":"8ac9e3176731_87","__typename":"Paragraph","name":"97be","text":"To learn more about {data, code, environment} see the GitHub repository and\u002For the corresponding article.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":20,"end":45,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","start":50,"end":71,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fquiltdata\u002Fopen-images","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":79,"end":104,"type":"A","href":"https:\u002F\u002Fblog.quiltdata.com\u002Freproduce-a-machine-learning-model-build-in-four-lines-of-code-b4f0a5c5f8c8","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_88":{"id":"8ac9e3176731_88","__typename":"Paragraph","name":"08a3","text":"Conclusion","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_89":{"id":"8ac9e3176731_89","__typename":"Paragraph","name":"9acf","text":"In this article we demonstrated an end-to-end image classification machine learning pipeline. We covered everything from downloading\u002Ftransforming a dataset to training a model. We then distributed it in a way that lets anyone else rebuild it themselves later.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_90":{"id":"8ac9e3176731_90","__typename":"Paragraph","name":"c421","text":"Because custom datasets are difficult to generate and distribute, over time there has emerged a cabal of example datasets which get used everywhere. This is not because they’re actually that good (they’re not). Instead, it’s because they’re easy.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:8ac9e3176731_91":{"id":"8ac9e3176731_91","__typename":"Paragraph","name":"e74b","text":"For example, Google’s recently released Machine Learning Crash Course makes heavy use of the California Housing Dataset. That data is now almost two decades old!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":93,"end":119,"type":"A","href":"https:\u002F\u002Fscikit-learn.org\u002Fstable\u002Fmodules\u002Fgenerated\u002Fsklearn.datasets.fetch_california_housing.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:8ac9e3176731_92":{"id":"8ac9e3176731_92","__typename":"Paragraph","name":"0523","text":"Consider instead exploring new horizons. Using real images from the living Internet with interesting categorical breakdowns. It’s easier than you think!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"ImageMetadata:1*EI4YPmaav7hc79e0GH__BQ.png":{"id":"1*EI4YPmaav7hc79e0GH__BQ.png","__typename":"ImageMetadata","originalHeight":1440,"originalWidth":2560,"focusPercentX":null,"focusPercentY":null,"alt":null},"MediaResource:be4a182e90d24b46368b8b9dd6964833":{"id":"be4a182e90d24b46368b8b9dd6964833","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"openimager.py"},"ImageMetadata:1*Wp0-dUSPLuwC6KN7hELNLw.png":{"id":"1*Wp0-dUSPLuwC6KN7hELNLw.png","__typename":"ImageMetadata","originalHeight":1440,"originalWidth":1484,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*8ytDl01L-ZoUKYxYREMkuw.png":{"id":"1*8ytDl01L-ZoUKYxYREMkuw.png","__typename":"ImageMetadata","originalHeight":252,"originalWidth":1392,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*ii670RcCgXExc2CQgc-QEg.png":{"id":"1*ii670RcCgXExc2CQgc-QEg.png","__typename":"ImageMetadata","originalHeight":252,"originalWidth":1335,"focusPercentX":null,"focusPercentY":null,"alt":null},"MediaResource:e1767a7acc4819c35f73598cd7183088":{"id":"e1767a7acc4819c35f73598cd7183088","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"set_model_input.py"},"MediaResource:160672b01e7ab2186adb288bbe311887":{"id":"160672b01e7ab2186adb288bbe311887","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"define_model.py"},"MediaResource:e2951097f73f72338cca7f495344af0b":{"id":"e2951097f73f72338cca7f495344af0b","__typename":"MediaResource","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"train_model.py"},"Tag:machine-learning":{"id":"machine-learning","__typename":"Tag","displayTitle":"Machine Learning"},"Tag:data-science":{"id":"data-science","__typename":"Tag","displayTitle":"Data Science"},"Tag:computer-vision":{"id":"computer-vision","__typename":"Tag","displayTitle":"Computer Vision"},"Tag:programming":{"id":"programming","__typename":"Tag","displayTitle":"Programming"},"Tag:technology":{"id":"technology","__typename":"Tag","displayTitle":"Technology"},"User:6c9d5b577198":{"id":"6c9d5b577198","__typename":"User","name":"Aneesh Karve"},"Collaborator:65847da1a319-6c9d5b577198":{"id":"65847da1a319-6c9d5b577198","__typename":"Collaborator","user":{"__ref":"User:6c9d5b577198"},"state":"visible"},"User:370d0382c596":{"id":"370d0382c596","__typename":"User","name":"Cecelia Shao"},"Collaborator:65847da1a319-370d0382c596":{"id":"65847da1a319-370d0382c596","__typename":"Collaborator","user":{"__ref":"User:370d0382c596"},"state":"visible"},"Post:65847da1a319":{"id":"65847da1a319","__typename":"Post","canonicalUrl":"","collection":{"__ref":"Collection:336d898217ee"},"content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Fme\u002Fstories\u002Fpublic\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","isCacheableContent":false,"bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:8ac9e3176731_0"},{"__ref":"Paragraph:8ac9e3176731_1"},{"__ref":"Paragraph:8ac9e3176731_2"},{"__ref":"Paragraph:8ac9e3176731_3"},{"__ref":"Paragraph:8ac9e3176731_4"},{"__ref":"Paragraph:8ac9e3176731_5"},{"__ref":"Paragraph:8ac9e3176731_6"},{"__ref":"Paragraph:8ac9e3176731_7"},{"__ref":"Paragraph:8ac9e3176731_8"},{"__ref":"Paragraph:8ac9e3176731_9"},{"__ref":"Paragraph:8ac9e3176731_10"},{"__ref":"Paragraph:8ac9e3176731_11"},{"__ref":"Paragraph:8ac9e3176731_12"},{"__ref":"Paragraph:8ac9e3176731_13"},{"__ref":"Paragraph:8ac9e3176731_14"},{"__ref":"Paragraph:8ac9e3176731_15"},{"__ref":"Paragraph:8ac9e3176731_16"},{"__ref":"Paragraph:8ac9e3176731_17"},{"__ref":"Paragraph:8ac9e3176731_18"},{"__ref":"Paragraph:8ac9e3176731_19"},{"__ref":"Paragraph:8ac9e3176731_20"},{"__ref":"Paragraph:8ac9e3176731_21"},{"__ref":"Paragraph:8ac9e3176731_22"},{"__ref":"Paragraph:8ac9e3176731_23"},{"__ref":"Paragraph:8ac9e3176731_24"},{"__ref":"Paragraph:8ac9e3176731_25"},{"__ref":"Paragraph:8ac9e3176731_26"},{"__ref":"Paragraph:8ac9e3176731_27"},{"__ref":"Paragraph:8ac9e3176731_28"},{"__ref":"Paragraph:8ac9e3176731_29"},{"__ref":"Paragraph:8ac9e3176731_30"},{"__ref":"Paragraph:8ac9e3176731_31"},{"__ref":"Paragraph:8ac9e3176731_32"},{"__ref":"Paragraph:8ac9e3176731_33"},{"__ref":"Paragraph:8ac9e3176731_34"},{"__ref":"Paragraph:8ac9e3176731_35"},{"__ref":"Paragraph:8ac9e3176731_36"},{"__ref":"Paragraph:8ac9e3176731_37"},{"__ref":"Paragraph:8ac9e3176731_38"},{"__ref":"Paragraph:8ac9e3176731_39"},{"__ref":"Paragraph:8ac9e3176731_40"},{"__ref":"Paragraph:8ac9e3176731_41"},{"__ref":"Paragraph:8ac9e3176731_42"},{"__ref":"Paragraph:8ac9e3176731_43"},{"__ref":"Paragraph:8ac9e3176731_44"},{"__ref":"Paragraph:8ac9e3176731_45"},{"__ref":"Paragraph:8ac9e3176731_46"},{"__ref":"Paragraph:8ac9e3176731_47"},{"__ref":"Paragraph:8ac9e3176731_48"},{"__ref":"Paragraph:8ac9e3176731_49"},{"__ref":"Paragraph:8ac9e3176731_50"},{"__ref":"Paragraph:8ac9e3176731_51"},{"__ref":"Paragraph:8ac9e3176731_52"},{"__ref":"Paragraph:8ac9e3176731_53"},{"__ref":"Paragraph:8ac9e3176731_54"},{"__ref":"Paragraph:8ac9e3176731_55"},{"__ref":"Paragraph:8ac9e3176731_56"},{"__ref":"Paragraph:8ac9e3176731_57"},{"__ref":"Paragraph:8ac9e3176731_58"},{"__ref":"Paragraph:8ac9e3176731_59"},{"__ref":"Paragraph:8ac9e3176731_60"},{"__ref":"Paragraph:8ac9e3176731_61"},{"__ref":"Paragraph:8ac9e3176731_62"},{"__ref":"Paragraph:8ac9e3176731_63"},{"__ref":"Paragraph:8ac9e3176731_64"},{"__ref":"Paragraph:8ac9e3176731_65"},{"__ref":"Paragraph:8ac9e3176731_66"},{"__ref":"Paragraph:8ac9e3176731_67"},{"__ref":"Paragraph:8ac9e3176731_68"},{"__ref":"Paragraph:8ac9e3176731_69"},{"__ref":"Paragraph:8ac9e3176731_70"},{"__ref":"Paragraph:8ac9e3176731_71"},{"__ref":"Paragraph:8ac9e3176731_72"},{"__ref":"Paragraph:8ac9e3176731_73"},{"__ref":"Paragraph:8ac9e3176731_74"},{"__ref":"Paragraph:8ac9e3176731_75"},{"__ref":"Paragraph:8ac9e3176731_76"},{"__ref":"Paragraph:8ac9e3176731_77"},{"__ref":"Paragraph:8ac9e3176731_78"},{"__ref":"Paragraph:8ac9e3176731_79"},{"__ref":"Paragraph:8ac9e3176731_80"},{"__ref":"Paragraph:8ac9e3176731_81"},{"__ref":"Paragraph:8ac9e3176731_82"},{"__ref":"Paragraph:8ac9e3176731_83"},{"__ref":"Paragraph:8ac9e3176731_84"},{"__ref":"Paragraph:8ac9e3176731_85"},{"__ref":"Paragraph:8ac9e3176731_86"},{"__ref":"Paragraph:8ac9e3176731_87"},{"__ref":"Paragraph:8ac9e3176731_88"},{"__ref":"Paragraph:8ac9e3176731_89"},{"__ref":"Paragraph:8ac9e3176731_90"},{"__ref":"Paragraph:8ac9e3176731_91"},{"__ref":"Paragraph:8ac9e3176731_92"}],"sections":[{"__typename":"Section","name":"9559","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"creator":{"__ref":"User:b6d2cfb88f3"},"customStyleSheet":null,"firstPublishedAt":1550686611360,"isLocked":false,"isPublished":true,"isShortform":false,"layerCake":4,"primaryTopic":{"__typename":"Topic","name":"Machine Learning","slug":"machine-learning","isFollowing":null},"title":"How to classify photos in 600 classes using nine million Open Images","mediumUrl":"https:\u002F\u002Fmedium.com\u002Ffree-code-camp\u002Fhow-to-classify-photos-in-600-classes-using-nine-million-open-images-65847da1a319","isLimitedState":false,"visibility":"PUBLIC","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"","sequence":null,"tags":[{"__ref":"Tag:machine-learning"},{"__ref":"Tag:data-science"},{"__ref":"Tag:computer-vision"},{"__ref":"Tag:programming"},{"__ref":"Tag:technology"}],"topics":[{"__typename":"Topic","topicId":"1eca0103fff3","name":"Machine Learning","slug":"machine-learning"},{"__typename":"Topic","topicId":"ae5d4995e225","name":"Data Science","slug":"data-science"},{"__typename":"Topic","topicId":"decb52b64abf","name":"Programming","slug":"programming"}],"viewerClapCount":0,"showSubscribeToProfilePromo":false,"showSubscribeToCollectionNewsletterV3Promo":false,"inResponseToPostResult":null,"isNewsletter":false,"socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1550686611360,"readingTime":7.673584905660378,"previewContent":{"__typename":"PreviewContent","subtitle":"If you’re looking to train an image classifier for fun or profit and are in need of data to do it, look no further than Google Open Images…"},"previewImage":{"__ref":"ImageMetadata:1*EI4YPmaav7hc79e0GH__BQ.png"},"creatorPartnerProgramEnrollmentStatus":"NOT_ENROLLED","clapCount":833,"lockedSource":"LOCKED_POST_SOURCE_NONE","isSuspended":false,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"pinnedByCreatorAt":0,"curationEligibleAt":0,"shareKey":"0cad2cdcbd93e3821d14ee2116e51219","responsesCount":2,"collaborators":[{"__ref":"Collaborator:65847da1a319-6c9d5b577198"},{"__ref":"Collaborator:65847da1a319-370d0382c596"}],"translationSourcePost":null,"inResponseToMediaResource":null,"isDistributionAlertDismissed":false,"audioVersionUrl":"","seoTitle":"","updatedAt":1603149088416,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","postResponses":{"__typename":"PostResponses","count":2},"latestPublishedVersion":"8ac9e3176731","isPublishToEmail":false,"readingList":"READING_LIST_NONE","voterCount":174,"recommenders":[]}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.9f0a59eb.js"></script><script src="https://cdn-client.medium.com/lite/static/js/4739.78fb2a04.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.6b01daef.js"></script><script src="https://cdn-client.medium.com/lite/static/js/5573.159bf40f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/instrumentation.b5262cb2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2d4858fa.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1826.f1c2fa77.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4464.c01c0ad8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8342.6aa0b45e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1148.27bc51ff.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5064.fedfa9f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9274.431d8f19.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2846.2eab6f86.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7012.5f022c24.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7993.d921811a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6839.76c7a097.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5127.25f1bb68.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5967.577a90dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8751.0b0595e4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6010.0c79e639.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7131.65798e19.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9809.2014403c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9978.10a970d1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7106.32df7fe7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3277.e57d6ad0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3721.34f2c2c7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2514.34c0377a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2602.6f7e7156.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1304.124bf019.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6098.d8904caa.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8578.935a6d3a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9889.79178434.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3981.14502e6d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/Post.8a4e777c.chunk.js"></script><script>window.main();</script></body></html>